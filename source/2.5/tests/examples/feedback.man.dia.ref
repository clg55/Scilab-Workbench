 
clear;lines(0);
 
S1=ssrand(2,2,3);S2=ssrand(2,2,2);
 
W=S1/.S2;
 
ss2tf(S1/.S2)
 ans  =
 
 
         column 1
 
!                                        2            3            4   !
!     1.1668524 + 3.6958424s + 3.9493803s + 3.7392783s + 3.4056939s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
! - 8.6509833 - 17.252396s - 15.942123s + 1.1215015s + 1.3726613s      !
!         5                                                            !
!      + s                                                             !
!                                                                      !
!                                        2            3            4   !
!     30.153871 + 37.697638s + 13.762506s + 0.8743139s - 0.9289148s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
! - 8.6509833 - 17.252396s - 15.942123s + 1.1215015s + 1.3726613s      !
!         5                                                            !
!      + s                                                             !
 
         column 2
 
!                                        2            3            4   !
!     0.0856634 + 1.5290343s + 5.4886257s + 3.4665298s - 0.7149850s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
! - 8.6509833 - 17.252396s - 15.942123s + 1.1215015s + 1.3726613s      !
!         5                                                            !
!      + s                                                             !
!                                                                      !
!                                        2            3            4   !
!   - 26.914148 - 18.545084s + 1.8437172s + 3.5432615s + 1.9661457s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
! - 8.6509833 - 17.252396s - 15.942123s + 1.1215015s + 1.3726613s      !
!         5                                                            !
!      + s                                                             !
 
//Same operation by LFT:
 
ss2tf(lft([zeros(2,2),eye(2,2);eye(2,2),-S2],S1))
 ans  =
 
 
         column 1
 
!                                        2            3            4   !
!     1.1668524 + 3.6958424s + 3.9493803s + 3.7392783s + 3.4056939s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
! - 8.6509833 - 17.252396s - 15.942123s + 1.1215015s + 1.3726613s      !
!         5                                                            !
!      + s                                                             !
!                                                                      !
!                                        2            3            4   !
!     30.153871 + 37.697638s + 13.762506s + 0.8743139s - 0.9289148s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
! - 8.6509833 - 17.252396s - 15.942123s + 1.1215015s + 1.3726613s      !
!         5                                                            !
!      + s                                                             !
 
         column 2
 
!                                        2            3            4   !
!     0.0856634 + 1.5290343s + 5.4886257s + 3.4665298s - 0.7149850s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
! - 8.6509833 - 17.252396s - 15.942123s + 1.1215015s + 1.3726613s      !
!         5                                                            !
!      + s                                                             !
!                                                                      !
!                                        2            3            4   !
!   - 26.914148 - 18.545084s + 1.8437172s + 3.5432615s + 1.9661457s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
! - 8.6509833 - 17.252396s - 15.942123s + 1.1215015s + 1.3726613s      !
!         5                                                            !
!      + s                                                             !
 
//Other approach: with constant feedback
 
BigS=sysdiag(S1,S2); F=[zeros(2,2),eye(2,2);-eye(2,2),zeros(2,2)];
 
Bigclosed=BigS/.F;
 
W1=Bigclosed(1:2,1:2);   //W1=W (in state-space).
 
ss2tf(W1)
 ans  =
 
 
         column 1
 
!                                        2            3            4   !
!     1.1668524 + 3.6958424s + 3.9493803s + 3.7392783s + 3.4056939s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
! - 8.6509833 - 17.252396s - 15.942123s + 1.1215015s + 1.3726613s      !
!         5                                                            !
!      + s                                                             !
!                                                                      !
!                                        2            3            4   !
!     30.153871 + 37.697638s + 13.762506s + 0.8743139s - 0.9289148s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
! - 8.6509833 - 17.252396s - 15.942123s + 1.1215015s + 1.3726613s      !
!         5                                                            !
!      + s                                                             !
 
         column 2
 
!                                        2            3            4   !
!     0.0856634 + 1.5290343s + 5.4886257s + 3.4665298s - 0.7149850s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
! - 8.6509833 - 17.252396s - 15.942123s + 1.1215015s + 1.3726613s      !
!         5                                                            !
!      + s                                                             !
!                                                                      !
!                                        2            3            4   !
!   - 26.914148 - 18.545084s + 1.8437172s + 3.5432615s + 1.9661457s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
! - 8.6509833 - 17.252396s - 15.942123s + 1.1215015s + 1.3726613s      !
!         5                                                            !
!      + s                                                             !
 
//Inverting
 
ss2tf(S1*inv(eye()+S2*S1))
 ans  =
 
 
         column 1
 
!                                        2            3            4   !
!     1.1668524 + 3.6958424s + 3.9493803s + 3.7392783s + 3.4056939s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
! - 8.6509833 - 17.252396s - 15.942123s + 1.1215015s + 1.3726613s      !
!         5                                                            !
!      + s                                                             !
!                                                                      !
!                                        2            3            4   !
!     30.153871 + 37.697638s + 13.762506s + 0.8743139s - 0.9289148s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
! - 8.6509833 - 17.252396s - 15.942123s + 1.1215015s + 1.3726613s      !
!         5                                                            !
!      + s                                                             !
 
         column 2
 
!                                        2            3            4   !
!     0.0856634 + 1.5290343s + 5.4886257s + 3.4665298s - 0.7149850s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
! - 8.6509833 - 17.252396s - 15.942123s + 1.1215015s + 1.3726613s      !
!         5                                                            !
!      + s                                                             !
!                                                                      !
!                                        2            3            4   !
!   - 26.914148 - 18.545084s + 1.8437172s + 3.5432615s + 1.9661457s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
! - 8.6509833 - 17.252396s - 15.942123s + 1.1215015s + 1.3726613s      !
!         5                                                            !
!      + s                                                             !
 
