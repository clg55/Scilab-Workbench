 
clear;lines(0);
 
s=poly(0,'s');
 
h=syslin('c',(s-1)/(s^3+5*s+20))
 h  =
 
     - 1 + s      
    -----------   
               3  
    20 + 5s + s   
 
frq=0:0.05:3;repf=repfreq(h,frq);
 
clean(frep2tf(frq,repf,3))
 ans  =
 
    - 0.05 + 0.05s      
    ----------------    
                     3  
    1 + 0.25s + 0.05s   
 
 
Sys=ssrand(1,1,10);
 
frq=logspace(-3,2,200);
 
[frq,rep]=repfreq(Sys,frq);  //Frequency response of Sys
 
[Sys2,err]=frep2tf(frq,rep,10);Sys2=clean(Sys2)//Sys2 obtained from freq. resp of Sys
 Sys2  =
 
                                       2            3            4      
    15.604836 - 2.4990478s - 14.922811s + 6.4520983s - 1.7491581s       
                   5            6            7            8             
       + 0.2326246s - 0.2362542s + 0.0200656s + 0.0445306s              
                    9                                                   
       - 0.0084055s                                                     
    ------------------------------------------------------------------  
                                       2            3            4      
  - 4.5344981 + 4.1524119s - 4.9962771s + 2.1531688s - 0.6723371s       
                   5            6            7            8             
       + 0.1186838s - 0.0291236s + 0.0032039s + 0.0174684s              
                    9           10                                      
       + 0.0052477s - 0.0020467s                                        
 
[frq,rep2]=repfreq(Sys2,frq); //Frequency response of Sys2
 
xbasc();bode(frq,[rep;rep2])   //Responses of Sys and Sys2
 
[sort(trzeros(Sys)),sort(roots(Sys2('num')))]  //zeros
 ans  =
 
!   4.3540227                 4.3540227              !
!   3.5414107                 3.5414107              !
! - 3.3353291               - 3.3353291              !
! - 1.1030175 + 2.3618478i  - 1.1030175 + 2.3618478i !
! - 1.1030175 - 2.3618478i  - 1.1030175 - 2.3618478i !
!   1.3471793 - 1.8425944i    1.3471793 + 1.8425944i !
!   1.3471793 + 1.8425944i    1.3471793 - 1.8425944i !
!   1.1421496                 1.1421496              !
! - 0.8927681               - 0.8927681              !
 
[sort(spec(Sys('A'))),sort(roots(Sys2('den')))] //poles
 ans  =
 
!   4.4381977                 4.4381977              !
! - 2.7924103 + 1.3340877i  - 2.7924103 + 1.3340877i !
! - 2.7924103 - 1.3340877i  - 2.7924103 - 1.3340877i !
! - 0.6374557 + 2.1718846i  - 0.6374557 + 2.1718846i !
! - 0.6374557 - 2.1718846i  - 0.6374557 - 2.1718846i !
!   2.1329462                 2.1329462              !
!   1.1620666 + 1.4586145i    1.1620666 + 1.4586145i !
!   1.1620666 - 1.4586145i    1.1620666 - 1.4586145i !
!   0.2641970 + 1.1408591i    0.2641970 + 1.1408591i !
!   0.2641970 - 1.1408591i    0.2641970 - 1.1408591i !
 
 
dom=1/1000; // Sampling time
 
z=poly(0,'z');
 
h=syslin(dom,(z^2+0.5)/(z^3+0.1*z^2-0.5*z+0.08))
 h  =
 
                  2          
           0.5 + z           
    ---------------------    
                      2   3  
    0.08 - 0.5z + 0.1z + z   
 
frq=(0:0.01:0.5)/dom;repf=repfreq(h,frq);
 
[Sys2,err]=frep2tf(frq,repf,3,dom);
 
[frq,rep2]=repfreq(Sys2,frq); //Frequency response of Sys2
 
xbasc();plot2d1("onn",frq',abs([repf;rep2])');
 
 
