 
clear;lines(0);
 
G=ssrand(1,1,3);K=ssrand(1,1,3);
 
[Se,Re,Te]=sensi(G,K);
 
Se1=inv(eye()+G*K);  //Other way to compute
 
ss2tf(Se)    //Se seen in transfer form
 ans  =
 
                                       2            3            4      
  - 0.5990724 + 0.3749131s + 1.5423718s - 0.5187113s - 2.1861309s       
                   5   6                                                
       + 0.0635913s + s                                                 
    ------------------------------------------------------------------  
                                       2            3            4      
  - 0.2580686 + 1.3372945s - 1.9423793s + 0.0215995s - 1.8970239s       
                   5   6                                                
       + 0.0635913s + s                                                 
 
ss2tf(Se1)
 ans  =
 
                                       2            3            4      
  - 0.5990724 + 0.3749131s + 1.5423718s - 0.5187113s - 2.1861309s       
                   5   6                                                
       + 0.0635913s + s                                                 
    ------------------------------------------------------------------  
                                       2            3            4      
  - 0.2580686 + 1.3372945s - 1.9423793s + 0.0215995s - 1.8970239s       
                   5   6                                                
       + 0.0635913s + s                                                 
 
ss2tf(Te)
 ans  =
 
                                       2            3            4      
    0.3410038 + 0.9623814s - 3.4847512s + 0.5403108s + 0.2891071s       
                   5                                                    
       + 7.209D-15s                                                     
    ------------------------------------------------------------------  
                                       2            3            4      
  - 0.2580686 + 1.3372945s - 1.9423793s + 0.0215995s - 1.8970239s       
                   5   6                                                
       + 0.0635913s + s                                                 
 
ss2tf(G*K*Se1)
 ans  =
 
                                       2            3            4      
    0.3410038 + 0.9623814s - 3.4847512s + 0.5403108s + 0.2891071s       
                   5                                                    
       - 2.016D-15s                                                     
    ------------------------------------------------------------------  
                                       2            3            4      
  - 0.2580686 + 1.3372945s - 1.9423793s + 0.0215995s - 1.8970239s       
                   5   6                                                
       + 0.0635913s + s                                                 
 
[Si,Ri,Ti]=sensi(G,K,'i');
 
w1=[ss2tf(Si);ss2tf(Ri);ss2tf(Ti)]
 w1  =
 
!                                      2            3            4     !
! - 0.5990724 + 0.3749131s + 1.5423718s - 0.5187113s - 2.1861309s      !
!                  5   6                                               !
!      + 0.0635913s + s                                                !
!   ------------------------------------------------------------------ !
!                                      2            3            4     !
! - 0.2580686 + 1.3372945s - 1.9423793s + 0.0215995s - 1.8970239s      !
!                  5   6                                               !
!      + 0.0635913s + s                                                !
!                                                                      !
!                                      2            3            4     !
!   0.5681226 + 1.6082192s - 5.7979292s + 1.8379037s + 5.1024446s      !
!                  5                                                   !
!      - 2.0553465s                                                    !
!   ------------------------------------------------------------------ !
!                                      2            3            4     !
! - 0.2580686 + 1.3372945s - 1.9423793s + 0.0215995s - 1.8970239s      !
!                  5   6                                               !
!      + 0.0635913s + s                                                !
!                                                                      !
!                                      2            3            4     !
!   0.3410038 + 0.9623814s - 3.4847512s + 0.5403108s + 0.2891071s      !
!                  5                                                   !
!      - 9.908D-16s                                                    !
!   ------------------------------------------------------------------ !
!                                      2            3            4     !
! - 0.2580686 + 1.3372945s - 1.9423793s + 0.0215995s - 1.8970239s      !
!                  5   6                                               !
!      + 0.0635913s + s                                                !
 
w2=[ss2tf(inv(eye()+K*G));ss2tf(G*inv(eye()+K*G));ss2tf(K*G*inv(eye()+K*G))];
 
clean(w1-w2)
 ans  =
 
!   0  !
!   -  !
!   1  !
!      !
!   0  !
!   -  !
!   1  !
!      !
!   0  !
!   -  !
!   1  !
 
