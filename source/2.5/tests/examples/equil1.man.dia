 
clear;lines(0);
 
S1=rand(2,2);S1=S1*S1';
 
S2=rand(2,2);S2=S2*S2';
 
S3=rand(2,2);S3=S3*S3';
 
P=sysdiag(S1,S2,zeros(4,4));
 
Q=sysdiag(S1,zeros(2,2),S3,zeros(2,2));
 
X=rand(8,8);
 
P=X*P*X';Q=inv(X)'*Q*inv(X);
 
[T,siz]=equil1(P,Q);
 
P1=clean(T*P*T')
 P1  =
 
!   0.7186281    0.           0.    0.    0.    0.    0.    0. !
!   0.           0.0067484    0.    0.    0.    0.    0.    0. !
!   0.           0.           1.    0.    0.    0.    0.    0. !
!   0.           0.           0.    1.    0.    0.    0.    0. !
!   0.           0.           0.    0.    0.    0.    0.    0. !
!   0.           0.           0.    0.    0.    0.    0.    0. !
!   0.           0.           0.    0.    0.    0.    0.    0. !
!   0.           0.           0.    0.    0.    0.    0.    0. !
 
Q1=clean(inv(T)'*Q*inv(T))
 Q1  =
 
 
         column 1 to 7
 
!   0.7186281    0.           0.    0.    0.           0.           0. !
!   0.           0.0067484    0.    0.    0.           0.           0. !
!   0.           0.           0.    0.    0.           0.           0. !
!   0.           0.           0.    0.    0.           0.           0. !
!   0.           0.           0.    0.    40.403098    0.           0. !
!   0.           0.           0.    0.    0.           1.3519204    0. !
!   0.           0.           0.    0.    0.           0.           0. !
!   0.           0.           0.    0.    0.           0.           0. !
 
         column 8
 
!   0. !
!   0. !
!   0. !
!   0. !
!   0. !
!   0. !
!   0. !
!   0. !
 
