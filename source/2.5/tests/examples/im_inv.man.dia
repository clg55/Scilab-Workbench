 
clear;lines(0);
 
A=[rand(2,5);[zeros(3,4),rand(3,1)]];B=[[1,1;1,1];zeros(3,2)];
 
W=rand(5,5);A=W*A;B=W*B;
 
[X,dim]=im_inv(A,B)
 dim  =
 
    3.  
 X  =
 
!   0.0732521    0.5261807  - 0.1844378  - 0.8218269  - 0.0913845 !
! - 0.2313695  - 0.8158070  - 0.1726842  - 0.4980365  - 0.0553801 !
!   0.8746448  - 0.1887864  - 0.4429485    0.0558064    0.0062055 !
! - 0.4196413    0.1481639  - 0.8602090    0.2474511    0.0275158 !
!   0.           0.           0.         - 0.1105156    0.9938744 !
 
svd([A*X(:,1:dim),B])   //vectors A*X(:,1:dim) belong to range(B)
 ans  =
 
!   3.7696387 !
!   0.        !
!   0.        !
!   0.        !
!   0.        !
 
[X,dim,Y]=im_inv(A,B);[Y*A*X,Y*B]
 ans  =
 
 
         column 1 to 5
 
! - 0.5071483  - 0.2343991    2.2422487    1.0708282  - 2.3203151 !
!   0.           0.           0.         - 0.0088075  - 0.5329155 !
!   0.           0.           0.         - 0.0289716    0.7948383 !
!   0.           0.           0.         - 0.0080512  - 0.3808509 !
!   0.           0.           0.         - 0.1391846  - 0.1096941 !
 
         column 6 to 7
 
! - 2.105986  - 2.105986 !
!   0.          0.       !
!   0.          0.       !
!   0.          0.       !
!   0.          0.       !
 
