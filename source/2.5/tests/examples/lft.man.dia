 
clear;lines(0);
 
s=poly(0,'s');
 
P=[1/s, 1/(s+1); 1/(s+2),2/s]; K= 1/(s-1);
 
lft(P,K)
 ans  =
 
               2    3   4   
  - 4 - 8s - 2s + 2s + s    
    --------------------    
           2    3    4   5  
  - 4s - 8s - 3s + 2s + s   
 
lft(P,[1,1],K)
 ans  =
 
               2    3   4   
  - 4 - 8s - 2s + 2s + s    
    --------------------    
           2    3    4   5  
  - 4s - 8s - 3s + 2s + s   
 
P(1,1)+P(1,2)*K*inv(1-P(2,2)*K)*P(2,1)   //Numerically dangerous!
 ans  =
 
               2    3   4   
  - 4 - 8s - 2s + 2s + s    
    --------------------    
           2    3    4   5  
  - 4s - 8s - 3s + 2s + s   
 
ss2tf(lft(tf2ss(P),tf2ss(K)))
 ans  =
 
                     2    3   4         
        - 4 - 8s - 2s + 2s + s          
    --------------------------------    
                       2    3    4   5  
    9.196D-16 - 4s - 8s - 3s + 2s + s   
 
lft(P,-1)
 ans  =
 
               2   3   
    4 + 8s + 4s + s    
    ---------------    
           2    3   4  
    4s + 8s + 5s + s   
 
f=[0,0;0,1];w=P/.f; w(1,1)
 ans  =
 
               2   3   
    4 + 8s + 4s + s    
    ---------------    
           2    3   4  
    4s + 8s + 5s + s   
 
//Improper plant (PID control)
 
W=[1,1;1,1/(s^2+0.1*s)];K=1+1/s+s
 K  =
 
             2  
    1 + s + s   
    ---------   
        s       
 
lft(W,[1,1],K); ss2tf(lft(tf2ss(W),[1,1],tf2ss(K)))
 ans  =
 
                   2      3   4  
  - 1 - 0.9s + 0.2s + 2.1s + s   
    --------------------------   
                     2   3       
       - 1 - s - 0.9s + s        
 
