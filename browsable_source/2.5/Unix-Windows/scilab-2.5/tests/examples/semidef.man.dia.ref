 
clear;lines(0);
 
F0=[2,1,0,0;
    1,2,0,0;
    0,0,3,1
    0,0,1,3];
 
F1=[1,2,0,0;
    2,1,0,0;
    0,0,1,3;
    0,0,3,1]
 F1  =
 
!   1.    2.    0.    0. !
!   2.    1.    0.    0. !
!   0.    0.    1.    3. !
!   0.    0.    3.    1. !
 
F2=[2,2,0,0;
    2,2,0,0;
    0,0,3,4;
    0,0,4,4];
 
blck_szs=[2,2];
 
F01=F0(1:2,1:2);F02=F0(3:4,3:4);
 
F11=F1(1:2,1:2);F12=F1(3:4,3:4);
 
F21=F2(1:2,1:2);F22=F2(3:4,3:4);
 
x0=[0;0]
 x0  =
 
!   0. !
!   0. !
 
Z0=2*F0;
 
Z01=Z0(1:2,1:2);Z02=Z0(3:4,3:4);
 
FF=[[F01(:);F02(:)],[F11(:);F12(:)],[F21(:);F22(:)]]
 FF  =
 
!   2.    1.    2. !
!   1.    2.    2. !
!   1.    2.    2. !
!   2.    1.    2. !
!   3.    1.    3. !
!   1.    3.    4. !
!   1.    3.    4. !
!   3.    1.    4. !
 
ZZ0=[[Z01(:);Z02(:)]];
 
c=[trace(F1*Z0);trace(F2*Z0)];
 
options=[10,1.d-10,1.d-10,0,50];
 
[x,Z,ul,info]=semidef(x0,pack(ZZ0),pack(FF),blck_szs,c,options)
 info  =
 
!   2.    10. !
 ul  =
 
! - 44.415079  - 44.415079 !
 Z  =
 
!   1.259D-09 !
! - 6.679D-10 !
!   1.259D-09 !
!   2.415079  !
!   4.7240576 !
!   9.2405756 !
 x  =
 
!   0.5710609 !
! - 0.8202136 !
 
w=vec2list(unpack(Z,blck_szs),[blck_szs;blck_szs]);Z=sysdiag(w(1),w(2))
 Z  =
 
!   1.259D-09  - 6.679D-10    0.           0.        !
! - 6.679D-10    1.259D-09    0.           0.        !
!   0.           0.           2.415079     4.7240576 !
!   0.           0.           4.7240576    9.2405756 !
 
c'*x+trace(F0*Z)
 ans  =
 
    2.331D-09  
 
spec(F0+F1*x(1)+F2*x(2))
 ans  =
 
! - 4.441D-16 !
!   0.4289391 !
!   1.4006267 !
!   1.4323283 !
 
trace(F1*Z)-c(1)
 ans  =
 
    9.683D-11  
 
trace(F2*Z)-c(2)
 ans  =
 
    1.985D-10  
 
