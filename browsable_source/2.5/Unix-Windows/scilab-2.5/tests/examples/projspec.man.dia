 
clear;lines(0);
 
deff('j=jdrn(n)','j=zeros(n,n);for k=1:n-1;j(k,k+1)=1;end')
 
A=sysdiag(jdrn(3),jdrn(2),rand(2,2));X=rand(7,7);
 
A=X*A*inv(X);
 
[S,P,D,index]=projspec(A);
    rank A^k    rcond
        5.      0.474D-15
        3.      0.802D-15
        2.      0.268D+00
 
index   //size of J-block
 index  =
 
    3.  
 
trace(P)  //sum of dimensions of J-blocks
 ans  =
 
    5.  
 
A*S-(eye()-P)
 ans  =
 
   1.0D-13 *
 
 
         column 1 to 5
 
! - 0.0754952  - 0.1054712  - 0.3330669    0.2797762    0.5062617 !
! - 0.0155431  - 0.1221245  - 0.2486900    0.2220446    0.3375078 !
!   0.1487699    0.0677236    0.0177636  - 0.5107026  - 0.2842171 !
!   0.0510703  - 0.0399680  - 0.0710543    0.1421085    0.2575717 !
! - 0.1088019  - 0.154321   - 0.5639933    0.4440892    0.8348877 !
!   0.1132427  - 0.0310862    0.1154632  - 0.1065814  - 0.2575717 !
! - 0.0510703  - 0.0754952  - 0.1731948    0.1820766    0.4352074 !
 
         column 6 to 7
 
!   0.0893730  - 0.5195844 !
!   0.0754952  - 0.5062617 !
! - 0.1271205    0.2753353 !
!   0.0344169  - 0.5773160 !
!   0.1570966  - 1.2301271 !
! - 0.0377476  - 0.1065814 !
!   0.0544009  - 0.3641532 !
 
norm(D^index,1)
 ans  =
 
    1.095D-13  
 
