 
clear;lines(0);
 
// Simple one dimension ODE
 
// dy/dt=y^2-y sin(t)+cos(t), y(0)=0
 
deff('[ydot]=f(t,y)','ydot=y^2-y*sin(t)+cos(t)')
 
y0=0;t0=0;t=0:0.1:%pi;
 
y=ode(y0,t0,t,f)
 y  =
 
 
         column 1 to 5
 
!   0.    0.0998334    0.1986694    0.2955202    0.3894184 !
 
         column  6 to 10
 
!   0.4794257    0.5646425    0.6442177    0.7173561    0.7833270 !
 
         column 11 to 15
 
!   0.8414710    0.8912074    0.9320391    0.9635582    0.9854498 !
 
         column 16 to 20
 
!   0.9974951    0.9995737    0.9916649    0.9738477    0.9463002 !
 
         column 21 to 25
 
!   0.9092975    0.8632095    0.8084966    0.7457055    0.6754635 !
 
         column 26 to 30
 
!   0.5984725    0.5155018    0.4273803    0.3349886    0.2392498 !
 
         column 31 to 32
 
!   0.1411205    0.0415812 !
 
plot(t,y)
 
// Simulation of dx/dt = A x(t) + B u(t) with u(t)=sin(omega*t),
 
// x0=[1;0] ;
 
// solution x(t) desired at t=0.1, 0.2, 0.5 ,1.
 
// A and u function are passed to RHS function in a list.
 
// B and omega are passed as global variables
 
deff('[xdot]=linear(t,x,A,u)','xdot=A*x+B*u(t)')
 
deff('[ut]=u(t)','ut=sin(omega*t)')
 
A=[1 1;0 2];B=[1;1];omega=5;
 
ode([1;0],0,[0.1,0.2,0.5,1],list(linear,A,u))
 ans  =
 
!   1.1313864    1.3274259    2.2142448    4.0094832 !
!   0.0262155    0.1060231    0.5655235    1.2912014 !
 
//
 
// Matrix notation
 
// Integration of the Riccati differential equation
 
// Xdot=A'*X + X*A - X'*B*X + C ,  X(0)=Identity
 
// Solution at t=[1,2]
 
deff('[Xdot]=ric(t,X)','Xdot=A''*X+X*A-X''*B*X+C')
 
A=[1,1;0,2]; B=[1,0;0,1]; C=[1,0;0,1];
 
X=ode(eye(A),0,t,ric)
 X  =
 
 
         column 1 to 6
 
!   1.    0.    1.1982758    0.1130791    1.3861007    0.2417168 !
!   0.    1.    0.1130791    1.4473781    0.2417168    1.9684287 !
 
         column  7 to 11
 
!   1.5541336    0.3664226    1.6967995    0.4698802    1.8133648 !
!   0.3664226    2.5117571    0.4698802    3.0167024    0.5437616 !
 
         column 12 to 16
 
!   0.5437616    1.9066685    0.5893475    1.9809361    0.6133636 !
!   3.4384217    0.5893475    3.7604591    0.6133636    3.9899615 !
 
         column 17 to 21
 
!   2.0402057    0.6234797    2.0877236    0.6258626    2.1259363 !
!   0.6234797    4.1455185    0.6258626    4.2473228    0.6246094 !
 
         column 22 to 26
 
!   0.6246094    2.1566807    0.6220905    2.181371     0.6195080 !
!   4.3123604    0.6220905    4.3532244    0.6195080    4.3786033 !
 
         column 27 to 31
 
!   2.2011308    0.6173684    2.216875     0.6158073    2.2293587 !
!   0.6173684    4.3942365    0.6158073    4.403812     0.6147853 !
 
         column 32 to 36
 
!   0.6147853    2.2392078    0.6141973    2.2469403    0.6139274 !
!   4.4096564    0.6141973    4.4132185    0.6139274    4.4153921 !
 
         column 37 to 41
 
!   2.2529827    0.6138733    2.2576835    0.6139537    2.2613257 !
!   0.6138733    4.4167241    0.6139537    4.417547     0.6141092 !
 
         column 42 to 46
 
!   0.6141092    2.2641367    0.6142986    2.2662987    0.6144953 !
!   4.4180621    0.6142986    4.4183905    0.6144953    4.4186049 !
 
         column 47 to 51
 
!   2.267956     0.6146832    2.2692226    0.6148535    2.2701881 !
!   0.6146832    4.4187488    0.6148535    4.4188485    0.6150024 !
 
         column 52 to 56
 
!   0.6150024    2.270922     0.6151292    2.2714786    0.6152351 !
!   4.4189197    0.6151292    4.4189719    0.6152351    4.4190111 !
 
         column 57 to 61
 
!   2.2718999    0.6153220    2.272218     0.6153924    2.2724578 !
!   0.6153220    4.4190411    0.6153924    4.4190643    0.6154489 !
 
         column 62 to 64
 
!   0.6154489    2.2726383    0.6154938 !
!   4.4190825    0.6154938    4.4190967 !
 
//
 
// Computation of exp(A)
 
A=[1,1;0,2];
 
deff('[xdot]=f(t,x)','xdot=A*x');
Warning :redefining function: f                       
 
 
ode(eye(A),0,1,f)
 ans  =
 
!   2.7182818    4.6707744 !
!   0.           7.3890563 !
 
ode('adams',eye(A),0,1,f)
 ans  =
 
!   2.7182818    4.6707747 !
!   0.           7.3890565 !
 
// with stiff matrix, Jacobian given
 
A=[10,0;0,-1];
 
deff('[J]=Jacobian(t,y)','J=A')
 
ode('stiff',[0;1],0,1,f,Jacobian)
 ans  =
 
!   0.        !
!   0.3678794 !
 
