 
clear;lines(0);
 
s=poly(0,'s');
 
G=[1/(s+1),s;1+s^2,3*s^3];Sl=tf2ss(G);
 
S=ss2des(Sl)
 S  =
 
 
       S(1)
 
!des  A  B  C  D  E  !
 
       S(2)
 
!   1.    0.    0.    0.    0.    0. !
!   0.    1.    0.    0.    0.    0. !
!   0.    0.    1.    0.    0.    0. !
!   0.    0.    0.    1.    0.    0. !
!   0.    0.    0.    0.    1.    0. !
!   0.    0.    0.    0.    0.  - 1. !
 
       S(3)
 
!   1.3891255    0.        !
!   0.         - 2.0657644 !
!   0.           2.2941573 !
!   0.         - 0.6851712 !
!   0.2651986    0.        !
!   1.           0.        !
 
       S(4)
 
 
         column 1 to 5
 
! - 0.1825222    0.1579730    0.1578947    0.0523964    0.9560617 !
! - 0.7249831  - 0.4739189  - 0.4736842  - 0.1571891    0.0267443 !
 
         column 6
 
!   1. !
!   0. !
 
       S(5)
 
!   0.    0. !
!   0.    0. !
 
       S(6)
 
 
         column 1 to 5
 
!   0.         - 0.6775285    0.4989676    0.5390988    0.        !
! - 0.2090816    0.3263349  - 0.2132922    0.6075455  - 0.0919079 !
!   0.           0.1770507  - 0.3622354    0.5577838    0.        !
!   0.6303729  - 0.3910685  - 0.5698044    0.0359005    0.2770986 !
!   0.           0.0249937  - 0.0184067  - 0.0198871    0.        !
!   0.           0.           0.           0.           0.        !
 
         column 6
 
!   0. !
!   0. !
!   0. !
!   0. !
!   0. !
!   1. !
 
S1=ss2des(Sl,"withD")
 S1  =
 
 
       S1(1)
 
!des  A  B  C  D  E  !
 
       S1(2)
 
!   1.    0.    0.    0.    0.    0. !
!   0.    1.    0.    0.    0.    0. !
!   0.    0.    1.    0.    0.    0. !
!   0.    0.    0.    1.    0.    0. !
!   0.    0.    0.    0.    1.    0. !
!   0.    0.    0.    0.    0.  - 1. !
 
       S1(3)
 
!   0.9570920    0.        !
!   0.           0.        !
!   0.           3.1622777 !
!   0.           0.        !
! - 0.2897841    0.        !
!   1.           0.        !
 
       S1(4)
 
! - 0.2897841    0.    0.    0.  - 0.9570920    1. !
!   0.           0.    0.  - 1.    0.           0. !
 
       S1(5)
 
!   0.    0. !
!   1.    0. !
 
       S1(6)
 
!   0.           0.    0.9996150    0.    0.           0. !
!   0.9570920    0.    0.           0.  - 0.2897841    0. !
!   0.           0.    0.           0.    0.           0. !
!   0.           1.    0.           0.    0.           0. !
!   0.           0.    0.0277457    0.    0.           0. !
!   0.           0.    0.           0.    0.           1. !
 
Des=des2ss(S);Des(5)=clean(Des(5))
    rank A^k    rcond
        4.      0.380D-15
        3.      0.866D-16
        2.      0.315D-15
        1.      0.100D+01
 Des  =
 
 
       Des(1)   (state-space system:)
 
!lss  A  B  C  D  X0  dt  !
 
       Des(2) = A matrix = 
 
  - 1.  
 
       Des(3) = B matrix = 
 
!   1.    0. !
 
       Des(4) = C matrix = 
 
!   1. !
!   0. !
 
       Des(5) = D matrix = 
 
!   0         s   !
!                 !
!        2      3 !
!   1 + s     3s  !
 
       Des(6) = X0 (initial state) = 
 
    0.  
 
       Des(7) = Time domain = 
 
     []
 
Des1=des2ss(S1)
    rank A^k    rcond
        4.      0.304D-16
        3.      0.498D-15
        2.      0.901D-16
        1.      0.100D+01
 Des1  =
 
 
       Des1(1)   (state-space system:)
 
!lss  A  B  C  D  X0  dt  !
 
       Des1(2) = A matrix = 
 
  - 1.  
 
       Des1(3) = B matrix = 
 
!   1.    0. !
 
       Des1(4) = C matrix = 
 
!   1. !
!   0. !
 
       Des1(5) = D matrix = 
 
!   1.110D-16     s   !
!                     !
!        2          3 !
!   1 + s         3s  !
 
       Des1(6) = X0 (initial state) = 
 
    0.  
 
       Des1(7) = Time domain = 
 
     []
 
