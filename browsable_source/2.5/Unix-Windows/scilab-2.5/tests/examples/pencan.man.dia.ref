 
clear;lines(0);
 
F=randpencil([],[1,2],[1,2,3],[]);
 
F=rand(6,6)*F*rand(6,6);
 
[Q,M,i1]=pencan(F);
    rank A^k    rcond
        4.      0.181D-14
        3.      0.230D+00
 
W=clean(M*F*Q)
 W  =
 
 
         column 1 to 4
 
  - 2.0435311 + s     0.7578769         0.6483456         0               !
                                                                          !
    0.0091837       - 1.1160856 + s     0.6824766         0               !
                                                                          !
    0.5701789       - 0.1778155       - 2.8403832 + s     0               !
                                                                          !
!                                                                      !
    0                 0                 0               - 1            !
            - 0.7123177s                                                  !
                                                                          !
    0                 0                 0               - 0.5565165s      !
                                                                          !
    0                 0                 0               - 1.0653701s      !
 
         column 5 to 6
 
!   0                  0               !
!                                      !
!   0                  0               !
!                                      !
!   0                  0               !
!                                      !
! - 0.0737764s         0.5148017s      !
!                                      !
! - 1 - 0.0576397s     0.4022020s      !
!                                      !
! - 0.1103429s       - 1 + 0.7699574s  !
 
roots(det(W(1:i1,1:i1)))
 ans  =
 
!   1. !
!   2. !
!   3. !
 
det(W($-2:$,$-2:$))
 ans  =
 
  - 1   
 
