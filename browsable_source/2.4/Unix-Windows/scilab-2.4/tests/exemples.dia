 
// Wed May 20 10:55:38 MET DST 1998
 
 
//====================================================
 
// ../man/arma/arma.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/arma/armac.man
 
//====================================================
 
clear;lines(0);
 
a=[1,-2.851,2.717,-0.865].*.eye(2,2)
 a  =
 
!   1.    0.  - 2.851    0.       2.717    0.     - 0.865    0.    !
!   0.    1.    0.     - 2.851    0.       2.717    0.     - 0.865 !
 
b=[0,1,1,1].*.[1;1];
 
d=[1,0.7,0.2].*.eye(2,2);
 
sig=eye(2,2);
 
ar=armac(a,b,d,2,1,sig)
 ar  =
 
 
  A(z^-1)y=B(z^-1)u + D(z^-1) e(t)
  
       | 1  0 |      |-2.851  0     |      | 2.717  0     |      |-0.865  0     |      
  A(s)=| 0  1 |s^0 + | 0     -2.851 |s^1 + | 0      2.717 |s^2 + | 0     -0.865 |s^3   
 
 
       | 0 |      | 1 |      | 1 |      | 1 |      
  B(s)=| 0 |s^0 + | 1 |s^1 + | 1 |s^2 + | 1 |s^3   
 
       | 1  0 |      | 0.7  0   |      | 0.2  0   |      
  D(s)=| 0  1 |s^0 + | 0    0.7 |s^1 + | 0    0.2 |s^2   
 
  e(t)=Sig*w(t); w(t) 2-dim white noise
 
        | 1  0 |
  Sig=  | 0  1 |
 
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/arma/armax.man
 
//====================================================
 
clear;lines(0);
 
[arc,a,b,sig,resid]=armax(); // will gives an example in dimension 1
/ / y_t = 0.2*u_{t-1}+0.01*e(t)
 rand('normal'); u=rand(1,1000);
 y=arsimul([1],[0,0.2],1,0.01,u);
 [archap,a,b,sig,resid]=armax(0,1,y,u)
/ / we must find a=1,b=[0,0.2]'
  Standard deviation of the estimator a :
     0.00000
  Standard deviation of the estimator b :
     0.00000 0.00000
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/arma/armax1.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/arma/arsimul.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/arma/narsimul.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/arma/noisegen.man
 
//====================================================
 
clear;lines(0);
 
noisegen(0.5,30,1.0);
 
x=-5:0.01:35;
 
y=feval(x,Noise);
 
plot(x,y);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/arma/odedi.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/arma/prbs_a.man
 
//====================================================
 
clear;lines(0);
 
u=prbs_a(50,10);
 
plot2d2("onn",(1:50)',u',1,"151",' ',[0,-1.5,50,1.5]);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/arma/reglin.man
 
//====================================================
 
clear;lines(0);
 
// simulation of data for a(3,5) and b(3,1)
 
x=rand(5,100);
 
aa=matrix('magi',5);aa=aa(1:3,:);
 
bb=[9;10;11]
 bb  =
 
!   9.  !
!   10. !
!   11. !
 
y=aa*x +bb*ones(1,100)+ 0.1*rand(3,100);
 
// identification
 
[a,b,sig]=reglin(x,y);
 
maxi(abs(aa-a))
 ans  =
 
    0.0293683  
 
maxi(abs(bb-b))
 ans  =
 
    0.0565691  
 
// an other example : fitting a polynom
 
f=1:100; x=[f.*f; f];
 
y= [ 2,3]*x+ 10*ones(f) + 0.1*rand(f);
 
[a,b]=reglin(x,y)
 b  =
 
    10.048337  
 a  =
 
!   2.0000003    2.9999161 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/abcd.man
 
//====================================================
 
clear;lines(0);
 
A=diag([1,2,3]);B=[1;1;1];C=[2,2,2];
 
sys=syslin('c',A,B,C);
 
sys("A")
 ans  =
 
!   1.    0.    0. !
!   0.    2.    0. !
!   0.    0.    3. !
 
sys("C")
 ans  =
 
!   2.    2.    2. !
 
[A1,B1,C1,D1]=abcd(sys);
 
A1
 A1  =
 
!   1.    0.    0. !
!   0.    2.    0. !
!   0.    0.    3. !
 
systf=ss2tf(sys);
 
[a,b,c,d]=abcd(systf)
 d  =
 
    0.  
 c  =
 
! - 0.1752831    0.  - 2.220D-16 !
 b  =
 
! - 34.230343 !
!   9.7584153 !
!   0.7860210 !
 a  =
 
!   1.8337408  - 0.5832001    0.        !
! - 1.126465     1.99978      0.7279639 !
! - 0.1340966    0.4332176    2.1664792 !
 
spec(a)
 ans  =
 
!   1. !
!   3. !
!   2. !
 
c*b-C*B
 ans  =
 
    1.776D-15  
 
c*a*b-C*A*B
 ans  =
 
  - 3.553D-15  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/abinv.man
 
//====================================================
 
clear;lines(0);
 
nu=3;ny=4;nx=7;
 
nrt=2;ngt=3;ng0=3;nvt=5;rk=2;
 
flag=list('on',nrt,ngt,ng0,nvt,rk);
 
Sl=ssrand(ny,nu,nx,flag);alfa=-1;beta=-2;
 
[X,dims,F,U,k,Z]=abinv(Sl,alfa,beta);
WARNING:system not stabilizable (or detectable)=>stabilizing the stabilizable part
 
[A,B,C,D]=abcd(Sl);dimV=dims(3);dimR=dims(1);
 
V=X(:,1:dimV);X2=X(:,dimV+1:nx);
 
X2'*(A+B*F)*V
 ans  =
 
   1.0D-16 *
 
! - 6.3107058    2.990473   - 2.3227334  - 3.5743089  - 0.7193451 !
!   3.0932244    1.0729085  - 0.0379457  - 0.2816001    3.5116886 !
 
(C+D*F)*V
 ans  =
 
   1.0D-15 *
 
! - 1.2678893    0.6339185  - 0.4029425  - 0.7382442    0.0321440 !
! - 0.0316054  - 0.0333026    0.0350341    0.0188270    0.0137718 !
! - 0.0498505  - 0.2343310  - 0.0122247  - 0.0248672    0.1247984 !
! - 0.0222719  - 0.0833951    0.0024439  - 0.0047181    0.0436815 !
 
X0=X(:,dimR+1:dimV); spec(X0'*(A+B*F)*X0)
 ans  =
 
! - 0.5       !
!   2.2785519 !
!   0.5       !
 
trzeros(Sl)
 ans  =
 
! - 0.5       !
!   2.2785519 !
!   0.5       !
 
spec(A+B*F)   //nr=2 evals at -1 and noc-dimV=2 evals at -2.
 ans  =
 
! - 1.        !
! - 1.0000000 !
! - 2.        !
! - 2.        !
!   0.5       !
!   2.2785519 !
! - 0.5       !
 
clean(ss2tf(Sl*Z))
 ans  =
 
 
         column 1 to 2
 
!                                            2 !
!   0   - 1.5957954 - 1.7858065s - 0.0983384s  !
!   -     -----------------------------------  !
!                               2              !
!   1                 4 + 4s + s               !
!                                              !
!   0     0.1045511 + 0.1211478s               !
!   -     ----------------------               !
!                         2                    !
!   1           4 + 4s + s                     !
!                                              !
!   0   - 0.0272679 + 0.146255s                !
!   -     ---------------------                !
!                        2                     !
!   1          4 + 4s + s                      !
!                                              !
!   0     0.0103304 + 0.0705948s               !
!   -     ----------------------               !
!                         2                    !
!   1           4 + 4s + s                     !
 
         column 3
 
!                                      2 !
! - 0.0991832 + 0.6223709s - 1.1663431s  !
!   -----------------------------------  !
!                         2              !
!               4 + 4s + s               !
!                                        !
! - 0.3970254 - 0.4600505s               !
!   ----------------------               !
!                   2                    !
!         4 + 4s + s                     !
!                                        !
!   0.1035481 - 0.5553933s               !
!   ----------------------               !
!                   2                    !
!         4 + 4s + s                     !
!                                        !
! - 0.0392291 - 0.2680787s               !
!   ----------------------               !
!                   2                    !
!         4 + 4s + s                     !
 
A=diag(1:6);A(2,2)=-7;A(5,5)=-9;B=[1,2;0,3;0,4;0,5;0,0;0,0];C=[zeros(3,3),eye(3,3)];
 
sl=syslin('c',A,B,C);sl=ss2ss(sl,rand(6,6));
 
[X,dims,F,U,k,Z]=abinv(sl,alfa,beta);
WARNING:system not stabilizable (or detectable)=>stabilizing the stabilizable part
WARNING:system not stabilizable (or detectable)=>stabilizing the stabilizable part
 
[A,B,C,D]=abcd(sl);clean(X'*(A+B*F)*X)
 ans  =
 
 
         column 1 to 5
 
! - 1.  - 4.5482281  - 3.8507486  - 19.284527    3.0851213 !
!   0.  - 7.           1.0895728  - 17.372212  - 6.968784  !
!   0.    0.           3.           4.6793601    1.9086086 !
!   0.    0.           0.         - 2.           2.8643006 !
!   0.    0.           0.           0.         - 9.        !
!   0.    0.           0.           0.           0.        !
 
         column 6
 
!   4.9795985 !
! - 26.643493 !
!   3.2323208 !
!   11.655119 !
! - 41.782464 !
!   6.        !
 
clean(X'*B*U)
 ans  =
 
!   3.168155  - 16.684884 !
!   0.        - 3.1496364 !
!   0.          4.796526  !
!   0.        - 6.1740692 !
!   0.          0.        !
!   0.          0.        !
 
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/arhnk.man
 
//====================================================
 
clear;lines(0);
 
A=diag([-1,-2,-3,-4,-5]);B=rand(5,1);C=rand(1,5);
 
sl=syslin('c',A,B,C);
 
slapprox=arhnk(sl,2);
 
[nk,W]=hankelsv(sl);nk
 nk  =
 
!   0.0161176 !
!   0.0000147 !
!   1.916D-08 !
!   3.728D-11 !
!   1.443D-15 !
 
[nkred,Wred]=hankelsv(slapprox);nkred
 nkred  =
 
!   0.0161176 !
!   0.0000147 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/arl2.man
 
//====================================================
 
clear;lines(0);
 
v=ones(1,20);
 
xbasc();
 
plot2d1('enn',0,[v';zeros(80,1)],2,'051',' ',[1,-0.5,100,1.5])
 
 
[d,n,e]=arl2(v,poly(1,'z','c'),1)
 e  =
 
    1.9245942  
 n  =
 
    1.3876748   
 d  =
 
  - 0.9390597 + z   
 
plot2d1('enn',0,ldiv(n,d,100),2,'000')
 
[d,n,e]=arl2(v,d,3)
 e  =
 
    1.0234193  
 n  =
 
                                       2  
    1.0579599 - 2.1005165z + 1.1416636z   
 d  =
 
                                       2   3  
  - 0.7724173 + 2.4900655z - 2.7128331z + z   
 
plot2d1('enn',0,ldiv(n,d,100),3,'000')
 
[d,n,e]=arl2(v,d,8)
 e  =
 
    0.5438038  
 n  =
 
                                       2            3            4      
  - 0.0875932 + 1.4047809z - 5.5606165z + 11.283141z - 13.790644z       
                        5            6            7                     
            + 10.510663z - 4.7129781z + 0.9808932z                      
 d  =
 
                                       2            3            4      
    0.3873518 - 2.9265652z + 10.138818z - 21.067952z + 28.760682z       
                        5            6            7   8                 
            - 26.455371z + 16.044094z - 5.8796677z + z                  
 
plot2d1('enn',0,ldiv(n,d,100),5,'000')
 
 
[d,n,e]=arl2(v,poly(1,'z','c'),4,'all')
lsode--  caution... t (=r1) and h (=r2) are
     such that t + h = t at next step
      (h = step).  integration continues
      where r1 is :   0.4220043920466D-01   and r2 :   0.3004521955118D-17      
lsode--  caution... t (=r1) and h (=r2) are
     such that t + h = t at next step
      (h = step).  integration continues
      where r1 is :   0.4220043920466D-01   and r2 :   0.3004521955118D-17      
lsode--  caution... t (=r1) and h (=r2) are
     such that t + h = t at next step
      (h = step).  integration continues
      where r1 is :   0.4220043920466D-01   and r2 :   0.2290198041166D-17      
lsode--  caution... t (=r1) and h (=r2) are
     such that t + h = t at next step
      (h = step).  integration continues
      where r1 is :   0.4220043920466D-01   and r2 :   0.2290198041166D-17      
lsode--  caution... t (=r1) and h (=r2) are
     such that t + h = t at next step
      (h = step).  integration continues
      where r1 is :   0.4220043920466D-01   and r2 :   0.1761759129155D-17      
lsode--  caution... t (=r1) and h (=r2) are
     such that t + h = t at next step
      (h = step).  integration continues
      where r1 is :   0.4220043920466D-01   and r2 :   0.1761759129155D-17      
lsode--  caution... t (=r1) and h (=r2) are
     such that t + h = t at next step
      (h = step).  integration continues
      where r1 is :   0.4220043920466D-01   and r2 :   0.1342848898140D-17      
lsode--  caution... t (=r1) and h (=r2) are
     such that t + h = t at next step
      (h = step).  integration continues
      where r1 is :   0.4220043920466D-01   and r2 :   0.1342848898140D-17      
lsode--  caution... t (=r1) and h (=r2) are
     such that t + h = t at next step
      (h = step).  integration continues
      where r1 is :   0.4220043920466D-01   and r2 :   0.1032962902799D-17      
lsode--  caution... t (=r1) and h (=r2) are
     such that t + h = t at next step
      (h = step).  integration continues
      where r1 is :   0.4220043920466D-01   and r2 :   0.1032962902799D-17      
lsode--  preceding message given i1 times
     wiil not be repeated
      where i1 is :         10                                                  
lsode--  at t (=r1), mxstep (=i1) steps   
necessary before reaching tout
      where i1 is :        500                                                  
      where r1 is :   0.4220043920466D-01                                       
lsode--  at t (=r1), mxstep (=i1) steps   
necessary before reaching tout
      where i1 is :        500                                                  
      where r1 is :   0.4220043920466D-01                                       
 e  =
 
!   0.8558485 !
!   1.0187965 !
!   1.2977637 !
 n  =
 
!                                      2            3 !
! - 0.4165009 + 1.7033634z - 2.1443885z + 0.9065455z  !
!                                                     !
!                                     2            3  !
!   1.050505 - 1.0392265z - 0.9406747z + 1.1255462z   !
!                                                     !
!                                      2            3 !
! - 0.3676051 - 0.3676051z + 0.8320205z + 0.8320205z  !
 d  =
 
!                                      2            3   4 !
!   0.6849097 - 2.9203474z + 4.7619237z - 3.5239892z + z  !
!                                                         !
!                                      2            3   4 !
! - 0.7432615 + 1.6246552z - 0.1229325z - 1.7489305z + z  !
!                                                         !
!                                      2            3   4 !
!   0.7371392 - 1.662D-13z - 1.6880577z + 1.640D-13z + z  !
 
plot2d1('enn',0,ldiv(n(1),d(1),100),10,'000')
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/balreal.man
 
//====================================================
 
clear;lines(0);
 
A=diag([-1,-2,-3,-4,-5]);B=rand(5,2);C=rand(1,5);
 
sl=syslin('c',A,B,C);
 
[slb,U]=balreal(sl);
 
Wc=clean(ctr_gram(slb))
 Wc  =
 
!   0.4712956    0.           0.           0.           0.        !
!   0.           0.0627572    0.           0.           0.        !
!   0.           0.           0.0057781    0.           0.        !
!   0.           0.           0.           0.0001541    0.        !
!   0.           0.           0.           0.           0.0000042 !
 
W0=clean(obs_gram(slb))
 W0  =
 
!   0.4712956    0.           0.           0.           0.        !
!   0.           0.0627572    0.           0.           0.        !
!   0.           0.           0.0057781    0.           0.        !
!   0.           0.           0.           0.0001541    0.        !
!   0.           0.           0.           0.           0.0000042 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/bilin.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s');z=poly(0,'z');
 
w=ssrand(1,1,3);
 
wtf=ss2tf(w);v=[2,3,-1,4];a=v(1);b=v(2);c=v(3);d=v(4);
 
[horner(wtf,(a*z+b)/(c*z+d)),ss2tf(bilin(w,[a,b,c,d]))]
 ans  =
 
 
         column 1
 
!                                      2            3 !
!   38.292693 - 16.683469z - 10.110643z + 2.9720542z  !
!   ------------------------------------------------  !
!                                          2   3      !
!      - 15.47978 + 19.616566z + 7.1456524z + z       !
 
         column 2
 
!                                      2            3 !
!   38.292693 - 16.683469z - 10.110643z + 2.9720542z  !
!   ------------------------------------------------  !
!                                          2   3      !
!      - 15.47978 + 19.616566z + 7.1456524z + z       !
 
clean(ss2tf(bilin(bilin(w,[a,b,c,d]),[d,-b,-c,a]))-wtf)
 ans  =
 
    0   
    -   
    1   
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/cainv.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/calfrq.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s')
 s  =
 
    s   
 
h=syslin('c',(s^2+2*0.9*10*s+100)/(s^2+2*0.3*10.1*s+102.01))
 h  =
 
                   2     
      100 + 18s + s      
    -----------------    
                      2  
    102.01 + 6.06s + s   
 
h1=h*syslin('c',(s^2+2*0.1*15.1*s+228.01)/(s^2+2*0.9*15*s+225))
 h1  =
 
                               2        3   4    
     22801 + 4406.18s + 382.37s + 21.02s + s     
    -----------------------------------------    
                                 2        3   4  
    22952.25 + 4117.77s + 490.63s + 33.06s + s   
 
[f1,spl]=calfrq(h1,0.01,1000);
 
rf=repfreq(h1,f1);
 
plot2d(real(rf)',imag(rf)')
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/canon.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2,3,4,5;
   1,0,0,0,0;
   0,1,0,0,0;
   6,7,8,9,0;
   0,0,0,1,0];
 
B=[1,2;
   0,0;
   0,0;
   2,1;
   0,0];
 
X=rand(5,5);A=X*A*inv(X);B=X*B;    //Controllable pair
 
[Ac,Bc,U,ind]=canon(A,B);  //Two indices --> ind=[3.2];
 
index=1;for k=1:size(ind,'*')-1,index=[index,1+sum(ind(1:k))];end
 
Acstar=Ac(index,:);Bcstar=Bc(index,:);
 
s=poly(0,'s');
 
p1=s^3+2*s^2-5*s+3;p2=(s-5)*(s-3);
 
//p1 and p2 are desired closed-loop polynomials with degrees 3,2
 
c1=coeff(p1);c1=c1($-1:-1:1);c2=coeff(p2);c2=c2($-1:-1:1);
 
Acstardesired=[-c1,0,0;0,0,0,-c2];
 
//Acstardesired(index,:) is companion matrix with char. pol=p1*p2
 
F=Bcstar\(Acstardesired-Acstar);   //Feedbak gain
 
Ac+Bc*F         // Companion form
 ans  =
 
! - 2.           5.         - 3.    0.    0.  !
!   1.           0.           0.    0.    0.  !
!   0.           1.           0.    0.    0.  !
! - 3.553D-15    3.553D-15    0.    8.  - 15. !
!   0.           0.           0.    1.    0.  !
 
spec(A+B*F/U)   // F/U is the gain matrix in original basis.
 ans  =
 
!   5.                     !
! - 3.6134703              !
!   3.                     !
!   0.8067351 + 0.4235626i !
!   0.8067351 - 0.4235626i !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/cls2dls.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s');z=poly(0,'z');
 
sl=syslin('c',(s+1)/(s^2-5*s+2));  //Continuous-time system in transfer form
 
slss=tf2ss(sl);  //Now in state-space form
 
sl1=cls2dls(slss,0.2);  //sl1= output of cls2dls
 
sl1t=ss2tf(sl1) // Converts in transfer form
 sl1t  =
 
                                       2  
  - 0.1730769 + 0.0384615s + 0.2115385s   
    -----------------------------------   
                                  2       
        2.9230769 - 3.7692308s + s        
 
sl2=horner(sl,(2/0.2)*(z-1)/(z+1))   //Compare sl2 and sl1
 sl2  =
 
                                       2  
  - 0.1730769 + 0.0384615z + 0.2115385z   
    -----------------------------------   
                                  2       
        2.9230769 - 3.7692308z + z        
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/colregul.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/cont_frm.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s');NUM=[1+s,s];den=s^2-5*s+1;
 
sl=cont_frm(NUM,den);
 
slss=ss2tf(sl);       //Compare with NUM/den
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/cont_mat.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/contr.man
 
//====================================================
 
clear;lines(0);
 
W=ssrand(2,3,5,list('co',3));  //cont. subspace has dim 3.
 
A=W("A");B=W("B");
 
[n,U]=contr(A,B);n
 n  =
 
    3.  
 
A1=U'*A*U;
 
spec(A1(n+1:$,n+1:$))  //uncontrollable modes
 ans  =
 
!   0.6948238 !
! - 1.2565263 !
 
spec(A+B*rand(3,5))
 ans  =
 
!   23.738965              !
! - 0.0309531 + 0.3941319i !
! - 0.0309531 - 0.3941319i !
!   0.6948238              !
! - 1.2565263              !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/contrss.man
 
//====================================================
 
clear;lines(0);
 
A=[1,1;0,2];B=[1;0];C=[1,1];sl=syslin('c',A,B,C);  //Non minimal
 
slc=contrss(sl);
 
sl1=ss2tf(sl);sl2=ss2tf(slc);      //Compare sl1 and sl2
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/csim.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s');rand('seed',0);w=ssrand(1,1,3);w('A')=w('A')-2*eye;
 
t=0:0.05:5;
 
//impulse(w) = step (s * w)
 
xbasc(0);xset("window",0);xselect();
 
plot2d([t',t'],[(csim('step',t,tf2ss(s)*w))',0*t'])
 
xbasc(1);xset("window",1);xselect();
 
plot2d([t',t'],[(csim('impulse',t,w))',0*t'])
 
//step(w) = impulse (s^-1 * w)
 
xbasc(3);xset("window",3);xselect();
 
plot2d([t',t'],[(csim('step',t,w))',0*t'])
 
xbasc(4);xset("window",4);xselect();
 
plot2d([t',t'],[(csim('impulse',t,tf2ss(1/s)*w))',0*t'])
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/ctr_gram.man
 
//====================================================
 
clear;lines(0);
 
A=diag([-1,-2,-3]);B=rand(3,2);
 
Wc=ctr_gram(A,B)
 Wc  =
 
!   0.0768871    0.1265214    0.0519054 !
!   0.1265214    0.2535836    0.0836574 !
!   0.0519054    0.0836574    0.0658127 !
 
U=rand(3,3);A1=U*A/U;B1=U*B;
 
Wc1=ctr_gram(A1,B1)    //Not invariant!
 Wc1  =
 
!   0.1785097    0.2000694    0.2741635 !
!   0.2000694    0.2485908    0.3323558 !
!   0.2741635    0.3323558    0.4471744 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/dbphi.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/des2tf.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s');
 
G=[1/(s+1),s;1+s^2,3*s^3];
 
Descrip=tf2des(G);Tf1=des2tf(Descrip)
    rank A^k    rcond
        4.      0.411E-16
        3.      0.150E-15
        2.      0.248E-15
        1.      0.100E+01
 Tf1  =
 
!     1       s   !
!   -----     -   !
!   1 + s     1   !
!                 !
!        2      3 !
!   1 + s     3s  !
!   -----    ---  !
!     1       1   !
 
Descrip2=tf2des(G,"withD");Tf2=des2tf(Descrip2)
    rank A^k    rcond
        4.      0.152E-16
        3.      0.260E-15
        2.      0.450E-16
        1.      0.100E+01
 Tf2  =
 
!     1       s   !
!   -----     -   !
!   1 + s     1   !
!                 !
!        2      3 !
!   1 + s     3s  !
!   -----    ---  !
!     1       1   !
 
[A,B,C,D,E]=Descrip2(2:6);Tf3=C*inv(s*E-A)*B+D
    rank A^k    rcond
        4.      0.152E-16
        3.      0.260E-15
        2.      0.450E-16
        1.      0.100E+01
 Tf3  =
 
!     1       s   !
!   -----     -   !
!   1 + s     1   !
!                 !
!        2      3 !
!   1 + s     3s  !
!   -----    ---  !
!     1       1   !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/dscr.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s');
 
Sys=syslin('c',[1,1/(s+1);2*s/(s^2+2),1/s])
 Sys  =
 
!   1           1    !
!   -         -----  !
!   1         1 + s  !
!                    !
!    2s       1      !
!   ----      -      !
!        2           !
!   2 + s     s      !
 
ss2tf(dscr(tf2ss(Sys),0.1))
 ans  =
 
!   1                          0.0951626    !
!   -                        -------------  !
!   1                      - 0.9048374 + z  !
!                                           !
! - 0.199334 + 0.199334z      0.1           !
!   --------------------     -----          !
!                      2                    !
!    1 - 1.9800333z + z    - 1 + z          !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/dsimul.man
 
//====================================================
 
clear;lines(0);
 
z=poly(0,'z');
 
h=(1-2*z)/(z^2-0.2*z+1);
 
sl=tf2ss(h);
 
u=zeros(1,20);u(1)=1;
 
x1=dsimul(sl,u)   //Impulse response
 x1  =
 
 
         column 1 to 8
 
!   0.  - 2.    0.6    2.12  - 0.176  - 2.1552  - 0.25504    2.104192 !
 
         column  9 to 13
 
!   0.6758784  - 1.9690163  - 1.0696817    1.75508    1.4206977 !
 
         column 14 to 18
 
! - 1.4709405  - 1.7148858    1.1279633    1.9404784  - 0.7398676 !
 
         column 19 to 20
 
! - 2.0884519    0.3221772 !
 
u=ones(20,1);
 
x2=dsimul(sl,u);  //Step response
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/dt_ility.man
 
//====================================================
 
clear;lines(0);
 
A=[2,1,1;0,-2,1;0,0,3];
 
C=[0,0,1];
 
X=rand(3,3);A=inv(X)*A*X;C=C*X;
 
W=syslin('c',A,[],C);
 
[k,n,U,W1]=dt_ility(W);
 
W1("A")
 ans  =
 
!   2.  - 5.4884071  - 7.3857012 !
!   0.  - 2.         - 4.7396498 !
!   0.    0.           3.        !
 
W1("C")
 ans  =
 
!   0.    0.  - 1.0798798 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/equil.man
 
//====================================================
 
clear;lines(0);
 
P=rand(4,4);P=P*P';
 
Q=rand(4,4);Q=Q*Q';
 
T=equil(P,Q)
 T  =
 
! - 0.5645395  - 0.4922141  - 0.6499679  - 0.2471442 !
!   0.5194514  - 0.3215897    0.1314788  - 0.1730528 !
! - 0.0694226    0.1668818  - 0.9460375    0.9500789 !
! - 0.0647534  - 0.5809010    0.9494819  - 0.2816940 !
 
clean(T*P*T')
 ans  =
 
!   3.173747    0.           0.           0.        !
!   0.          0.2149746    0.           0.        !
!   0.          0.           0.0666303    0.        !
!   0.          0.           0.           0.0391841 !
 
clean(inv(T)'*Q*inv(T))
 ans  =
 
!   3.173747    0.           0.           0.        !
!   0.          0.2149746    0.           0.        !
!   0.          0.           0.0666303    0.        !
!   0.          0.           0.           0.0391841 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/equil1.man
 
//====================================================
 
clear;lines(0);
 
S1=rand(2,2);S1=S1*S1';
 
S2=rand(2,2);S2=S2*S2';
 
S3=rand(2,2);S3=S3*S3';
 
P=sysdiag(S1,S2,zeros(4,4));
 
Q=sysdiag(S1,zeros(2,2),S3,zeros(2,2));
 
X=rand(8,8);
 
P=X*P*X';Q=inv(X)'*Q*inv(X);
 
[T,siz]=equil1(P,Q);
 
P1=clean(T*P*T')
 P1  =
 
!   0.6444532    0.           0.           0.    0.    0.    0.    0. !
!   0.           0.0351805    0.           0.    0.    0.    0.    0. !
!   0.           0.           3.910D-08    0.    0.    0.    0.    0. !
!   0.           0.           0.           1.    0.    0.    0.    0. !
!   0.           0.           0.           0.    0.    0.    0.    0. !
!   0.           0.           0.           0.    0.    0.    0.    0. !
!   0.           0.           0.           0.    0.    0.    0.    0. !
!   0.           0.           0.           0.    0.    0.    0.    0. !
 
Q1=clean(inv(T)'*Q*inv(T))
 Q1  =
 
 
         column 1 to 6
 
!   0.6444532    0.           0.           0.    0.          0.        !
!   0.           0.0351805    0.           0.    0.          0.        !
!   0.           0.           4.463D-08    0.    0.          0.        !
!   0.           0.           0.           0.    0.          0.        !
!   0.           0.           0.           0.    28.43488    0.        !
!   0.           0.           0.           0.    0.          0.7436970 !
!   0.           0.           0.           0.    0.          0.        !
!   0.           0.           0.           0.    0.          0.        !
 
         column 7 to 8
 
!   0.    0. !
!   0.    0. !
!   0.    0. !
!   0.    0. !
!   0.    0. !
!   0.    0. !
!   0.    0. !
!   0.    0. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/feedback.man
 
//====================================================
 
clear;lines(0);
 
S1=ssrand(2,2,3);S2=ssrand(2,2,2);
 
W=S1/.S2;
 
ss2tf(S1/.S2)
 ans  =
 
 
         column 1
 
!                                        2            3            4   !
!   - 20.640724 + 11.156994s + 12.078981s + 0.2610493s + 3.4056939s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
!   6.3354029 + 2.8130151s - 8.8820267s + 2.1503939s + 0.3513632s      !
!         5                                                            !
!      + s                                                             !
!                                                                      !
!                                        2            3            4   !
!   - 33.277689 - 23.743158s + 4.0577055s + 1.8230128s - 0.9289148s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
!   6.3354029 + 2.8130151s - 8.8820267s + 2.1503939s + 0.3513632s      !
!         5                                                            !
!      + s                                                             !
 
         column 2
 
!                                        2            3            4   !
!   - 7.3909534 - 2.9497215s + 8.6754815s + 4.1967427s - 0.7149850s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
!   6.3354029 + 2.8130151s - 8.8820267s + 2.1503939s + 0.3513632s      !
!         5                                                            !
!      + s                                                             !
!                                                                      !
!                                        2            3            4   !
!   - 7.1521012 - 11.765539s - 6.4457367s + 1.5352406s + 1.9661457s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
!   6.3354029 + 2.8130151s - 8.8820267s + 2.1503939s + 0.3513632s      !
!         5                                                            !
!      + s                                                             !
 
//Same operation by LFT:
 
ss2tf(lft([zeros(2,2),eye(2,2);eye(2,2),-S2],S1))
 ans  =
 
 
         column 1
 
!                                        2            3            4   !
!   - 20.640724 + 11.156994s + 12.078981s + 0.2610493s + 3.4056939s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
!   6.3354029 + 2.8130151s - 8.8820267s + 2.1503939s + 0.3513632s      !
!         5                                                            !
!      + s                                                             !
!                                                                      !
!                                        2            3            4   !
!   - 33.277689 - 23.743158s + 4.0577055s + 1.8230128s - 0.9289148s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
!   6.3354029 + 2.8130151s - 8.8820267s + 2.1503939s + 0.3513632s      !
!         5                                                            !
!      + s                                                             !
 
         column 2
 
!                                        2            3            4   !
!   - 7.3909534 - 2.9497215s + 8.6754815s + 4.1967427s - 0.7149850s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
!   6.3354029 + 2.8130151s - 8.8820267s + 2.1503939s + 0.3513632s      !
!         5                                                            !
!      + s                                                             !
!                                                                      !
!                                        2            3            4   !
!   - 7.1521012 - 11.765539s - 6.4457367s + 1.5352406s + 1.9661457s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
!   6.3354029 + 2.8130151s - 8.8820267s + 2.1503939s + 0.3513632s      !
!         5                                                            !
!      + s                                                             !
 
//Other approach: with constant feedback
 
BigS=sysdiag(S1,S2); F=[zeros(2,2),eye(2,2);-eye(2,2),zeros(2,2)];
 
Bigclosed=BigS/.F;
 
W1=Bigclosed(1:2,1:2);   //W1=W (in state-space).
 
ss2tf(W1)
 ans  =
 
 
         column 1
 
!                                        2            3            4   !
!   - 20.640724 + 11.156994s + 12.078981s + 0.2610493s + 3.4056939s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
!   6.3354029 + 2.8130151s - 8.8820267s + 2.1503939s + 0.3513632s      !
!         5                                                            !
!      + s                                                             !
!                                                                      !
!                                        2            3            4   !
!   - 33.277689 - 23.743158s + 4.0577055s + 1.8230128s - 0.9289148s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
!   6.3354029 + 2.8130151s - 8.8820267s + 2.1503939s + 0.3513632s      !
!         5                                                            !
!      + s                                                             !
 
         column 2
 
!                                        2            3            4   !
!   - 7.3909534 - 2.9497215s + 8.6754815s + 4.1967427s - 0.7149850s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
!   6.3354029 + 2.8130151s - 8.8820267s + 2.1503939s + 0.3513632s      !
!         5                                                            !
!      + s                                                             !
!                                                                      !
!                                        2            3            4   !
!   - 7.1521012 - 11.765539s - 6.4457367s + 1.5352406s + 1.9661457s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
!   6.3354029 + 2.8130151s - 8.8820267s + 2.1503939s + 0.3513632s      !
!         5                                                            !
!      + s                                                             !
 
//Inverting
 
ss2tf(S1*inv(eye+S2*S1))
 ans  =
 
 
         column 1
 
!                                        2            3            4   !
!   - 20.640724 + 11.156994s + 12.078981s + 0.2610493s + 3.4056939s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
!   6.3354029 + 2.8130151s - 8.8820267s + 2.1503939s + 0.3513632s      !
!         5                                                            !
!      + s                                                             !
!                                                                      !
!                                        2            3            4   !
!   - 33.277689 - 23.743158s + 4.0577055s + 1.8230128s - 0.9289148s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
!   6.3354029 + 2.8130151s - 8.8820267s + 2.1503939s + 0.3513632s      !
!         5                                                            !
!      + s                                                             !
 
         column 2
 
!                                        2            3            4   !
!   - 7.3909534 - 2.9497215s + 8.6754815s + 4.1967427s - 0.7149850s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
!   6.3354029 + 2.8130151s - 8.8820267s + 2.1503939s + 0.3513632s      !
!         5                                                            !
!      + s                                                             !
!                                                                      !
!                                        2            3            4   !
!   - 7.1521012 - 11.765539s - 6.4457367s + 1.5352406s + 1.9661457s    !
!   -----------------------------------------------------------------  !
!                                      2            3            4     !
!   6.3354029 + 2.8130151s - 8.8820267s + 2.1503939s + 0.3513632s      !
!         5                                                            !
!      + s                                                             !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/flts.man
 
//====================================================
 
clear;lines(0);
 
sl=syslin('d',1,1,1);u=1:10;
 
y=flts(u,sl);
 
plot2d2("onn",(1:size(u,'c'))',y')
 
[y1,x1]=flts(u(1:5),sl);y2=flts(u(6:10),sl,x1);
 
y-[y1,y2]
 ans  =
 
!   0.    0.    0.    0.    0.    0.    0.    0.    0.    0. !
 
 
//With polynomial D:
 
z=poly(0,'z');
 
D=1+z+z^2; p =degree(D);
 
sl=syslin('d',1,1,1,D);
 
y=flts(u,sl);[y1,x1]=flts(u(1:5),sl);
 
y2=flts(u(5-p+1:10),sl,x1);  // (update)
 
y-[y1,y2]
 ans  =
 
!   0.    0.    0.    0.    0.    0.    0.    0. !
 
 
//Delay (transfer form): flts(u,1/z)
 
// Usual responses
 
z=poly(0,'z');
 
h=(1-2*z)/(z^2+0.3*z+1)
 h  =
 
       1 - 2z      
    ------------   
                2  
    1 + 0.3z + z   
 
u=zeros(1,20);u(1)=1;
 
imprep=flts(u,tf2ss(h));   //Impulse response
 
plot2d2("onn",(1:size(u,'c'))',imprep')
 
u=ones(1,20);
 
stprep=flts(u,tf2ss(h));   //Step response
 
plot2d2("onn",(1:size(u,'c'))',stprep')
 
//
 
// Other examples
 
A=[1 2 3;0 2 4;0 0 1];B=[1 0;0 0;0 1];C=eye(3,3);Sys=syslin('d',A,B,C);
 
H=ss2tf(Sys); u=[1;-1]*(1:10);
 
//
 
yh=flts(u,H); ys=flts(u,Sys);
 
norm(yh-ys,1)
 ans  =
 
    1.365D-11  
 
//hot restart
 
[ys1,x]=flts(u(:,1:4),Sys);ys2=flts(u(:,5:10),Sys,x);
 
norm([ys1,ys2]-ys,1)
 ans  =
 
    0.  
 
//
 
yh1=flts(u(:,1:4),H);yh2=flts(u(:,5:10),H,[u(:,2:4);yh(:,2:4)]);
 
norm([yh1,yh2]-yh,1)
 ans  =
 
    0.  
 
//with D<>0
 
D=[-3 8;4 -0.5;2.2 0.9];
 
Sys=syslin('d',A,B,C,D);
 
H=ss2tf(Sys); u=[1;-1]*(1:10);
 
rh=flts(u,H); rs=flts(u,Sys);
 
norm(rh-rs,1)
 ans  =
 
    1.639D-11  
 
//hot restart
 
[ys1,x]=flts(u(:,1:4),Sys);ys2=flts(u(:,5:10),Sys,x);
 
norm([ys1,ys2]-rs,1)
 ans  =
 
    0.  
 
//With H:
 
yh1=flts(u(:,1:4),H);yh2=flts(u(:,5:10),H,[u(:,2:4); yh1(:,2:4)]);
 
norm([yh1,yh2]-rh)
 ans  =
 
    1.369D-12  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/frep2tf.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s');
 
h=syslin('c',(s-1)/(s^3+5*s+20))
 h  =
 
     - 1 + s      
    -----------   
               3  
    20 + 5s + s   
 
frq=0:0.05:3;repf=repfreq(h,frq);
 
clean(frep2tf(frq,repf,3))
 ans  =
 
    - 0.05 + 0.05s      
    ----------------    
                     3  
    1 + 0.25s + 0.05s   
 
 
Sys=ssrand(1,1,10);
 
frq=logspace(-3,2,200);
 
[frq,rep]=repfreq(Sys,frq);  //Frequency response of Sys
 
[Sys2,err]=frep2tf(frq,rep,10);Sys2=clean(Sys2)//Sys2 obtained from freq. resp of Sys
 Sys2  =
 
                                       2            3            4      
    15.604836 - 2.4990478s - 14.922811s + 6.4520983s - 1.7491581s       
                   5            6            7            8             
       + 0.2326246s - 0.2362542s + 0.0200656s + 0.0445306s              
                    9                                                   
       - 0.0084055s                                                     
    ------------------------------------------------------------------  
                                       2            3            4      
  - 4.5344981 + 4.1524119s - 4.9962771s + 2.1531688s - 0.6723371s       
                   5            6            7            8             
       + 0.1186838s - 0.0291236s + 0.0032039s + 0.0174684s              
                    9           10                                      
       + 0.0052477s - 0.0020467s                                        
 
[frq,rep2]=repfreq(Sys2,frq); //Frequency response of Sys2
 
xbasc();bode(frq,[rep;rep2])   //Responses of Sys and Sys2
 
[sort(trzeros(Sys)),sort(roots(Sys2('num')))]  //zeros
 ans  =
 
!   4.3540227                 4.3540227              !
!   3.5414107 + 2.3618478i    3.5414107              !
!   1.3471793 - 2.3618478i    1.3471793 + 2.3618478i !
!   1.3471793                 1.3471793 - 2.3618478i !
!   1.1421496                 1.1421496 + 1.8425944i !
! - 0.8927681 + 1.8425944i  - 0.8927681 - 1.8425944i !
! - 1.1030175 - 1.8425944i  - 1.1030175              !
! - 1.1030175               - 1.1030175              !
! - 3.3353291               - 3.3353291              !
 
[sort(spec(Sys('A'))),sort(roots(Sys2('den')))] //poles
 ans  =
 
!   4.4381977 + 1.3340877i    4.4381977 + 1.1408591i !
!   2.1329462 - 1.3340877i    2.1329462 - 1.1408591i !
!   1.1620666                 1.1620666 + 2.1718846i !
!   1.1620666 + 2.1718846i    1.1620666 - 2.1718846i !
!   0.2641970 - 2.1718846i    0.2641970 + 1.4586145i !
!   0.2641970 + 1.4586145i    0.2641970 - 1.4586145i !
! - 0.6374557 - 1.4586145i  - 0.6374557              !
! - 0.6374557 + 1.1408591i  - 0.6374557              !
! - 2.7924103 - 1.1408591i  - 2.7924103 + 1.3340877i !
! - 2.7924103               - 2.7924103 - 1.3340877i !
 
 
dom=1/1000; // Sampling time
 
z=poly(0,'z');
 
h=syslin(dom,(z^2+0.5)/(z^3+0.1*z^2-0.5*z+0.08))
 h  =
 
                  2          
           0.5 + z           
    ---------------------    
                      2   3  
    0.08 - 0.5z + 0.1z + z   
 
frq=(0:0.01:0.5)/dom;repf=repfreq(h,frq);
 
[Sys2,err]=frep2tf(frq,repf,3,dom);
 
[frq,rep2]=repfreq(Sys2,frq); //Frequency response of Sys2
 
xbasc();plot2d1("onn",frq',abs([repf;rep2])');
 
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/freq.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s');
 
sys=(s+1)/(s^3-5*s+4)
 sys  =
 
      1 + s      
    ---------    
              3  
    4 - 5s + s   
 
rep=freq(sys("num"),sys("den"),[0,0.9,1.1,2,3,10,20])
 rep  =
 
 
         column 1 to 6
 
!   0.25    8.2969432  - 12.426036    1.5    0.25    0.0115304 !
 
         column 7
 
!   0.0026569 !
 
[horner(sys,0),horner(sys,20)]
 ans  =
 
!   0.25    0.0026569 !
 
//
 
Sys=tf2ss(sys);
 
[A,B,C,D]=abcd(Sys);
 
freq(A,B,C,[0,0.9,1.1,2,3,10,20])
 ans  =
 
 
         column 1 to 6
 
!   0.25    8.2969432  - 12.426036    1.5    0.25    0.0115304 !
 
         column 7
 
!   0.0026569 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/freson.man
 
//====================================================
 
clear;lines(0);
 
h=syslin('c',-1+%s,(3+2*%s+%s^2)*(50+0.1*%s+%s^2))
 h  =
 
               - 1 + s                
    -------------------------------   
                        2      3   4  
    150 + 100.3s + 53.2s + 2.1s + s   
 
fr=freson(h)
 fr  =
 
!   1.1252798 !
!   0.2616210 !
 
bode(h)
 
g=20*log(abs(repfreq(h,fr)))/log(10)
 g  =
 
! - 13.73145  - 38.185535 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/g_margin.man
 
//====================================================
 
clear;lines(0);
 
h=syslin('c',-1+%s,3+2*%s+%s^2)
 h  =
 
    - 1 + s      
    ---------    
              2  
    3 + 2s + s   
 
[g,fr]=g_margin(h)
 fr  =
 
     []
 g  =
 
   Inf  
 
[g,fr]=g_margin(h-10)
 fr  =
 
    0.3558813  
 g  =
 
  - 19.554472  
 
nyquist(h-10)
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/gfrancis.man
 
//====================================================
 
clear;lines(0);
 
Plant=ssrand(1,3,5);
 
[F,G,H,J]=abcd(Plant);
 
nw=4;nuu=2;A=rand(nw,nw);
 
st=maxi(real(spec(A)));A=A-st*eye(A);
 
B=rand(nw,nuu);C=2*rand(1,nw);D=0*rand(C*B);
 
Model=syslin('c',A,B,C,D);
 
[L,M,T]=gfrancis(Plant,Model);
 
norm(F*T+G*L-T*A,1)
 ans  =
 
    1.960D-14  
 
norm(H*T+J*L-C,1)
 ans  =
 
    1.266D-14  
 
norm(G*M-T*B,1)
 ans  =
 
    8.216D-15  
 
norm(J*M-D,1)
 ans  =
 
    0.  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/imrep2ss.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s');
 
H=[1/(s+0.5);2/(s-0.4)]   //strictly proper
 H  =
 
!      1     !
!   -------  !
!   0.5 + s  !
!            !
!      2     !
!   -------  !
! - 0.4 + s  !
 
np=20;w=ldiv(H('num'),H('den'),np);
 
rep=[w(1:np)';w(np+1:2*np)'];   //The impulse response
 
H1=ss2tf(imrep2ss(rep))
 H1  =
 
!         1        !
!   -------------  !
!   0.4999986 + z  !
!                  !
!         2        !
!   -------------  !
! - 0.4000000 + z  !
 
z=poly(0,'z');
 
H=(2*z^2-3.4*z+1.5)/(z^2-1.6*z+0.8)     //Proper transfer function
 H  =
 
                   2  
    1.5 - 3.4z + 2z   
    ---------------   
                  2   
    0.8 - 1.6z + z    
 
u=zeros(1,20);u(1)=1;
 
rep=rtitr(H('num'),H('den'),u);   //Impulse rep.
 
//   <=> rep=ldiv(H('num'),H('den'),20)
 
w=z*imrep2ss(rep)   //Realization with shifted impulse response
 w  =
 
 
       w(1)   (state-space system:)
 
!lss  A  B  C  D  X0  dt  !
 
       w(2) = A matrix = 
 
!   0.1831109    0.4516462  - 0.6769688 !
! - 0.3169782    0.8422011    0.3319334 !
! - 0.1868225  - 0.1348586    0.5221138 !
 
       w(3) = B matrix = 
 
! - 2.1798455 !
!   0.3594529 !
! - 0.2483085 !
 
       w(4) = C matrix = 
 
! - 0.0346832  - 0.5221613    0.3540419 !
 
       w(5) = D matrix = 
 
    2.  
 
       w(6) = X0 (initial state) = 
 
!   0. !
!   0. !
!   0. !
 
       w(7) = Time domain = 
 
 d   
 
// i.e strictly proper to proper
 
H2=ss2tf(w);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/invsyslin.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/kpure.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s');
 
h=syslin('c',(s-1)/(1+5*s+s^2+s^3))
 h  =
 
      - 1 + s        
    -------------    
              2   3  
    1 + 5s + s + s   
 
xbasc();evans(h)
 
g=kpure(h)
 g  =
 
  - 2.  
 
hf=h/.g(1)
 hf  =
 
      - 1 + s        
    -------------    
              2   3  
    3 + 3s + s + s   
 
roots(denom(hf))
 ans  =
 
! - 1.         !
!   1.7320508i !
! - 1.7320508i !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/krac2.man
 
//====================================================
 
clear;lines(0);
 
h=syslin('c',352*poly(-5,'s')/poly([0,0,2000,200,25,1],'s','c'));
 
xbasc();evans(h,100)
 
g=krac2(h)
 g  =
 
!   86.045364    85.227273    0. !
 
hf1=h/.g(1);roots(denom(hf1))
 ans  =
 
!   4.2155868 + 9.7449415i !
!   4.2155868 - 9.7449415i !
! - 9.0086779              !
! - 12.211247              !
! - 12.211248              !
 
hf2=h/.g(2);roots(denom(hf2))
 ans  =
 
!   4.1897217 + 9.7241205i !
!   4.1897217 - 9.7241205i !
! - 10.                    !
! -10.                     !
! - 13.379443              !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/lin.man
 
//====================================================
 
clear;lines(0);
 
deff('[y,xdot]=sim(x,u)','xdot=[u*sin(x);-u*x^2];y=xdot(1)+xdot(2)')
 
sl=lin(sim,1,2);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/lqe.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/lqg.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/lqg2stan.man
 
//====================================================
 
clear;lines(0);
 
ny=2;nu=3;nx=4;
 
P22=ssrand(ny,nu,nx);
 
bigQ=rand(nx+nu,nx+nu);bigQ=bigQ*bigQ';
 
bigR=rand(nx+ny,nx+ny);bigR=bigR*bigR';
 
[P,r]=lqg2stan(P22,bigQ,bigR);K=lqg(P,r);  //K=LQG-controller
 
spec(h_cl(P,r,K))      //Closed loop should be stable
 ans  =
 
! - 1.1244059 + 2.8439989i !
! - 1.1244059 - 2.8439989i !
! - 1.4277871 + 2.4281715i !
! - 1.4277871 - 2.4281715i !
! - 3.296596               !
! - 1.501728               !
! - 2.4466454 + 0.4773244i !
! - 2.4466454 - 0.4773244i !
 
//Same as Cl=P22/.K; spec(Cl('A'))
 
s=poly(0,'s')
 s  =
 
    s   
 
lqg2stan(1/(s+2),eye(2,2),eye(2,2))
WARNING:lqg2stan: time domain (?) assumed continuous
 ans  =
 
!     1       0       1    !
!   -----     -     -----  !
!   2 + s     1     2 + s  !
!                          !
!   0         0     1      !
!   -         -     -      !
!   1         1     1      !
!                          !
!   - 1       1     - 1    !
!   -----     -     -----  !
!   2 + s     1     2 + s  !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/lqr.man
 
//====================================================
 
clear;lines(0);
 
A=rand(2,2);B=rand(2,1);   //two states, one input
 
Q=diag([2,5]);R=2;     //Usual notations x'Qx + u'Ru
 
Big=sysdiag(Q,R);    //Now we calculate C1 and D12
 
[w,wp]=fullrf(Big);C1=w(:,1:2);D12=w(:,3);   //[C1,D12]'*[C1,D12]=Big
 
P=syslin('c',A,B,C1,D12);    //The plant (continuous-time)
 
[K,X]=lqr(P)
 X  =
 
!   3.6831015    0.5403485 !
!   0.5403485    5.6662118 !
 K  =
 
! - 2.004187  - 2.1065943 !
 
spec(A+B*K)    //check stability
 ans  =
 
! - 2.129099  !
! - 0.4169356 !
 
norm(A'*X+X*A-X*B*inv(R)*B'*X+Q,1)  //Riccati check
 ans  =
 
    3.  
 
P=syslin('d',A,B,C1,D12);    // Discrete time plant
 
[K,X]=lqr(P)
 X  =
 
!   6.4571621    0.6396400 !
!   0.6396400    3.1615817 !
 K  =
 
! - 0.4049881  - 0.6852843 !
 
spec(A+B*K)   //check stability
 ans  =
 
! - 0.3505741 !
!   0.3149634 !
 
norm(A'*X*A-(A'*X*B)*pinv(B'*X*B+R)*(B'*X*A)+Q-X,1) //Riccati check
 ans  =
 
    3.  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/ltitr.man
 
//====================================================
 
clear;lines(0);
 
A=eye(2,2);B=[1;1];
 
x0=[-1;-2];
 
u=[1,2,3,4,5];
 
x=ltitr(A,B,u,x0)
 x  =
 
! - 1.    0.    2.    5.    9. !
! - 2.  - 1.    1.    4.    8. !
 
x1=A*x0+B*u(1)
 x1  =
 
!   0. !
! - 1. !
 
x2=A*x1+B*u(2)
 x2  =
 
!   2. !
!   1. !
 
x3=A*x2+B*u(3) //....
 x3  =
 
!   5. !
!   4. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/markp2ss.man
 
//====================================================
 
clear;lines(0);
 
W=ssrand(2,3,4);   //random system with 2 outputs and 3 inputs
 
[a,b,c,d]=abcd(W);
 
markpar=[c*b,c*a*b,c*a^2*b,c*a^3*b,c*a^4*b];
 
S=markp2ss(markpar,5,2,3);
 
[A,B,C,D]=abcd(S);
 
Markpar=[C*B,C*A*B,C*A^2*B,C*A^3*B,C*A^4*B];
 
norm(markpar-Markpar,1)
 ans  =
 
    2.167D-13  
 
//Caution... c*a^5*b is not C*A^5*B !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/minreal.man
 
//====================================================
 
clear;lines(0);
 
A=[-eye(2,2),rand(2,2);zeros(2,2),-2*eye(2,2)];
 
B=[rand(2,2);zeros(2,2)];C=rand(2,4);
 
sl=syslin('c',A,B,C);
 
slb=minreal(sl);
 
ss2tf(sl)
 ans  =
 
!   0.9367813     1.1308516  !
!   ---------     ---------  !
!     1 + s         1 + s    !
!                            !
!   0.4617145     0.5122992  !
!   ---------     ---------  !
!     1 + s         1 + s    !
 
ss2tf(slb)
 ans  =
 
!   0.9367813     1.1308516  !
!   ---------     ---------  !
!     1 + s         1 + s    !
!                            !
!   0.4617145     0.5122992  !
!   ---------     ---------  !
!     1 + s         1 + s    !
 
ctr_gram(sl)
 ans  =
 
!   0.5823995    0.5004083  - 1.665D-16    0. !
!   0.5004083    0.4325516  - 1.325D-16    0. !
! - 1.665D-16  - 1.325D-16    0.           0. !
!   0.           0.           0.           0. !
 
clean(ctr_gram(slb))
 ans  =
 
!   0.8110699    0.        !
!   0.           0.0130131 !
 
clean(obs_gram(slb))
 ans  =
 
!   0.8110699    0.        !
!   0.           0.0130131 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/minss.man
 
//====================================================
 
clear;lines(0);
 
sl=syslin('c',[1 0;0 2],[1;0],[2 1]);
 
ssprint(sl);
 
.   | 1  0 |    | 1 |
x = | 0  2 |x + | 0 |u   
 
y = | 2  1 |x   
 
ssprint(minss(sl))
 
.           
x = | 1 |x + | 1 |u   
 
y = | 2 |x   
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/obs_gram.man
 
//====================================================
 
clear;lines(0);
 
A=rand(3,3);C=rand(2,3);
 
Go=obs_gram(A,C,'c');     // <=> w=syslin('c',A,[],C); Go=obs_gram(w);
 
norm(Go*A+A'*Go+C'*C,1)
 ans  =
 
    1.554D-15  
 
norm(lyap(A,-C'*C,'c')-Go,1)
 ans  =
 
    0.  
 
Go=obs_gram(A,C,'d');    //discrete time case
 
norm(lyap(A,-C'*C,'d')-Go,1)
 ans  =
 
    0.  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/obscont.man
 
//====================================================
 
clear;lines(0);
 
ny=2;nu=3;nx=4;P=ssrand(ny,nu,nx);[A,B,C,D]=abcd(P);
 
Kc=-ppol(A,B,[-1,-1,-1,-1]);  //Controller gain
 
Kf=-ppol(A',C',[-2,-2,-2,-2]);Kf=Kf';    //Observer gain
 
cl=P/.(-obscont(P,Kc,Kf));spec(cl('A'))   //closed loop system
 ans  =
 
! - 0.9998896 + 0.0001104i !
! - 0.9998896 - 0.0001104i !
! - 1.0001104 + 0.0001104i !
! - 1.0001104 - 0.0001104i !
! - 2.0000065 + 0.0000113i !
! - 2.0000065 - 0.0000113i !
! - 1.999987               !
! - 2.                     !
 
[J,r]=obscont(P,Kc,Kf);
 
Q=ssrand(nu,ny,3);Q('A')=Q('A')-(maxi(real(spec(Q('A'))))+0.5)*eye(Q('A'))
 Q  =
 
 
       Q(1)   (state-space system:)
 
!lss  A  B  C  D  X0  dt  !
 
       Q(2) = A matrix = 
 
! - 2.5268873    0.7223316  - 0.6834217 !
!   1.4739762  - 1.1271545    0.8145126 !
!   0.8529775    0.2546697  - 1.9537185 !
 
       Q(3) = B matrix = 
 
! - 1.0327357  - 1.7086774 !
! - 0.9239258    0.0698768 !
!   2.7266682  - 1.3772844 !
 
       Q(4) = C matrix = 
 
! - 0.1728369  - 0.3888655  - 0.8262233 !
! - 0.6019869    0.6543045    1.1323911 !
! - 1.5619521  - 0.7004486  - 0.2330131 !
 
       Q(5) = D matrix = 
 
!   0.    0. !
!   0.    0. !
!   0.    0. !
 
       Q(6) = X0 (initial state) = 
 
!   0. !
!   0. !
!   0. !
 
       Q(7) = Time domain = 
 
 c   
 
//Q is a stable parameter
 
K=lft(J,r,Q);
 
spec(h_cl(P,K))  // closed-loop A matrix (should be stable);
 ans  =
 
! - 2.5538801 + 0.4709454i !
! - 2.5538801 - 0.4709454i !
! - 0.5                    !
! - 0.9994443              !
! - 0.9999999 + 0.0005557i !
! - 0.9999999 - 0.0005557i !
! - 1.0005558              !
! - 2.0000318 + 0.0000551i !
! - 2.0000318 - 0.0000551i !
! - 1.9999364              !
! - 2.                     !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/observer.man
 
//====================================================
 
clear;lines(0);
 
nx=5;nu=1;ny=1;un=3;us=2;Sys=ssrand(ny,nu,nx,list('dt',us,us,un));
 
//nx=5 states, nu=1 input, ny=1 output,
 
//un=3 unobservable states, us=2 of them unstable.
 
[Obs,U,m]=observer(Sys);  //Stable observer (default)
 
W=U';H=W(m+1:nx,:);[A,B,C,D]=abcd(Sys);  //H*U=[0,eye(no,no)];
 
Sys2=ss2tf(syslin('c',A,B,H))  //Transfer u-->z
 Sys2  =
 
!                                        2   !
!     0.1645537 - 1.1473974s + 1.3310149s    !
!   ---------------------------------------  !
!                                      2   3 !
!   0.0348196 - 0.2011868s - 0.0416520s + s  !
!                                            !
!     0.0397395 - 0.2777238s                 !
!   --------------------------               !
!                             2              !
!   0.0696391 - 0.5416520s + s               !
!                                            !
!   - 0.0646039 + 0.7114172s                 !
!   --------------------------               !
!                             2              !
!   0.0696391 - 0.5416520s + s               !
 
Idu=eye(nu,nu);Sys3=ss2tf(H*U(:,m+1:$)*Obs*[Idu;Sys])
 Sys3  =
 
!                                        2   !
!     0.1645537 - 1.1473974s + 1.3310149s    !
!   ---------------------------------------  !
!                                      2   3 !
!   0.0348196 - 0.2011868s - 0.0416520s + s  !
!                                            !
!     0.0397395 - 0.2777238s                 !
!   --------------------------               !
!                             2              !
!   0.0696391 - 0.5416520s + s               !
!                                            !
!   - 0.0646039 + 0.7114172s                 !
!   --------------------------               !
!                             2              !
!   0.0696391 - 0.5416520s + s               !
 
//Transfer u-->[u;y=Sys*u]-->Obs-->xhat-->HUxhat=zhat  i.e. u-->output of Obs
 
//this transfer must equal Sys2, the u-->z transfer  (H2=eye).
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/obsv_mat.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/obsvss.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/p_margin.man
 
//====================================================
 
clear;lines(0);
 
h=syslin('c',-1+%s,3+2*%s+%s^2)
 h  =
 
    - 1 + s      
    ---------    
              2  
    3 + 2s + s   
 
[p,fr]=p_margin(h)
 fr  =
 
     []
 p  =
 
     []
 
[p,fr]=p_margin(h+0.7)
 fr  =
 
!   0.1894585 !
!   0.5225282 !
 p  =
 
!   31.452924 !
! - 10.54972  !
 
nyquist(h+0.7)
 
t=(0:0.1:2*%pi)';plot2d(sin(t),cos(t),-3,'000')
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/pfss.man
 
//====================================================
 
clear;lines(0);
 
W=ssrand(1,1,6);
 
elts=pfss(W);
 
W1=0;for k=1:size(elts), W1=W1+ss2tf(elts(k));end
 
clean(ss2tf(W)-W1)
 ans  =
 
    0   
    -   
    1   
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/phasemag.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s');
 
h=syslin('c',1/((s+5)*(s+10)*(100+6*s+s*s)*(s+.3)));
 
[frq,rf]=repfreq(h,0.1,20,0.005);
 
xbasc(0);
 
plot2d(frq',phasemag(rf,'c')');
 
xbasc(1);
 
plot2d(frq',phasemag(rf,'m')');
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/ppol.man
 
//====================================================
 
clear;lines(0);
 
A=rand(3,3);B=rand(3,2);
 
F=ppol(A,B,[-1,-2,-3]);
 
spec(A-B*F)
 ans  =
 
! - 1. !
! - 3. !
! - 2. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/projsl.man
 
//====================================================
 
clear;lines(0);
 
rand('seed',0);sl=ssrand(2,2,5);[A,B,C,D]=abcd(sl);poles=spec(A)
 poles  =
 
! - 0.8675645 + 1.3551594i !
! - 0.8675645 - 1.3551594i !
!   0.3095515 + 0.2899645i !
!   0.3095515 - 0.2899645i !
! - 2.6609801              !
 
[Q,M]=pbig(A,0,'c');  //keeping unstable poles
 
slred=projsl(sl,Q,M);spec(slred('A'))
 ans  =
 
!   0.3095515 + 0.2899645i !
!   0.3095515 - 0.2899645i !
 
sl('D')=rand(2,2);  //making proper system
 
trzeros(sl)  //zeros of sl
 ans  =
 
! - 53.683814              !
! - 0.8350775 + 2.2560884i !
! - 0.8350775 - 2.2560884i !
! - 1.4933343 + 0.6083365i !
! - 1.4933343 - 0.6083365i !
 
wi=inv(sl);  //wi=inverse in state-space
 
[q,m]=psmall(wi('A'),2,'d');  //keeping small zeros (poles of wi) i.e. abs(z)<2
 
slred2=projsl(sl,q,m);
 
trzeros(slred2)  //zeros of slred2 = small zeros of sl
 ans  =
 
! - 1.4933343 + 0.6083365i !
! - 1.4933343 - 0.6083365i !
 
//  Example keeping second order modes
 
A=diag([-1,-2,-3]);
 
sl=syslin('c',A,rand(3,2),rand(2,3));[nk2,W]=hankelsv(sl)
 W  =
 
!   0.2505805    0.1437164    0.0913325 !
!   0.1940955    0.1129036    0.0716928 !
!   0.0928897    0.0550278    0.0351185 !
 nk2  =
 
!   0.3967562 !
!   0.0017233 !
!   0.0001232 !
 
[Q,M]=pbig(W,nk2(2)-%eps,'c');    //keeping 2 eigenvalues of W
 
slr=projsl(sl,Q,M);  //reduced model
 
hankelsv(slr)
 ans  =
 
!   0.3967562 !
!   0.0017233 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/repfreq.man
 
//====================================================
 
clear;lines(0);
 
A=diag([-1,-2]);B=[1;1];C=[1,1];
 
Sys=syslin('c',A,B,C);
 
frq=0:0.02:5;w=frq*2*%pi; //frq=frequencies in Hz ;w=frequencies in rad/sec;
 
[frq1,rep] =repfreq(Sys,frq);
 
[db,phi]=dbphi(rep);
 
Systf=ss2tf(Sys)    //Transfer function of Sys
 Systf  =
 
      3 + 2s     
    ----------   
              2  
    2 + 3s + s   
 
x=horner(Systf,w(2)*sqrt(-1))    // x is Systf(s) evaluated at s = i w(2)
 x  =
 
    1.482488 - 0.1550025i  
 
rep=20*log(abs(x))/log(10)   //magnitude of x in dB
 rep  =
 
    3.4670425  
 
db(2)    // same as rep
 ans  =
 
    3.4670425  
 
ang=atan(imag(x),real(x));   //in rad.
 
ang=ang*180/%pi              //in degrees
 ang  =
 
  - 5.968912  
 
phi(2)
 ans  =
 
  - 5.968912  
 
repf=repfreq(Sys,frq);
 
repf(2)-x
 ans  =
 
  - 2.220D-16 + 2.776D-17i  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/ricc.man
 
//====================================================
 
clear;lines(0);
 
//Standard formulas to compute Riccati solutions
 
A=rand(3,3);B=rand(3,2);C=rand(3,3);C=C*C';R=rand(2,2);R=R*R'+eye;B=B*inv(R)*B';
 
X=ricc(A,B,C,'cont');
 
norm(A'*X+X*A-X*B*X+C,1)
 ans  =
 
    8.493D-15  
 
H=[A -B;-C -A'];
 
[T,d]=gschur(eye(H),H,'cont');T=T(:,1:d);
 
X1=T(4:6,:)/T(1:3,:);
 
norm(X1-X,1)
 ans  =
 
    4.330D-15  
 
[T,d]=schur(H,'cont');T=T(:,1:d);
 
X2=T(4:6,:)/T(1:3,:);
 
norm(X2-X,1)
 ans  =
 
    2.998D-15  
 
//       Discrete time case
 
F=A;B=rand(3,2);G1=B;G2=R;G=G1/G2*G1';H=C;
 
X=ricc(F,G,H,'disc');
 
norm(F'*X*F-(F'*X*G1/(G2+G1'*X*G1))*(G1'*X*F)+H-X)
 ans  =
 
    2.488D-15  
 
H1=[eye(3,3) G;zeros(3,3) F'];
 
H2=[F zeros(3,3);-H eye(3,3)];
 
[T,d]=gschur(H2,H1,'disc');T=T(:,1:d);X1=T(4:6,:)/T(1:3,:);
 
norm(X1-X,1)
 ans  =
 
    5.995D-15  
 
Fi=inv(F);
 
Hami=[Fi Fi*G;H*Fi F'+H*Fi*G];
 
[T,d]=schur(Hami,'d');T=T(:,1:d);
 
Fit=inv(F');
 
Ham=[F+G*Fit*H -G*Fit;-Fit*H Fit];
 
[T,d]=schur(Ham,'d');T=T(:,1:d);X2=T(4:6,:)/T(1:3,:);
 
norm(X2-X,1)
 ans  =
 
    2.609D-13  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/rowregul.man
 
//====================================================
 
clear;lines(0);
 
s=%s;
 
w=[1/s,0;s/(s^3+2),2/s];
 
Sl=tf2ss(w);
 
[Stmp,Ws]=rowregul(Sl,-1,-2);
 
Stmp('D')     // D matrix of Stmp
 ans  =
 
!   1.    0. !
!   0.    2. !
 
clean(ss2tf(Stmp))
 ans  =
 
!   2 + s      0       !
!   -----      -       !
!     s        1       !
!                      !
!         2            !
!   2s + s     4 + 2s  !
!   ------     ------  !
!        3             !
!   2 + s        s     !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/rtitr.man
 
//====================================================
 
clear;lines(0);
 
z=poly(0,'z');
 
Num=1+z;Den=1+z;u=[1,2,3,4,5];
 
rtitr(Num,Den,u)-u
 ans  =
 
!   0.    0.    0.    0.    0. !
 
//Other examples
 
//siso
 
//causal
 
n1=1;d1=poly([1 1],'z','coeff');       // y(j)=-y(j-1)+u(j-1)
 
r1=[0 1 0 1 0 1 0 1 0 1 0];
 
r=rtitr(n1,d1,ones(1,10));norm(r1-r,1)
 ans  =
 
    0.  
 
//hot restart
 
r=rtitr(n1,d1,ones(1,9),1,0);norm(r1(2:11)-r)
 ans  =
 
    0.  
 
//non causal
 
n2=poly([1 1 1],'z','coeff');d2=d1;    // y(j)=-y(j-1)+u(j-1)+u(j)+u(j+1)
 
r2=[2 1 2 1 2 1 2 1 2];
 
r=rtitr(n2,d2,ones(1,10));norm(r-r2,1)
 ans  =
 
    0.  
 
//hot restart
 
r=rtitr(n2,d2,ones(1,9),1,2);norm(r2(2:9)-r,1)
 ans  =
 
    0.  
 
//
 
//MIMO example
 
//causal
 
d1=d1*diag([1 0.5]);n1=[1 3 1;2 4 1];r1=[5;14]*r1;
 
r=rtitr(n1,d1,ones(3,10));norm(r1-r,1)
 ans  =
 
    0.  
 
//
 
r=rtitr(n1,d1,ones(3,9),[1;1;1],[0;0]);
 
norm(r1(:,2:11)-r,1)
 ans  =
 
    0.  
 
//polynomial n1  (same ex.)
 
n1(1,1)=poly(1,'z','c');r=rtitr(n1,d1,ones(3,10));norm(r1-r,1)
 ans  =
 
    0.  
 
//
 
r=rtitr(n1,d1,ones(3,9),[1;1;1],[0;0]);
 
norm(r1(:,2:11)-r,1)
 ans  =
 
    0.  
 
//non causal
 
d2=d1;n2=n2*n1;r2=[5;14]*r2;
 
r=rtitr(n2,d2,ones(3,10));norm(r2-r)
 ans  =
 
    0.  
 
//
 
r=rtitr(n2,d2,ones(3,9),[1;1;1],[10;28]);
 
norm(r2(:,2:9)-r,1)
 ans  =
 
    0.  
 
//
 
//  State-space or transfer
 
a = [0.21 , 0.63 , 0.56 , 0.23 , 0.31
     0.76 , 0.85 , 0.66 , 0.23 , 0.93
     0 , 0.69 , 0.73 , 0.22 , 0.21
     0.33 , 0.88 , 0.2 , 0.88 , 0.31
     0.67 , 0.07 , 0.54 , 0.65 , 0.36];
 
b = [0.29 , 0.5 , 0.92
     0.57 , 0.44 , 0.04
     0.48 , 0.27 , 0.48
     0.33 , 0.63 , 0.26
     0.59 , 0.41 , 0.41];
 
c = [0.28 , 0.78 , 0.11 , 0.15 , 0.84
     0.13 , 0.21 , 0.69 , 0.7 , 0.41];
 
d = [0.41 , 0.11 , 0.56
     0.88 , 0.2 , 0.59];
 
s=syslin('d',a,b,c,d);
 
h=ss2tf(s);num=h('num');den=h('den');den=den(1,1)*eye(2,2);
 
u=1;u(3,10)=0;r3=flts(u,s);
 
r=rtitr(num,den,u);norm(r3-r,1)
 ans  =
 
    1.182D-11  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/sm2des.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/sm2ss.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/specfact.man
 
//====================================================
 
clear;lines(0);
 
A=diag([-1,-2]);B=[1;1];C=[1,1];D=1;s=poly(0,'s');
 
W1=syslin('c',A,B,C,D);
 
phi=gtild(W1,'c')+W1;
 
phis=clean(ss2tf(phi))
 phis  =
 
            2    4  
    20 - 16s + 2s   
    -------------   
           2   4    
     4 - 5s + s     
 
clean(phis-horner(phis,-s)');   //check this is 0...
 
[A,B,C,D]=abcd(W1);
 
[W0,L]=specfact(A,B,C,D);
 
W=syslin('c',A,B,L,W0)
 W  =
 
 
       W(1)   (state-space system:)
 
!lss  A  B  C  D  X0  dt  !
 
       W(2) = A matrix = 
 
! - 1.    0. !
!   0.  - 2. !
 
       W(3) = B matrix = 
 
!   1. !
!   1. !
 
       W(4) = C matrix = 
 
!   0.5338631    0.5759826 !
 
       W(5) = D matrix = 
 
    1.4142136  
 
       W(6) = X0 (initial state) = 
 
!   0. !
!   0. !
 
       W(7) = Time domain = 
 
 c   
 
Ws=ss2tf(W);
 
horner(Ws,-s)*Ws
 ans  =
 
            2    4  
    20 - 16s + 2s   
    -------------   
           2   4    
     4 - 5s + s     
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/ss2des.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s');
 
G=[1/(s+1),s;1+s^2,3*s^3];Sl=tf2ss(G);
 
S=ss2des(Sl)
 S  =
 
 
       S(1)
 
!des  A  B  C  D  E  !
 
       S(2)
 
!   1.    0.    0.    0.    0.    0. !
!   0.    1.    0.    0.    0.    0. !
!   0.    0.    1.    0.    0.    0. !
!   0.    0.    0.    1.    0.    0. !
!   0.    0.    0.    0.    1.    0. !
!   0.    0.    0.    0.    0.  - 1. !
 
       S(3)
 
!   1.3891255    0.        !
!   0.         - 2.0657644 !
!   0.           2.2941573 !
!   0.         - 0.6851712 !
!   0.2651986    0.        !
!   1.           0.        !
 
       S(4)
 
 
         column 1 to 5
 
! - 0.1825222    0.1579730    0.1578947    0.0523964    0.9560617 !
! - 0.7249831  - 0.4739189  - 0.4736842  - 0.1571891    0.0267443 !
 
         column 6
 
!   1. !
!   0. !
 
       S(5)
 
!   0.    0. !
!   0.    0. !
 
       S(6)
 
 
         column 1 to 5
 
!   0.         - 0.6775285    0.4989676    0.5390988    0.        !
! - 0.2090816    0.3263349  - 0.2132922    0.6075455  - 0.0919079 !
!   0.           0.1770507  - 0.3622354    0.5577838    0.        !
!   0.6303729  - 0.3910685  - 0.5698044    0.0359005    0.2770986 !
!   0.           0.0249937  - 0.0184067  - 0.0198871    0.        !
!   0.           0.           0.           0.           0.        !
 
         column 6
 
!   0. !
!   0. !
!   0. !
!   0. !
!   0. !
!   1. !
 
S1=ss2des(Sl,"withD")
 S1  =
 
 
       S1(1)
 
!des  A  B  C  D  E  !
 
       S1(2)
 
!   1.    0.    0.    0.    0.    0. !
!   0.    1.    0.    0.    0.    0. !
!   0.    0.    1.    0.    0.    0. !
!   0.    0.    0.    1.    0.    0. !
!   0.    0.    0.    0.    1.    0. !
!   0.    0.    0.    0.    0.  - 1. !
 
       S1(3)
 
!   0.9570920    0.        !
!   0.           0.        !
!   0.           3.1622777 !
!   0.           0.        !
! - 0.2897841    0.        !
!   1.           0.        !
 
       S1(4)
 
! - 0.2897841    0.    0.    0.  - 0.9570920    1. !
!   0.           0.    0.  - 1.    0.           0. !
 
       S1(5)
 
!   0.    0. !
!   1.    0. !
 
       S1(6)
 
!   0.           0.    0.9996150    0.    0.           0. !
!   0.9570920    0.    0.           0.  - 0.2897841    0. !
!   0.           0.    0.           0.    0.           0. !
!   0.           1.    0.           0.    0.           0. !
!   0.           0.    0.0277457    0.    0.           0. !
!   0.           0.    0.           0.    0.           1. !
 
Des=des2ss(S);Des(5)=clean(Des(5))
    rank A^k    rcond
        4.      0.380E-15
        3.      0.866E-16
        2.      0.315E-15
        1.      0.100E+01
 Des  =
 
 
       Des(1)   (state-space system:)
 
!lss  A  B  C  D  X0  dt  !
 
       Des(2) = A matrix = 
 
  - 1.  
 
       Des(3) = B matrix = 
 
!   1.    0. !
 
       Des(4) = C matrix = 
 
!   1. !
!   0. !
 
       Des(5) = D matrix = 
 
!   0         s   !
!                 !
!        2      3 !
!   1 + s     3s  !
 
       Des(6) = X0 (initial state) = 
 
    0.  
 
       Des(7) = Time domain = 
 
     []
 
Des1=des2ss(S1)
    rank A^k    rcond
        4.      0.304E-16
        3.      0.498E-15
        2.      0.901E-16
        1.      0.100E+01
 Des1  =
 
 
       Des1(1)   (state-space system:)
 
!lss  A  B  C  D  X0  dt  !
 
       Des1(2) = A matrix = 
 
  - 1.  
 
       Des1(3) = B matrix = 
 
!   1.    0. !
 
       Des1(4) = C matrix = 
 
!   1. !
!   0. !
 
       Des1(5) = D matrix = 
 
!   1.110D-16     s   !
!                     !
!        2          3 !
!   1 + s         3s  !
 
       Des1(6) = X0 (initial state) = 
 
    0.  
 
       Des1(7) = Time domain = 
 
     []
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/ss2ss.man
 
//====================================================
 
clear;lines(0);
 
Sl=ssrand(2,2,5); trzeros(Sl)       // zeros are invariant:
 ans  =
 
!   4.0787946 !
! - 2.0770453 !
! - 1.3252255 !
 
Sl1=ss2ss(Sl,rand(5,5),rand(2,5),rand(5,2));
 
trzeros(Sl1), trzeros(rand(2,2)*Sl1*rand(2,2))
 ans  =
 
!   4.0787946 !
! - 1.3252255 !
! - 2.0770453 !
 ans  =
 
! - 2.077045  !
! - 1.325226  !
!   4.0787958 !
 
// output injection [ A + GC, (B+GD,-G)]
 
//                  [   C   , (D   , 0)]
 
p=1,m=2,n=2; sys=ssrand(p,m,n);
 p  =
 
    1.  
 m  =
 
    2.  
 
 
// feedback (m,n)  first and then output injection.
 
 
F1=rand(m,n);
 
G=rand(n,p);
 
[sys1,right,left]=ss2ss(sys,rand(n,n),F1,G,2);
 
 
// Sl1 equiv left*sysdiag(sys*right,eye(p,p)))
 
 
res=clean(ss2tf(sys1) - ss2tf(left*sysdiag(sys*right,eye(p,p))))
 res  =
 
!   0     0     0  !
!   -     -     -  !
!   1     1     1  !
 
 
// output injection then feedback (m+p,n)
 
F2=rand(p,n); F=[F1;F2];
 
[sys2,right,left]=ss2ss(sys,rand(n,n),F,G,1);
 
 
// Sl1 equiv left*sysdiag(sys,eye(p,p))*right
 
 
res=clean(ss2tf(sys2)-ss2tf(left*sysdiag(sys,eye(p,p))*right))
 res  =
 
!   0     0     0  !
!   -     -     -  !
!   1     1     1  !
 
 
// when F2= 0; sys1 and sys2 are the same
 
F2=0*rand(p,n);F=[F1;F2];
 
[sys2,right,left]=ss2ss(sys,rand(n,n),F,G,1);
 
 
res=clean(ss2tf(sys2)-ss2tf(sys1))
 res  =
 
!   0     0     0  !
!   -     -     -  !
!   1     1     1  !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/ss2tf.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s');
 
h=[1,1/s;1/(s^2+1),s/(s^2-2)]
 h  =
 
!   1         1      !
!   -         -      !
!   1         s      !
!                    !
!     1         s    !
!   -----     -----  !
!        2         2 !
!   1 + s   - 2 + s  !
 
sl=tf2ss(h);
 
h=clean(ss2tf(sl))
 h  =
 
!   1         1      !
!   -         -      !
!   1         s      !
!                    !
!     1         s    !
!   -----     -----  !
!        2         2 !
!   1 + s   - 2 + s  !
 
[Ds,NUM,chi]=ss2tf(sl)
 chi  =
 
!   s                      s                    !
!                                               !
!                     2                   2   3 !
!   1 - 1.930D-15s + s   - 2s - 2.648D-16s + s  !
 NUM  =
 
! - 7.518D-16          1                           !
!                                                  !
!                                                2 !
!   1 + 3.962D-16s     2.107D-15 - 4.213D-15s + s  !
 Ds  =
 
!   1.    0. !
!   0.    0. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/st_ility.man
 
//====================================================
 
clear;lines(0);
 
A=diag([0.9,-2,3]);B=[0;0;1];Sl=syslin('c',A,B,[]);
 
[ns,nc,U]=st_ility(Sl);
 
U'*A*U
 ans  =
 
!   3.    0.    0.  !
!   0.  - 2.    0.  !
!   0.    0.    0.9 !
 
U'*B
 ans  =
 
! - 1. !
!   0. !
!   0. !
 
[ns,nc,U]=st_ility(syslin('d',A,B,[]));
 
U'*A*U
 ans  =
 
!   3.    0.     0. !
!   0.    0.9    0. !
!   0.    0.   - 2. !
 
U'*B
 ans  =
 
! - 1. !
!   0. !
!   0. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/stabil.man
 
//====================================================
 
clear;lines(0);
 
// Gain:
 
Sys=ssrand(0,2,5,list('st',2,3,3));
 
A=Sys('A');B=Sys('B');F=stabil(A,B);
WARNING:system not stabilizable (or detectable)=>stabilizing the stabilizable part
 
spec(A) //2 controllable modes 2 unstable uncontrollable modes
 ans  =
 
!   2.2785519 !
! - 1.3642101 !
!   1.3248926 !
! - 0.5       !
!   0.5       !
 
//and one stable uncontrollable mode
 
spec(A+B*F) //the two controllable modes are set to -1.
 ans  =
 
!   2.2785519       !
!   0.5             !
! - 0.5             !
! - 1. + 1.438D-07i !
! - 1. - 1.438D-07i !
 
// Compensator:
 
Sys=ssrand(3,2,5,list('st',2,3,3)); //3 outputs, 2 inputs, 5 states
 
//2 controllables modes, 3 controllable or stabilizable modes.
 
K=stabil(Sys,-2,-3);  //Compensator for Sys.
WARNING:system not stabilizable (or detectable)=>stabilizing the stabilizable part
 
spec(Sys('A'))
 ans  =
 
! - 1.3642101 !
! - 0.5       !
!   2.2785519 !
!   1.3248926 !
!   0.5       !
 
spec(h_cl(Sys,K))   //K Stabilizes what can be stabilized.
 ans  =
 
!   2.2785519              !
!   0.5                    !
! - 0.5                    !
! - 2.9978581              !
! - 2.9993386 + 0.0020368i !
! - 2.9993386 - 0.0020368i !
! - 3.0017323 + 0.0012583i !
! - 3.0017323 - 0.0012583i !
! - 2. + 1.023D-09i        !
! - 2. - 1.023D-09i        !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/svplot.man
 
//====================================================
 
clear;lines(0);
 
x=logspace(-3,3);
 
y=svplot(ssrand(2,2,4));
 
xbasc();plot2d1("oln",x',20*log(y')/log(10));
 
xgrid(12)
 
xtitle("Singular values plot","(Rd/sec)", "Db");
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/syssize.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/tf2ss.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s');
 
H=[2/s,(s+1)/(s^2-5)];
 
Sys=tf2ss(H)
 Sys  =
 
 
       Sys(1)   (state-space system:)
 
!lss  A  B  C  D  X0  dt  !
 
       Sys(2) = A matrix = 
 
!   1.           1.490712     0.        !
!   1.1925696    0.           1.3333333 !
!   0.2236068    1.6666667  - 1.        !
 
       Sys(3) = B matrix = 
 
! - 1.3333333  - 0.6666667 !
!   0.8944272    0.        !
!   1.1925696  - 0.7453560 !
 
       Sys(4) = C matrix = 
 
! - 1.5    0.    0. !
 
       Sys(5) = D matrix = 
 
!   0.    0. !
 
       Sys(6) = X0 (initial state) = 
 
!   0. !
!   0. !
!   0. !
 
       Sys(7) = Time domain = 
 
     []
 
clean(ss2tf(Sys))
 ans  =
 
!   2     1 + s  !
!   -     -----  !
!              2 !
!   s   - 5 + s  !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/time_id.man
 
//====================================================
 
clear;lines(0);
 
z=poly(0,'z');
 
h=(1-2*z)/(z^2-0.5*z+5)
 h  =
 
       1 - 2z      
    ------------   
                2  
    5 - 0.5z + z   
 
rep=[0;ldiv(h('num'),h('den'),20)]; //impulse response
 
H=time_id(2,'impuls',rep)
 H  =
 
       1 - 2z      
    ------------   
                2  
    5 - 0.5z + z   
 
//  Same example with flts and u
 
u=zeros(1,20);u(1)=1;
 
rep=flts(u,tf2ss(h));        //impulse response
 
H=time_id(2,u,rep)
 H  =
 
       1 - 2z      
    ------------   
                2  
    5 - 0.5z + z   
 
//  step response
 
u=ones(1,20);
 
rep=flts(u,tf2ss(h));     //step response.
 
H=time_id(2,'step',rep)
 H  =
 
       1 - 2z      
    ------------   
                2  
    5 - 0.5z + z   
 
H=time_id(3,u,rep)    //with u as input and too high order required
  deficient rank: rank =   5 - tol =   5.9759D-09
 H  =
 
                      2  
    7.559D-10 + z - 2z   
    ------------------   
               2   3     
      5z - 0.5z + z      
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/trzeros.man
 
//====================================================
 
clear;lines(0);
 
W1=ssrand(2,2,5);trzeros(W1)    //call trzeros
 ans  =
 
!   4.0787946 !
! - 2.0770453 !
! - 1.3252255 !
 
roots(det(systmat(W1)))         //roots of det(system matrix)
 ans  =
 
! - 1.3252255 !
! - 2.0770453 !
!   4.0787946 !
 
s=poly(0,'s');W=[1/(s+1);1/(s-2)];W2=(s-3)*W*W';[nt,dt,rk]=trzeros(W2);
 
St=systmat(tf2ss(W2));[Q,Z,Qd,Zd,numbeps,numbeta]=kroneck(St);
 
St1=Q*St*Z;rowf=(Qd(1)+Qd(2)+1):(Qd(1)+Qd(2)+Qd(3));
 
colf=(Zd(1)+Zd(2)+1):(Zd(1)+Zd(2)+Zd(3));
 
roots(St1(rowf,colf)), nt./dt     //By Kronecker form
 ans  =
 
    3.  
 ans  =
 
    3.  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/unobs.man
 
//====================================================
 
clear;lines(0);
 
A=diag([1,2,3]);C=[1,0,0];
 
unobs(A,C)
 ans  =
 
    2.  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/control/zeropen.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/dcd/cdfbet.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/dcd/cdfbin.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/dcd/cdfchi.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/dcd/cdfchn.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/dcd/cdff.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/dcd/cdffnc.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/dcd/cdfgam.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/dcd/cdfnbn.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/dcd/cdfnor.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/dcd/cdfpoi.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/dcd/cdft.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/dcd/grand.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/G_make.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/abs.man
 
//====================================================
 
clear;lines(0);
 
abs([1,%i,-1,-%i,1+%i])
 ans  =
 
!   1.    1.    1.    1.    1.4142136 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/acos.man
 
//====================================================
 
clear;lines(0);
 
x=[1,%i,-1,-%i]
 x  =
 
!   1.    i    - 1.  - i   !
 
cos(acos(x))
 ans  =
 
!   1.    8.660D-17 + i    - 1.    8.660D-17 - i   !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/acosh.man
 
//====================================================
 
clear;lines(0);
 
x=[0,1,%i];
 
cosh(acosh(x))
 ans  =
 
!   6.123D-17    1.    8.660D-17 + i   !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/acoshm.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2;3,4];
 
coshm(acoshm(A))
 ans  =
 
!   1. + 2.776D-16i    2. + 1.665D-16i !
!   3.                 4. + 1.291D-15i !
 
A(1,1)=A(1,1)+%i;
 
coshm(acoshm(A))
 ans  =
 
!   1. + i             2. + 4.441D-16i !
!   3. - 1.110D-16i    4. + 4.857D-17i !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/acosm.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2;3,4];
 
cosm(acosm(A))
 ans  =
 
!   1. - 5.385D-15i    2. - 7.078D-15i !
!   3. - 1.354D-14i    4. - 1.782D-14i !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/addf.man
 
//====================================================
 
clear;lines(0);
 
addf('0','1')
 ans  =
 
 1   
 
addf('1','a')
 ans  =
 
 a+1   
 
addf('1','2')
 ans  =
 
 3   
 
'a'+'b'
 ans  =
 
 ab   
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/addmenu.man
 
//====================================================
 
clear;lines(0);
 
addmenu('foo')
 
foo='disp(''hello'')'
 foo  =
 
 disp('hello')   
 
 
addmenu('Hello',['Franck';'Peter'])
 
Hello=['disp(''hello Franck'')';'disp(''hello Peter'')']
 Hello  =
 
!disp('hello Franck')  !
!                      !
!disp('hello Peter')   !
 
 
addmenu(0,'Hello',['Franck';'Peter'])
 
Hello_0=['disp(''hello Franck'')';'disp(''hello Peter'')']
 Hello_0  =
 
!disp('hello Franck')  !
!                      !
!disp('hello Peter')   !
 
 
addmenu('Bye',list(0,'French_Bye'))
 
French_Bye='disp(''Au revoir'')'
 French_Bye  =
 
 disp('Au revoir')   
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/adj2sp.man
 
//====================================================
 
clear;lines(0);
 
A = sprand(100,50,.05);
 
[xadj,adjncy,anz]= sp2adj(A);
 
[n,m]=size(A);
 
p = adj2sp(xadj,adjncy,anz,[n,m]);
 
A-p,
 ans  =
 
(  100,   50) zero sparse matrix
 
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/amell.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/asin.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2;3,4]
 A  =
 
!   1.    2. !
!   3.    4. !
 
sin(asin(A))
 ans  =
 
!   1.                 2. - 1.061D-16i !
!   3. - 1.732D-16i    4. - 2.372D-16i !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/asinh.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2;2,3]
 A  =
 
!   1.    2. !
!   2.    3. !
 
sinh(asinh(A))
 ans  =
 
!   1.    2. !
!   2.    3. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/asinhm.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2;2,3]
 A  =
 
!   1.    2. !
!   2.    3. !
 
sinhm(asinhm(A))
 ans  =
 
!   1.    2. !
!   2.    3. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/asinm.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2;3,4]
 A  =
 
!   1.    2. !
!   3.    4. !
 
sinm(asinm(A))
 ans  =
 
!   1. - 5.551D-17i    2. - 2.776D-16i !
!   3. - 1.110D-16i    4. - 1.388D-17i !
 
asinm(A)+%i*logm(%i*A+sqrtm(eye-A*A))
 ans  =
 
!   0    0 !
!   0    0 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/atan.man
 
//====================================================
 
clear;lines(0);
 
x=[1,%i,-1,%i]
 x  =
 
!   1.    i    - 1.    i   !
 
phasex=atan(imag(x),real(x))
 phasex  =
 
!   0.    1.5707963    3.1415927    1.5707963 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/atanh.man
 
//====================================================
 
clear;lines(0);
 
x=[0,%i,-%i]
 x  =
 
!   0    i    - i   !
 
tanh(atanh(x))
 ans  =
 
!   0    i    - i   !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/atanhm.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2;3,4];
 
tanhm(atanhm(A))
 ans  =
 
!   1. + 1.309D-15i    2. - 1.158D-16i !
!   3. + 2.449D-15i    4. + 7.900D-16i !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/atanm.man
 
//====================================================
 
clear;lines(0);
 
tanm(atanm([1,2;3,4]))
 ans  =
 
!   1.    2. !
!   3.    4. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/besseli.man
 
//====================================================
 
clear;lines(0);
 
besseli(0.5:3,1:4)
 ans  =
 
!   0.9376749    0.2935253    0.0570989 !
!   2.0462369    1.0994732    0.3970271 !
!   4.6148229    3.0994835    1.5153394 !
!   10.887102    8.1726332    4.7576269 !
 
besseli(0.5:3,1:4,2)
 ans  =
 
!   0.3449513    0.1079819    0.0210055 !
!   0.2769280    0.1487975    0.0537318 !
!   0.2297585    0.1543142    0.0754443 !
!   0.1994042    0.149687     0.0871390 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/besselj.man
 
//====================================================
 
clear;lines(0);
 
besselj(0.5:3,1:4)
 ans  =
 
!   0.6713967    0.2402978    0.0494968 !
!   0.5130161    0.4912938    0.2239245 !
!   0.0650082    0.4777182    0.4127100 !
! - 0.3019205    0.1852859    0.4408850 !
 
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/besselk.man
 
//====================================================
 
clear;lines(0);
 
besselk(0.5:3,1:4)
 ans  =
 
!   0.4610685    0.9221370    3.2274795 !
!   0.1199378    0.1799067    0.3897978 !
!   0.0360260    0.0480346    0.0840606 !
!   0.0114776    0.0143470    0.0222379 !
 
besselk(0.5:3,1:4,2)
 ans  =
 
!   1.2533141    2.5066283    8.773199  !
!   0.8862269    1.3293404    2.8802375 !
!   0.7236013    0.9648017    1.6884029 !
!   0.6266571    0.7833213    1.2141481 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/bessely.man
 
//====================================================
 
clear;lines(0);
 
bessely(0.5:3,1:4)
 ans  =
 
! - 0.4310989  - 1.1024956  - 2.8763879 !
!   0.2347857  - 0.3956233  - 0.8282206 !
!   0.4560488    0.0870081  - 0.3690407 !
!   0.2607661    0.3671120    0.0145679 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/bloc2exp.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/bloc2ss.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/c_link.man
 
//====================================================
 
clear;lines(0);
 
if c_link('foo') then link('foo.o','foo');end
 
// to unlink all the shared libarries which contain foo
 
a=%t; while a ;[a,b]=c_link('foo'); ulink(b);end
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/calerf.man
 
//====================================================
 
clear;lines(0);
 
deff('y=f(t)','y=exp(-t^2)');
 
calerf(1,0)
 ans  =
 
    0.8427008  
 
2/sqrt(%pi)*intg(0,1,f)
 ans  =
 
    0.8427008  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/cmb_lin.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/conj.man
 
//====================================================
 
clear;lines(0);
 
x=[1+%i,-%i;%i,2*%i];
 
conj(x)
 ans  =
 
!   1. - i      i   !
! - i         - 2.i !
 
x'-conj(x)  //x'  is conjugate transpose
 ans  =
 
!   0    - 2.i !
!   2.i    0   !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/convstr.man
 
//====================================================
 
clear;lines(0);
 
A=['this','is';'my','matrix'];
 
convstr(A,'u')
 ans  =
 
!THIS  IS      !
!              !
!MY    MATRIX  !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/cos.man
 
//====================================================
 
clear;lines(0);
 
x=[0,1,%i]
 x  =
 
!   0    1.    i   !
 
acos(cos(x))
 ans  =
 
!   0    1.    i   !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/cosh.man
 
//====================================================
 
clear;lines(0);
 
x=[0,1,%i]
 x  =
 
!   0    1.    i   !
 
acosh(cosh(x))
 ans  =
 
!   0    1.    i   !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/coshm.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2;2,4]
 A  =
 
!   1.    2. !
!   2.    4. !
 
acoshm(coshm(A))
 ans  =
 
!   1.    2. !
!   2.    4. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/cosm.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2;3,4]
 A  =
 
!   1.    2. !
!   3.    4. !
 
cosm(A)-0.5*(expm(%i*A)+expm(-%i*A))
 ans  =
 
!   0    0 !
!   0    0 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/cotg.man
 
//====================================================
 
clear;lines(0);
 
x=[1,%i];
 
cotg(x)-cos(x)./sin(x)
 ans  =
 
!   0    0 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/coth.man
 
//====================================================
 
clear;lines(0);
 
x=[1,2*%i]
 x  =
 
!   1.    2.i !
 
t=exp(x);
 
(t-ones(x)./t).\(t+ones(x)./t)
 ans  =
 
!   1.3130353    6.105D-17 + 0.4576576i !
 
coth(x)
 ans  =
 
!   1.3130353    6.105D-17 + 0.4576576i !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/cothm.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2;3,4];
 
cothm(A)
 ans  =
 
! - 1.8991606    1.3261744 !
!   1.9892616    0.0901010 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/cumprod.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2;3,4];
 
cumprod(A)
 ans  =
 
!   1.    6.  !
!   3.    24. !
 
cumprod(A,'r')
 ans  =
 
!   1.    2. !
!   3.    8. !
 
cumprod(A,'c')
 ans  =
 
!   1.    2.  !
!   3.    12. !
 
rand('seed',0);
 
a=rand(3,4);
 
[m,n]=size(a);
 
w=zeros(a);
 
w(1,:)=a(1,:);
 
for k=2:m;w(k,:)=w(k-1,:).*a(k,:);end;w-cumprod(a,'r')
 ans  =
 
!   0.    0.    0.    0. !
!   0.    0.    0.    0. !
!   0.    0.    0.    0. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/cumsum.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2;3,4];
 
cumsum(A)
 ans  =
 
!   1.    6.  !
!   4.    10. !
 
cumsum(A,'r')
 ans  =
 
!   1.    2. !
!   4.    6. !
 
cumsum(A,'c')
 ans  =
 
!   1.    3. !
!   3.    7. !
 
a=rand(3,4)+%i;
 
[m,n]=size(a);
 
w=zeros(a);
 
w(1,:)=a(1,:);
 
for k=2:m;w(k,:)=w(k-1,:)+a(k,:);end;w-cumsum(a,'r')
 ans  =
 
!   0    0    0    0 !
!   0    0    0    0 !
!   0    0    0    0 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/debug.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/dec2hex.man
 
//====================================================
 
clear;lines(0);
 
dec2hex([2748 10;11 3])
 ans  =
 
!ABC  A  !
!        !
!B    3  !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/delip.man
 
//====================================================
 
clear;lines(0);
 
ck=0.5;
 
delip([1,2],ck)
 ans  =
 
!   1.6857504    1.6857504 + 2.1565156i !
 
deff('y=f(t)','y=1/sqrt((1-t^2)*(1-ck^2*t^2))')
 
intg(0,1,f)    //OK since real solution!
 ans  =
 
    1.6857504  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/delmenu.man
 
//====================================================
 
clear;lines(0);
 
addmenu('foo')
 
delmenu('foo')
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/demos.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/diag.man
 
//====================================================
 
clear;lines(0);
 
diag([1,2])
 ans  =
 
!   1.    0. !
!   0.    2. !
 
A=[1,2;3,4];
 
diag(A)
 ans  =
 
!   1. !
!   4. !
 
diag(A,1)
 ans  =
 
    2.  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/dlgamma.man
 
//====================================================
 
clear;lines(0);
 
dlgamma(0.5)
 ans  =
 
  - 1.96351  
 
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/edit.man
 
//====================================================
 
clear;lines(0);
 
//newedit=edit('edit')  //opens editor with text of this function
 
//myfunction=edit('myfunction')  //opens editor for a new function
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/emptystr.man
 
//====================================================
 
clear;lines(0);
 
x=emptystr();for k=1:10, x=x+','+string(k);end
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/erf.man
 
//====================================================
 
clear;lines(0);
 
deff('y=f(t)','y=exp(-t^2)');
 
erf(0.5)-2/sqrt(%pi)*intg(0,0.5,f)
 ans  =
 
    1.110D-16  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/erfc.man
 
//====================================================
 
clear;lines(0);
 
erf([0.5,0.2])+erfc([0.5,0.2])
 ans  =
 
!   1.    1. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/erfcx.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/eval.man
 
//====================================================
 
clear;lines(0);
 
a=1; b=2; Z=['a','sin(b)'] ; eval(Z)  //returns the matrix [1,0.909];
 ans  =
 
!   1.    0.9092974 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/execstr.man
 
//====================================================
 
clear;lines(0);
 
execstr('a=1') // sets a=1.
 
execstr('1+1') // does nothing (while evstr('1+1') returns 2)
 
 
execstr(['if %t then';
         '  a=1';
         '  b=a+1';
         'else'
         ' b=0'
         'end'])
 
 
execstr('a=zzzzzzz','errcatch')
 ans  =
 
    4.  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/full.man
 
//====================================================
 
clear;lines(0);
 
sp=sparse([1,2;5,4;3,1],[1,2,3]);
 
A=full(sp)
 A  =
 
!   0.    1.    0.    0. !
!   0.    0.    0.    0. !
!   3.    0.    0.    0. !
!   0.    0.    0.    0. !
!   0.    0.    0.    2. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/gamma.man
 
//====================================================
 
clear;lines(0);
 
gamma(0.5)
 ans  =
 
    1.7724539  
 
gamma(6)-prod(1:5)
 ans  =
 
    0.  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/gammaln.man
 
//====================================================
 
clear;lines(0);
 
gammaln(0.5)
 ans  =
 
    0.5723649  
 
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/getvalue.man
 
//====================================================
 
clear;lines(0);
 
labels=["magnitude";"frequency";"phase    "];
 
[ok,mag,freq,ph]=getvalue("define sine signal",labels,...
     list("vec",1,"vec",1,"vec",1),["0.85";"10^2";"%pi/3"])
 ph  =
 
    1.0471976  
 freq  =
 
    100.  
 mag  =
 
    0.85  
 ok  =
 
  T  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/gsort.man
 
//====================================================
 
clear;lines(0);
 
alr=[1,2,2;
     1,2,1;
     1,1,2;
     1,1,1];
 
[alr1,k]=gsort(alr,'lr','i')
 k  =
 
!   4. !
!   3. !
!   2. !
!   1. !
 alr1  =
 
!   1.    1.    1. !
!   1.    1.    2. !
!   1.    2.    1. !
!   1.    2.    2. !
 
[alr1,k]=gsort(alr,'lc','i')
 k  =
 
!   1.    3.    2. !
 alr1  =
 
!   1.    2.    2. !
!   1.    1.    2. !
!   1.    2.    1. !
!   1.    1.    1. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/halt.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/havewindow.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/hex2dec.man
 
//====================================================
 
clear;lines(0);
 
hex2dec(['ABC','0','A'])
 ans  =
 
!   2748.    0.    10. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/input.man
 
//====================================================
 
clear;lines(0);
 
//x=input("How many iterations?")
 
//x=input("What is your name?","string")
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/integrate.man
 
//====================================================
 
clear;lines(0);
 
integrate('sin(x)','x',0,%pi)
 ans  =
 
    2.  
 
integrate(['if x==0 then 1,';
           'else sin(x)/x,end'],'x',0,%pi)
 ans  =
 
    1.8519371  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/interp.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/interpln.man
 
//====================================================
 
clear;lines(0);
 
x=[1 10 20 30 40];
 
y=[1 30 -10 20 40];
 
plot2d(x',y',[-3],"011"," ",[-10,-40,50,50]);
 
yi=interpln([x;y],-4:45);
 
plot2d((-4:45)',yi',[3],"000");
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/intsplin.man
 
//====================================================
 
clear;lines(0);
 
t=0:0.1:%pi
 t  =
 
 
         column 1 to 9
 
!   0.    0.1    0.2    0.3    0.4    0.5    0.6    0.7    0.8 !
 
         column 10 to 18
 
!   0.9    1.    1.1    1.2    1.3    1.4    1.5    1.6    1.7 !
 
         column 19 to 27
 
!   1.8    1.9    2.    2.1    2.2    2.3    2.4    2.5    2.6 !
 
         column 28 to 32
 
!   2.7    2.8    2.9    3.    3.1 !
 
intsplin(t,sin(t))
 ans  =
 
    1.9991349  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/inttrap.man
 
//====================================================
 
clear;lines(0);
 
t=0:0.1:%pi
 t  =
 
 
         column 1 to 9
 
!   0.    0.1    0.2    0.3    0.4    0.5    0.6    0.7    0.8 !
 
         column 10 to 18
 
!   0.9    1.    1.1    1.2    1.3    1.4    1.5    1.6    1.7 !
 
         column 19 to 27
 
!   1.8    1.9    2.    2.1    2.2    2.3    2.4    2.5    2.6 !
 
         column 28 to 32
 
!   2.7    2.8    2.9    3.    3.1 !
 
inttrap(t,sin(t))
 ans  =
 
    1.9974689  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/isdef.man
 
//====================================================
 
clear;lines(0);
 
A=1;
 
isdef('A')
 ans  =
 
  T  
 
clear A
 
isdef('A')
 ans  =
 
  F  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/isinf.man
 
//====================================================
 
clear;lines(0);
 
isinf([1 0.01 -%inf %inf])
 ans  =
 
! F F T T !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/isnan.man
 
//====================================================
 
clear;lines(0);
 
isnan([1 0.01 -%nan %inf-%inf])
 ans  =
 
! F F T T !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/kron.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2;3,4];
 
kron(A,A)
 ans  =
 
!   1.    2.     2.     4.  !
!   3.    4.     6.     8.  !
!   3.    6.     4.     8.  !
!   9.    12.    12.    16. !
 
A.*.A
 ans  =
 
!   1.    2.     2.     4.  !
!   3.    4.     6.     8.  !
!   3.    6.     4.     8.  !
!   9.    12.    12.    16. !
 
A(1,1)=%i;
 
kron(A,A)
 ans  =
 
! - 1.     2.i    2.i    4.  !
!   3.i    4.i    6.     8.  !
!   3.i    6.     4.i    8.  !
!   9.     12.    12.    16. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/ldivf.man
 
//====================================================
 
clear;lines(0);
 
ldivf('1','1')
 ans  =
 
 1   
 
ldivf('a','0')
 ans  =
 
 0   
 
ldivf('a','x')
 ans  =
 
 a\x   
 
ldivf('2','4')
 ans  =
 
 2\4   
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/linspace.man
 
//====================================================
 
clear;lines(0);
 
linspace(1,2,10)
 ans  =
 
 
         column 1 to 5
 
!   1.    1.1111111    1.2222222    1.3333333    1.4444444 !
 
         column  6 to 10
 
!   1.5555556    1.6666667    1.7777778    1.8888889    2. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/loadmps.man
 
//====================================================
 
clear;lines(0);
 
//File : test.mps
 
//NAME          TESTPROB
 
//ROWS
 
// N  COST
 
// L  LIM1
 
// G  LIM2
 
// E  MYEQN
 
//COLUMNS
 
//    XONE      COST                 1   LIM1                 1
 
//    XONE      LIM2                 1
 
//    YTWO      COST                 4   LIM1                 1
 
//    YTWO      MYEQN               -1
 
//    ZTHREE    COST                 9   LIM2                 1
 
//    ZTHREE    MYEQN                1
 
//RHS
 
//    RHS1      LIM1                 5   LIM2                10
 
//    RHS1      MYEQN                7
 
//BOUNDS
 
// UP BND1      XONE                 4
 
// LO BND1      YTWO                -1
 
// UP BND1      YTWO                 1
 
//ENDATA
 
 
//// objective:
 
//   min     XONE + 4 YTWO + 9 ZTHREE
 
//// constraints:
 
//  LIM1:    XONE +   YTWO            < = 5
 
//  LIM2:    XONE +            ZTHREE > = 10
 
// MYEQN:         -   YTWO  +  ZTHREE   = 7
 
//// Bounds
 
//  0 < = XONE < = 4
 
// -1 < = YTWO < = 1
 
//// End
 
//[A,b,c,l,u,BIG,name,ifree] = loadmps('test')
 
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/log.man
 
//====================================================
 
clear;lines(0);
 
exp(log([1,%i,-1,-%i]))
 ans  =
 
!   1.    6.123D-17 + i    - 1. + 1.225D-16i    6.123D-17 - i   !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/log10.man
 
//====================================================
 
clear;lines(0);
 
10.^log10([1,%i,-1,-%i])
 ans  =
 
!   1.    6.123D-17 + i    - 1. + 1.225D-16i    6.123D-17 - i   !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/logm.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2;3,4];
 
logm(A)
 ans  =
 
! - 0.3504398 + 2.391118i     0.9293512 - 1.0937622i !
!   1.3940268 - 1.6406433i    1.043587 + 0.7504747i  !
 
expm(logm(A))
 ans  =
 
!   1. + 2.520D-16i    2. + 3.268D-16i !
!   3. + 1.226D-16i    4. + 2.261D-16i !
 
A1=A*A';
 
logm(A1)
 ans  =
 
! - 1.1254747    2.0004841 !
!   2.0004841    2.5117691 !
 
expm(logm(A1))
 ans  =
 
!   5.     11. !
!   11.    25. !
 
A1(1,1)=%i;
 
expm(logm(A1))
 ans  =
 
! - 3.553D-15 + i       11. - 2.220D-15i !
!   11. + 2.665D-15i    25. - 3.553D-15i !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/logspace.man
 
//====================================================
 
clear;lines(0);
 
logspace(1,2,10)
 ans  =
 
 
         column 1 to 5
 
!   10.    12.915497    16.681005    21.544347    27.825594 !
 
         column  6 to 10
 
!   35.938137    46.415888    59.948425    77.426368    100. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/macr2lst.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/macrovar.man
 
//====================================================
 
clear;lines(0);
 
deff('y=f(x1,x2)','loc=1;y=a*x1+x2-loc')
 
vars=macrovar(f)
 vars  =
 
 
       vars(1)
 
!x1  !
!    !
!x2  !
 
       vars(2)
 
 y   
 
       vars(3)
 
 a   
 
       vars(4)
 
     []
 
       vars(5)
 
 loc   
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/manedit.man
 
//====================================================
 
clear;lines(0);
 
//manedit('lqg')
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/mean.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2,10;7,7.1,7.01];
 
mean(A)
 ans  =
 
    5.685  
 
mean(A,'r')
 ans  =
 
!   4.    4.55    8.505 !
 
mean(A,'c')
 ans  =
 
!   4.3333333 !
!   7.0366667 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/median.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2,10;7,7.1,7.01];
 
median(A)
 ans  =
 
    7.005  
 
median(A,'r')
 ans  =
 
!   4.    4.55    8.505 !
 
median(A,'c')
 ans  =
 
!   2.   !
!   7.01 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/modulo.man
 
//====================================================
 
clear;lines(0);
 
n=[1,2,10,15];m=[2,2,3,5];
 
modulo(n,m)
 ans  =
 
!   1.    0.    1.    0. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/mulf.man
 
//====================================================
 
clear;lines(0);
 
mulf('1','a')
 ans  =
 
 a   
 
mulf('0','a')
 ans  =
 
 0   
 
'a'+'b'   //Caution...
 ans  =
 
 ab   
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/nnz.man
 
//====================================================
 
clear;lines(0);
 
sp=sparse([1,2;4,5;3,10],[1,2,3]);
 
nnz(sp)
 ans  =
 
    3.  
 
a=[1 0 0 0 2];
 
nnz(a)
 ans  =
 
    2.  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/norm.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2,3];
 
norm(A,1)
 ans  =
 
    6.  
 
norm(A,'inf')
 ans  =
 
    3.  
 
A=[1,2;3,4]
 A  =
 
!   1.    2. !
!   3.    4. !
 
max(svd(A))-norm(A)
 ans  =
 
    0.  
 
 
A=sparse([1 0 0 33 -1])
 A  =
 
(    1,    5) sparse matrix
 
(    1,    1)        1. 
(    1,    4)        33. 
(    1,    5)      - 1. 
 
norm(A)
 ans  =
 
    33.030289  
 
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/pen2ea.man
 
//====================================================
 
clear;lines(0);
 
E=[1,0];A=[1,2];s=poly(0,'s');
 
[E,A]=pen2ea(s*E-A)
 A  =
 
!   1.    2. !
 E  =
 
!   1.    0. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/pertrans.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2;3,4]
 A  =
 
!   1.    2. !
!   3.    4. !
 
pertrans(A)
 ans  =
 
!   4.    2. !
!   3.    1. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/prod.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2;0,100];
 
prod(A)
 ans  =
 
    0.  
 
prod(A,'c')
 ans  =
 
!   2. !
!   0. !
 
prod(A,'r')
 ans  =
 
!   0.    200. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/rdivf.man
 
//====================================================
 
clear;lines(0);
 
ldivf('c','d')
 ans  =
 
 c\d   
 
ldivf('1','2')
 ans  =
 
 2   
 
ldivf('a','0')
 ans  =
 
 0   
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/readc_.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/sci2exp.man
 
//====================================================
 
clear;lines(0);
 
  a=[1 2;3 4]
 a  =
 
!   1.    2. !
!   3.    4. !
 
  sci2exp(a,'aa')
 ans  =
 
!aa = [1,2;  !
!            !
!3,4]        !
 
  sci2exp(a,'aa',0)
 ans  =
 
!aa = [1,2;  !
!            !
!3,4]        !
 
  sci2exp(ssrand(2,2,2))
 ans  =
 
!tlist(['lss','A','B','C','D','X0','dt'],..  !
!                                            !
![-0.7616491,0.8529775;                      !
!                                            !
!1.4739762,0.7223316],..                     !
!                                            !
![0.6380837,-0.6834217;                      !
!                                            !
!0.2546697,0.8145126],..                     !
!                                            !
![-0.1884803,-0.9239258;                     !
!                                            !
!-1.0327357,2.7266682],..                    !
!                                            !
![0,0;                                       !
!                                            !
!0,0],[0;0],'c')                             !
 
  sci2exp(poly([1 0 3 4],'s'),'fi')
 ans  =
 
 fi = -12*s+19*s^2-8*s^3+s^4   
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/sci2map.man
 
//====================================================
 
clear;lines(0);
 
txt=[sci2map([1 2;3 4],'a');
     sci2map(%s^2+3*%s+4,'p')]
 txt  =
 
!a := array(1..2,1..2);  !
!                        !
!a[1,1] := 1;            !
!                        !
!a[1,2] := 2;            !
!                        !
!a[2,1] := 3;            !
!                        !
!a[2,2] := 4;            !
!                        !
!p := 4+s*(3+s) ;        !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/setmenu.man
 
//====================================================
 
clear;lines(0);
 
addmenu('foo')   //New button made in main scilab window
 
unsetmenu('foo')   //button foo cannot be activated (grey string)
 
setmenu('foo')     //button foo can be activated (black string)
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/sin.man
 
//====================================================
 
clear;lines(0);
 
asin(sin([1,0,%i]))
 ans  =
 
!   1.    0    i   !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/sinh.man
 
//====================================================
 
clear;lines(0);
 
asinh(sinh([0,1,%i]))
 ans  =
 
!   0    1.    i   !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/sinhm.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2;2,3]
 A  =
 
!   1.    2. !
!   2.    3. !
 
asinhm(sinhm(A))
 ans  =
 
!   1.    2. !
!   2.    3. !
 
A(1,1)=%i;sinhm(A)-(expm(A)-expm(-A))/2   //Complex case
 ans  =
 
!   0    0 !
!   0    0 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/sinm.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2;2,4];
 
sinm(A)+0.5*%i*(expm(%i*A)-expm(-%i*A))
 ans  =
 
!   0    0 !
!   0    0 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/smooth.man
 
//====================================================
 
clear;lines(0);
 
x=[1 10 20 30 40];
 
y=[1 30 -10 20 40];
 
plot2d(x',y',[3],"011"," ",[-10,-40,50,50]);
 
yi=smooth([x;y],0.1);
 
plot2d(yi(1,:)',yi(2,:)',[1],"000");
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/solve.man
 
//====================================================
 
clear;lines(0);
 
A=['1','a';'0','2'];   //Upper triangular
 
b=['x';'y'];
 
w=solve(A,b)
 w  =
 
!x-a*(2\y)  !
!           !
!2\y        !
 
a=1;x=2;y=5;
 
evstr(w)
 ans  =
 
! - 0.5 !
!   2.5 !
 
inv([1,1;0,2])*[2;5]
 ans  =
 
! - 0.5 !
!   2.5 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/sort.man
 
//====================================================
 
clear;lines(0);
 
[s,p]=sort(rand(1,10));
 
//p  is a random permutation of 1:10
 
A=[1,2,5;3,4,2];
 
[Asorted,q]=sort(A);A(q(:))-Asorted(:)
 ans  =
 
!   0. !
!   0. !
!   0. !
!   0. !
!   0. !
!   0. !
 
v=1:10;
 
sort(v)
 ans  =
 
!   10.    9.    8.    7.    6.    5.    4.    3.    2.    1. !
 
sort(v')
 ans  =
 
!   10. !
!   9.  !
!   8.  !
!   7.  !
!   6.  !
!   5.  !
!   4.  !
!   3.  !
!   2.  !
!   1.  !
 
sort(v,'r')  //Does nothing for row vectors
 ans  =
 
!   1.    2.    3.    4.    5.    6.    7.    8.    9.    10. !
 
sort(v,'c')
 ans  =
 
!   10.    9.    8.    7.    6.    5.    4.    3.    2.    1. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/sp2adj.man
 
//====================================================
 
clear;lines(0);
 
A = sprand(100,50,.05);
 
[xadj,adjncy,anz]= sp2adj(A);
 
[n,m]=size(A);
 
p = adj2sp(xadj,adjncy,anz,[n,m]);
 
A-p,
 ans  =
 
(  100,   50) zero sparse matrix
 
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/sparse.man
 
//====================================================
 
clear;lines(0);
 
sp=sparse([1,2;4,5;3,10],[1,2,3])
 sp  =
 
(    4,   10) sparse matrix
 
(    1,    2)        1. 
(    3,   10)        3. 
(    4,    5)        2. 
 
size(sp)
 ans  =
 
!   4.    10. !
 
x=rand(2,2);abs(x)-full(abs(sparse(x)))
 ans  =
 
!   0.    0. !
!   0.    0. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/spcompack.man
 
//====================================================
 
clear;lines(0);
 
// A is the sparse matrix:
 
A=[1,0,0,0,0,0,0;
   0,1,0,0,0,0,0;
   0,0,1,0,0,0,0;
   0,0,1,1,0,0,0;
   0,0,1,1,1,0,0;
   0,0,1,1,0,1,0;
   0,0,1,1,0,1,1];
 
A=sparse(A);
 
//For this matrix, the standard adjacency representation is given by:
 
xadj=[1,2,3,8,12,13,15,16];
 
adjncy=[1, 2, 3,4,5,6,7, 4,5,6,7, 5, 6,7, 7];
 
//(see sp2adj).
 
// increments in vector xadj give the number of non zero entries in each column
 
// ie there is 2-1=1 entry in the column 1
 
//    there is 3-2=1 entry in the column 2
 
//    there are 8-3=5 entries in the column 3
 
//              12-8=4                      4
 
//etc
 
//The row index of these entries is given by the adjncy vector
 
// for instance,
 
// adjncy (3:7)=adjncy(xadj(3):xadj(4)-1)=[3,4,5,6,7]
 
// says that the 5=xadj(4)-xadj(3) entries in column 3 have row
 
// indices 3,4,5,6,7.
 
//In the compact representation, the repeated sequences in adjncy
 
//are eliminated.
 
//Here in adjncy the sequences 4,5,6,7  and 7 are eliminated.
 
//The standard structure (xadj,adjncy) takes the compressed form (lindx,xlindx)
 
lindx=[1, 2, 3,4,5,6,7, 5, 6,7];
 
xlindx=[1,2,3,8,9,11];
 
//(Columns 4 and 7 of A are eliminated).
 
//A can be reconstructed from (xadj,xlindx,lindx).
 
[xadj,adjncy,anz]= sp2adj(A);
 
adjncy -  spcompack(xadj,xlindx,lindx)
 ans  =
 
!   0. !
!   0. !
!   0. !
!   0. !
!   0. !
!   0. !
!   0. !
!   0. !
!   0. !
!   0. !
!   0. !
!   0. !
!   0. !
!   0. !
!   0. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/speye.man
 
//====================================================
 
clear;lines(0);
 
eye(3,3)-full(speye(3,3))
 ans  =
 
!   0.    0.    0. !
!   0.    0.    0. !
!   0.    0.    0. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/spget.man
 
//====================================================
 
clear;lines(0);
 
sp=sparse([1,2;4,5;3,10],[1,2,3])
 sp  =
 
(    4,   10) sparse matrix
 
(    1,    2)        1. 
(    3,   10)        3. 
(    4,    5)        2. 
 
[ij,v,mn]=spget(sp);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/splin.man
 
//====================================================
 
clear;lines(0);
 
x=0:0.5:10;f=sin(x);
 
d=splin(x,f);
 
S=interp(0:0.1:10,x,f,d);
 
plot2d(x',f',-1);
 
plot2d((0:0.1:10)',S',2,'000')
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/spones.man
 
//====================================================
 
clear;lines(0);
 
A=sprand(10,12,0.1);
 
sp=spones(A)
 sp  =
 
(   10,   12) sparse matrix
 
(    1,    2)        1. 
(    1,   10)        1. 
(    2,    4)        1. 
(    2,    5)        1. 
(    4,    3)        1. 
(    4,    8)        1. 
(    4,    9)        1. 
(    4,   11)        1. 
(    5,    1)        1. 
(    6,    6)        1. 
(    8,    8)        1. 
(    9,    1)        1. 
 
B = A~=0
 B  =
 
(   10,   12) sparse matrix
 
(    1,    2)    T 
(    1,   10)    T 
(    2,    4)    T 
(    2,    5)    T 
(    4,    3)    T 
(    4,    8)    T 
(    4,    9)    T 
(    4,   11)    T 
(    5,    1)    T 
(    6,    6)    T 
(    8,    8)    T 
(    9,    1)    T 
 
bool2s(B)
 ans  =
 
(   10,   12) sparse matrix
 
(    1,    2)        1. 
(    1,   10)        1. 
(    2,    4)        1. 
(    2,    5)        1. 
(    4,    3)        1. 
(    4,    8)        1. 
(    4,    9)        1. 
(    4,   11)        1. 
(    5,    1)        1. 
(    6,    6)        1. 
(    8,    8)        1. 
(    9,    1)        1. 
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/sprand.man
 
//====================================================
 
clear;lines(0);
 
W=sprand(100,1000,0.001);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/spzeros.man
 
//====================================================
 
clear;lines(0);
 
sum(spzeros(1000,1000))
 ans  =
 
    0.  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/sqrt.man
 
//====================================================
 
clear;lines(0);
 
sqrt([2,4])
 ans  =
 
!   1.4142136    2. !
 
sqrt(-1)
 ans  =
 
    i    
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/sqrtm.man
 
//====================================================
 
clear;lines(0);
 
x=[0 1;2 4]
 x  =
 
!   0.    1. !
!   2.    4. !
 
w=sqrtm(x);
 
norm(w*w-x)
 ans  =
 
    1.007D-15  
 
x(1,2)=%i;
 
w=sqrtm(x);norm(w*w-x,1)
 ans  =
 
    2.224D-15  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/ssprint.man
 
//====================================================
 
clear;lines(0);
 
 a=[1 1;0 1];b=[0 1;1 0];c=[1,1];d=[3,2];
 
 ssprint(syslin('c',a,b,c,d))
 
.   | 1  1 |    | 0  1 |
x = | 0  1 |x + | 1  0 |u   
 
y = | 1  1 |x + | 3  2 |
 
 ssprint(syslin('d',a,b,c,d))
 
+   | 1  1 |    | 0  1 |
x = | 0  1 |x + | 1  0 |u   
 
y = | 1  1 |x + | 3  2 |
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/ssrand.man
 
//====================================================
 
clear;lines(0);
 
//flag=list('st',dim_cont_subs,dim_stab_subs,dim_stab0)
 
//dim_cont_subs<=dim_stab_subs<=dim_stab0
 
//pair (A,B) U-similar to:
 
//    [*,*,*,*;     [*;
 
//    [0,s,*,*;     [0;
 
//A=  [0,0,i,*;   B=[0;
 
//    [0,0,0,u]     [0]
 
//
 
// (A11,B1) controllable  s=stable matrix i=neutral matrix u=unstable matrix
 
[Sl,U]=ssrand(2,3,8,list('st',2,5,5));
 
w=ss2ss(Sl,inv(U)); //undo the random change of basis => form as above
 
[n,nc,u,sl]=st_ility(Sl);n,nc
 n  =
 
    5.  
 nc  =
 
    2.  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/strcat.man
 
//====================================================
 
clear;lines(0);
 
strcat(string(1:10),',')
 ans  =
 
 1,2,3,4,5,6,7,8,9,10   
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/strindex.man
 
//====================================================
 
clear;lines(0);
 
k=strindex('SCI/demos/scicos','/')
 k  =
 
!   4.    10. !
 
k=strindex('SCI/demos/scicos','SCI/')
 k  =
 
    1.  
 
k=strindex('SCI/demos/scicos','!')
 k  =
 
     []
 
k=strindex('aaaaa','aa')
 k  =
 
!   1.    3. !
 
k=strindex('SCI/demos/scicos',['SCI','sci'])
 k  =
 
!   1.    11. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/strsubst.man
 
//====================================================
 
clear;lines(0);
 
strsubst('SCI/demos/scicos','SCI','.')
 ans  =
 
 ./demos/scicos   
 
strsubst('SCI/demos/scicos','/',' ')
 ans  =
 
 SCI demos scicos   
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/subf.man
 
//====================================================
 
clear;lines(0);
 
subf('0','a')
 ans  =
 
 -a   
 
subf('2','1')
 ans  =
 
 1   
 
subf('a','0')
 ans  =
 
 a   
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/sum.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2;3,4];
 
trace(A)-sum(diag(A))
 ans  =
 
    0.  
 
sum(A,'c')-A*ones(2,1)
 ans  =
 
!   0. !
!   0. !
 
sum(A+%i)
 ans  =
 
    10. + 4.i  
 
A=sparse(A);sum(A,'c')-A*ones(2,1)
 ans  =
 
!   0. !
!   0. !
 
s=poly(0,'s');
 
M=[s,%i+s;s^2,1];
 
sum(M),sum(M,2)
 ans  =
 
real part
 
 
              2  
    1 + 2s + s   
imaginary part
 
 
    1   
 ans  =
 
real part
 
 
!   2s     !
!          !
!        2 !
!   1 + s  !
imaginary part
 
 
!   1  !
!      !
!   0  !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/sysconv.man
 
//====================================================
 
clear;lines(0);
 
s1=ssrand(1,1,2);
 
s2=ss2tf(s1);
 
[s1,s2]=sysconv(s1,s2);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/sysdiag.man
 
//====================================================
 
clear;lines(0);
 
 s=poly(0,'s')
 s  =
 
    s   
 
 sysdiag(rand(2,2),1/(s+1),[1/(s-1);1/((s-2)*(s-3))])
 ans  =
 
!   0.2113249     0.0002211     0         0           !
!   ---------     ---------     -         -           !
!       1             1         1         1           !
!                                                     !
!   0.7560439     0.3303271     0         0           !
!   ---------     ---------     -         -           !
!       1             1         1         1           !
!                                                     !
!   0             0               1       0           !
!   -             -             -----     -           !
!   1             1             1 + s     1           !
!                                                     !
!   0             0             0           1         !
!   -             -             -         -----       !
!   1             1             1       - 1 + s       !
!                                                     !
!   0             0             0             1       !
!   -             -             -         ---------   !
!                                                   2 !
!   1             1             1         6 - 5s + s  !
 
 sysdiag(tf2ss(1/s),1/(s+1),[1/(s-1);1/((s-2)*(s-3))])
 ans  =
 
 
       ans(1)   (state-space system:)
 
!lss  A  B  C  D  X0  dt  !
 
       ans(2) = A matrix = 
 
!   0.    0.    0.           0.           0.        !
!   0.  - 1.    0.           0.           0.        !
!   0.    0.    1.           2.235D-08  - 4.843D-08 !
!   0.    0.    4.150D-08    4.6666667  - 2.1272641 !
!   0.    0.  - 4.065D-10    2.0892772    0.3333333 !
 
       ans(3) = B matrix = 
 
!   1.    0.    0.        !
!   0.    1.    0.        !
!   0.    0.  - 1.619D+08 !
!   0.    0.  - 2.3094011 !
!   0.    0.    0.4605662 !
 
       ans(4) = C matrix = 
 
!   1.    0.    0.           0.           0. !
!   0.    1.    0.           0.           0. !
!   0.    0.  - 6.178D-09    0.           0. !
!   0.    0.    8.825D-10  - 0.0618590    0. !
 
       ans(5) = D matrix = 
 
!   0.    0.    0. !
!   0.    0.    0. !
!   0.    0.    0. !
!   0.    0.    0. !
 
       ans(6) = X0 (initial state) = 
 
!   0. !
!   0. !
!   0. !
!   0. !
!   0. !
 
       ans(7) = Time domain = 
 
     []
 
 
 s=poly(0,'s')
 s  =
 
    s   
 
 sysdiag(rand(2,2),1/(s+1),[1/(s-1);1/((s-2)*(s-3))])
 ans  =
 
!   0.6653811     0.8497452     0         0           !
!   ---------     ---------     -         -           !
!       1             1         1         1           !
!                                                     !
!   0.6283918     0.6857310     0         0           !
!   ---------     ---------     -         -           !
!       1             1         1         1           !
!                                                     !
!   0             0               1       0           !
!   -             -             -----     -           !
!   1             1             1 + s     1           !
!                                                     !
!   0             0             0           1         !
!   -             -             -         -----       !
!   1             1             1       - 1 + s       !
!                                                     !
!   0             0             0             1       !
!   -             -             -         ---------   !
!                                                   2 !
!   1             1             1         6 - 5s + s  !
 
 sysdiag(tf2ss(1/s),1/(s+1),[1/(s-1);1/((s-2)*(s-3))])
 ans  =
 
 
       ans(1)   (state-space system:)
 
!lss  A  B  C  D  X0  dt  !
 
       ans(2) = A matrix = 
 
!   0.    0.    0.           0.           0.        !
!   0.  - 1.    0.           0.           0.        !
!   0.    0.    1.           2.235D-08  - 4.843D-08 !
!   0.    0.    4.150D-08    4.6666667  - 2.1272641 !
!   0.    0.  - 4.065D-10    2.0892772    0.3333333 !
 
       ans(3) = B matrix = 
 
!   1.    0.    0.        !
!   0.    1.    0.        !
!   0.    0.  - 1.619D+08 !
!   0.    0.  - 2.3094011 !
!   0.    0.    0.4605662 !
 
       ans(4) = C matrix = 
 
!   1.    0.    0.           0.           0. !
!   0.    1.    0.           0.           0. !
!   0.    0.  - 6.178D-09    0.           0. !
!   0.    0.    8.825D-10  - 0.0618590    0. !
 
       ans(5) = D matrix = 
 
!   0.    0.    0. !
!   0.    0.    0. !
!   0.    0.    0. !
!   0.    0.    0. !
 
       ans(6) = X0 (initial state) = 
 
!   0. !
!   0. !
!   0. !
!   0. !
!   0. !
 
       ans(7) = Time domain = 
 
     []
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/syslin.man
 
//====================================================
 
clear;lines(0);
 
A=[0,1;0,0];B=[1;1];C=[1,1];
 
S1=syslin('c',A,B,C)   //Linear system definition
 S1  =
 
 
       S1(1)   (state-space system:)
 
!lss  A  B  C  D  X0  dt  !
 
       S1(2) = A matrix = 
 
!   0.    1. !
!   0.    0. !
 
       S1(3) = B matrix = 
 
!   1. !
!   1. !
 
       S1(4) = C matrix = 
 
!   1.    1. !
 
       S1(5) = D matrix = 
 
    0.  
 
       S1(6) = X0 (initial state) = 
 
!   0. !
!   0. !
 
       S1(7) = Time domain = 
 
 c   
 
S1("A")    //Display of A-matrix
 ans  =
 
!   0.    1. !
!   0.    0. !
 
S1("X0"), S1("dt") // Display of X0 and time domain
 ans  =
 
!   0. !
!   0. !
 ans  =
 
 c   
 
s=poly(0,'s');
 
D=s;
 
S2=syslin('c',A,B,C,D)
 S2  =
 
 
       S2(1)   (state-space system:)
 
!lss  A  B  C  D  X0  dt  !
 
       S2(2) = A matrix = 
 
!   0.    1. !
!   0.    0. !
 
       S2(3) = B matrix = 
 
!   1. !
!   1. !
 
       S2(4) = C matrix = 
 
!   1.    1. !
 
       S2(5) = D matrix = 
 
    s   
 
       S2(6) = X0 (initial state) = 
 
!   0. !
!   0. !
 
       S2(7) = Time domain = 
 
 c   
 
H1=(1+2*s)/s^2, S1bis=syslin('c',H1)
 H1  =
 
    1 + 2s   
    ------   
       2     
      s      
 S1bis  =
 
    1 + 2s   
    ------   
       2     
      s      
 
H2=(1+2*s+s^3)/s^2, S2bis=syslin('c',H2)
 H2  =
 
              3  
    1 + 2s + s   
    ----------   
         2       
        s        
 S2bis  =
 
              3  
    1 + 2s + s   
    ----------   
         2       
        s        
 
S1+S2
 ans  =
 
 
       ans(1)   (state-space system:)
 
!lss  A  B  C  D  X0  dt  !
 
       ans(2) = A matrix = 
 
!   0.    1.    0.    0. !
!   0.    0.    0.    0. !
!   0.    0.    0.    1. !
!   0.    0.    0.    0. !
 
       ans(3) = B matrix = 
 
!   1. !
!   1. !
!   1. !
!   1. !
 
       ans(4) = C matrix = 
 
!   1.    1.    1.    1. !
 
       ans(5) = D matrix = 
 
    s   
 
       ans(6) = X0 (initial state) = 
 
!   0. !
!   0. !
!   0. !
!   0. !
 
       ans(7) = Time domain = 
 
 c   
 
[S1,S2]
 ans  =
 
 
       ans(1)   (state-space system:)
 
!lss  A  B  C  D  X0  dt  !
 
       ans(2) = A matrix = 
 
!   0.    1.    0.    0. !
!   0.    0.    0.    0. !
!   0.    0.    0.    1. !
!   0.    0.    0.    0. !
 
       ans(3) = B matrix = 
 
!   1.    0. !
!   1.    0. !
!   0.    1. !
!   0.    1. !
 
       ans(4) = C matrix = 
 
!   1.    1.    1.    1. !
 
       ans(5) = D matrix = 
 
!   0    s  !
 
       ans(6) = X0 (initial state) = 
 
!   0. !
!   0. !
!   0. !
!   0. !
 
       ans(7) = Time domain = 
 
 c   
 
ss2tf(S1)-S1bis
 ans  =
 
  - 3.331D-16   
    ---------   
         2      
        s       
 
S1bis+S2bis
 ans  =
 
              3  
    2 + 4s + s   
    ----------   
         2       
        s        
 
S1*S2bis
 ans  =
 
 
       ans(1)   (state-space system:)
 
!lss  A  B  C  D  X0  dt  !
 
       ans(2) = A matrix = 
 
!   0.    1.  - 0.6454972    0.  !
!   0.    0.  - 0.6454972    0.  !
!   0.    0.    0.4        - 0.4 !
!   0.    0.    0.4        - 0.4 !
 
       ans(3) = B matrix = 
 
!   1.        !
!   0.        !
! - 3.0983867 !
!   0.7745967 !
 
       ans(4) = C matrix = 
 
!   1.    1.    0.    0. !
 
       ans(5) = D matrix = 
 
    2.  
 
       ans(6) = X0 (initial state) = 
 
!   0. !
!   0. !
!   0. !
!   0. !
 
       ans(7) = Time domain = 
 
 c   
 
size(S1)
 ans  =
 
!   1.    1. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/tan.man
 
//====================================================
 
clear;lines(0);
 
x=[1,%i,-1,-%i]
 x  =
 
!   1.    i    - 1.  - i   !
 
tan(x)
 ans  =
 
!   1.5574077    0.7615942i  - 1.5574077  - 0.7615942i !
 
sin(x)./cos(x)
 ans  =
 
!   1.5574077    0.7615942i  - 1.5574077  - 0.7615942i !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/tanh.man
 
//====================================================
 
clear;lines(0);
 
x=[1,%i,-1,-%i]
 x  =
 
!   1.    i    - 1.  - i   !
 
tanh(x)
 ans  =
 
!   0.7615942    1.5574077i  - 0.7615942  - 1.5574077i !
 
sinh(x)./cosh(x)
 ans  =
 
 
         column 1 to 3
 
!   0.7615942    2.628D-16 + 1.5574077i  - 0.7615942 !
 
         column 4
 
!   2.628D-16 - 1.5574077i !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/tanhm.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/tanm.man
 
//====================================================
 
clear;lines(0);
 
A=[1,2;3,4];
 
tanm(A)
 ans  =
 
! - 0.6050748  - 0.3127417 !
! - 0.4691125  - 1.0741873 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/timer.man
 
//====================================================
 
clear;lines(0);
 
timer();A=rand(100,100);timer()
 ans  =
 
    0.016666  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/toeplitz.man
 
//====================================================
 
clear;lines(0);
 
A=toeplitz(1:5);
 
//
 
T=toeplitz(1:5,1:2:7);T1=[1 3 5 7;2 1 3 5;3 2 1 3;4 3 2 1;5 4 3 2];
 
T-T1
 ans  =
 
!   0.    0.    0.    0. !
!   0.    0.    0.    0. !
!   0.    0.    0.    0. !
!   0.    0.    0.    0. !
!   0.    0.    0.    0. !
 
//
 
s=poly(0,'s');
 
t=toeplitz([s,s+1,s^2,1-s]);
 
t1=[s,1+s,s*s,1-s;1+s,s,1+s,s*s;s*s,1+s,s,1+s;1-s,s*s,1+s,s]
 t1  =
 
!                        2               !
!   s         1 + s     s         1 - s  !
!                                        !
!                                  2     !
!   1 + s     s         1 + s     s      !
!                                        !
!    2                                   !
!   s         1 + s     s         1 + s  !
!                                        !
!              2                         !
!   1 - s     s         1 + s     s      !
 
t-t1
 ans  =
 
!   0    0    0    0 !
!                    !
!   0    0    0    0 !
!                    !
!   0    0    0    0 !
!                    !
!   0    0    0    0 !
 
//
 
t=toeplitz(['1','2','3','4']);
 
t1=['1','2','3','4';'2','1','2','3';'3','2','1','2';'4','3','2','1']
 t1  =
 
!1  2  3  4  !
!            !
!2  1  2  3  !
!            !
!3  2  1  2  !
!            !
!4  3  2  1  !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/trfmod.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/trianfml.man
 
//====================================================
 
clear;lines(0);
 
A=['1','2';'a','b']
 A  =
 
!1  2  !
!      !
!a  b  !
 
W=trianfml([A,string(eye(2,2))])
 W  =
 
!a  b      0  1   !
!                 !
!0  a*2-b  a  -1  !
 
U=W(:,3:4)
 U  =
 
!0  1   !
!       !
!a  -1  !
 
a=5;b=6;
 
A=evstr(A)
 A  =
 
!   1.    2. !
!   5.    6. !
 
U=evstr(U)
 U  =
 
!   0.    1. !
!   5.  - 1. !
 
U*A
 ans  =
 
!   5.    6. !
!   0.    4. !
 
evstr(W(:,1:2))
 ans  =
 
!   5.    6. !
!   0.    4. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/tril.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s');
 
tril([s,s;s,1])
 ans  =
 
!   s     0  !
!            !
!   s     1  !
 
tril([1/s,1/s;1/s,1])
 ans  =
 
!   1     0  !
!   -     -  !
!   z     1  !
!            !
!   1     1  !
!   -     -  !
!   z     1  !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/trisolve.man
 
//====================================================
 
clear;lines(0);
 
A=['x','y';'0','z'];b=['0';'1'];
 
w=trisolve(A,b)
 w  =
 
!-x\y*(z\1)  !
!            !
!z\1         !
 
x=5;y=2;z=4;
 
evstr(w)
 ans  =
 
! - 0.1  !
!   0.25 !
 
inv(evstr(A))*evstr(b)
 ans  =
 
! - 0.1  !
!   0.25 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/triu.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/typeof.man
 
//====================================================
 
clear;lines(0);
 
typeof(1)
 ans  =
 
 constant   
 
typeof(poly(0,'x'))
 ans  =
 
 polynomial   
 
typeof(1/poly(0,'x'))
 ans  =
 
 rational   
 
typeof(%t)
 ans  =
 
 boolean   
 
w=sprand(100,100,0.001);
 
typeof(w)
 ans  =
 
 sparse   
 
typeof(w==w)
 ans  =
 
 boolean sparse   
 
deff('y=f(x)','y=2*x');
 
typeof(f)
 ans  =
 
 function   
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/unsetmenu.man
 
//====================================================
 
clear;lines(0);
 
//addmenu('foo')
 
//unsetmenu('foo')
 
//unsetmenu('File',2)
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/x_choices.man
 
//====================================================
 
clear;lines(0);
 
l1=list('choice 1',1,['toggle c1','toggle c2','toggle c3']);
 
l2=list('choice 2',2,['toggle d1','toggle d2','toggle d3']);
 
l3=list('choice 3',3,['toggle e1','toggle e2']);
 
rep=x_choices('Toggle Menu',list(l1,l2,l3));
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/x_choose.man
 
//====================================================
 
clear;lines(0);
 
n=x_choose(['item1';'item2';'item3'],['that is a comment';'for the dialog'])
 n  =
 
    0.  
 
n=x_choose(['item1';'item2';'item3'],['that is a comment'],'Return')
 n  =
 
    0.  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/x_dialog.man
 
//====================================================
 
clear;lines(0);
 
//gain=evstr(x_dialog('value of gain ?','0.235'))
 
//x_dialog(['Method';'enter sampling period'],'1')
 
//m=evstr(x_dialog('enter a  3x3 matrix ',['[0 0 0';'0 0 0';'0 0 0]']))
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/x_matrix.man
 
//====================================================
 
clear;lines(0);
 
//m=evstr(x_matrix('enter a  3x3 matrix ',rand(3,3)))
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/x_mdialog.man
 
//====================================================
 
clear;lines(0);
 
 txt=['magnitude';'frequency';'phase    '];
 
 sig=x_mdialog('enter sine signal',txt,['1';'10';'0'])
 sig  =
 
!1   !
!    !
!10  !
!    !
!0   !
 
 mag=evstr(sig(1))
 mag  =
 
    1.  
 
 frq=evstr(sig(2))
 frq  =
 
    10.  
 
 ph=evstr(sig(3))
 ph  =
 
    0.  
 
 
 rep=x_mdialog(['System Simulation';'with PI regulator'],...
                      ['P gain';'I gain '],[' ';' '])
 rep  =
 
     []
 
 
 
 n=5;m=4;mat=rand(n,m);
 
 row='row';labelv=row(ones(1,n))+string(1:n)
 labelv  =
 
!row1  row2  row3  row4  row5  !
 
 col='col';labelh=col(ones(1,m))+string(1:m)
 labelh  =
 
!col1  col2  col3  col4  !
 
 new=evstr(x_mdialog('Matrix to edit',labelv,labelh,string(mat)))
 new  =
 
!   0.4010642    0.940844     0.2922168    0.8308221 !
!   0.0144279    0.6212037    0.8204083    0.0635594 !
!   0.3753535    0.0193119    0.3866529    0.6130937 !
!   0.6278546    0.248762     0.6413195    0.967591  !
!   0.6070501    0.1251956    0.0149429    0.041081  !
 
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/x_message.man
 
//====================================================
 
clear;lines(0);
 
 gain=0.235;x_message('value of gain is :'+string(gain))
 
 x_message(['singular matrix';'use least squares'])
 
 
 r=x_message(['Your problem is ill conditioned';
             'continue ?'],['Yes','No'])
 r  =
 
    1.  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/xgetfile.man
 
//====================================================
 
clear;lines(0);
 
xgetfile()
 ans  =
 
    
 
xgetfile('*.sci','SCI/macros/xdess')
 ans  =
 
    
 
xgetfile(title='Choose a file name ')
 ans  =
 
    
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/elementary/zeros.man
 
//====================================================
 
clear;lines(0);
 
zeros(3)
 ans  =
 
    0.  
 
zeros(3,3)
 ans  =
 
!   0.    0.    0. !
!   0.    0.    0. !
!   0.    0.    0. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/Graphics.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/Matplot.man
 
//====================================================
 
clear;lines(0);
 
Matplot([1,2,3;4,5,6])
 
// draw the colormap
 
Matplot((1:xget("lastpattern")))
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/Sfgrayplot.man
 
//====================================================
 
clear;lines(0);
 
Sfgrayplot()
deff('[z]=surf(x,y)','z=x**3+y');
Sfgrayplot(-1:0.1:1,-1:0.1:1,surf);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/Sgrayplot.man
 
//====================================================
 
clear;lines(0);
 
Sgrayplot()
t=-%pi:0.1:%pi;m=sin(t)'*cos(t);Sgrayplot(t,t,m);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/addcolor.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/black.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s')
 s  =
 
    s   
 
h=syslin('c',(s^2+2*0.9*10*s+100)/(s^2+2*0.3*10.1*s+102.01))
 h  =
 
                   2     
      100 + 18s + s      
    -----------------    
                      2  
    102.01 + 6.06s + s   
 
chart();
 
sstr='(s^2+2*0.9*10*s+100)/(s^2+2*0.3*10.1*s+102.01)';
 
black(h,0.01,100,sstr);
 
h1=h*syslin('c',(s^2+2*0.1*15.1*s+228.01)/(s^2+2*0.9*15*s+225))
 h1  =
 
                               2        3   4    
     22801 + 4406.18s + 382.37s + 21.02s + s     
    -----------------------------------------    
                                 2        3   4  
    22952.25 + 4117.77s + 490.63s + 33.06s + s   
 
xbasc()
 
black([h1;h],0.01,100,['h1';'h'])
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/bode.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s')
 s  =
 
    s   
 
h=syslin('c',(s^2+2*0.9*10*s+100)/(s^2+2*0.3*10.1*s+102.01))
 h  =
 
                   2     
      100 + 18s + s      
    -----------------    
                      2  
    102.01 + 6.06s + s   
 
title='(s^2+2*0.9*10*s+100)/(s^2+2*0.3*10.1*s+102.01)';
 
bode(h,0.01,100,title);
 
h1=h*syslin('c',(s^2+2*0.1*15.1*s+228.01)/(s^2+2*0.9*15*s+225))
 h1  =
 
                               2        3   4    
     22801 + 4406.18s + 382.37s + 21.02s + s     
    -----------------------------------------    
                                 2        3   4  
    22952.25 + 4117.77s + 490.63s + 33.06s + s   
 
xbasc()
 
bode([h1;h],0.01,100,['h1';'h'])
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/champ.man
 
//====================================================
 
clear;lines(0);
 
// using rect has graphic boundaries
 
champ(-5:5,-5:5,rand(11,11),rand(11,11),1,[-10,-10,10,10],"011");
 
xgrid();
 
xbasc();
 
// using (x,y) to get boundaries
 
champ(-5:5,-5:5,rand(11,11),rand(11,11),2,[-10,-10,10,10],"021");
 
// using coloured arrows
 
xset("use color",1)
 
champ1(-5:5,-5:5,rand(11,11),rand(11,11),2,[-10,-10,10,10],"021");
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/champ1.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/chart.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s')
 s  =
 
    s   
 
h=syslin('c',(s^2+2*0.9*10*s+100)/(s^2+2*0.3*10.1*s+102.01))
 h  =
 
                   2     
      100 + 18s + s      
    -----------------    
                      2  
    102.01 + 6.06s + s   
 
black(h,0.01,100,'(s^2+2*0.9*10*s+100)/(s^2+2*0.3*10.1*s+102.01)')
 
chart(list(1,0,2,3));
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/colormap.man
 
//====================================================
 
clear;lines(0);
 
m=228;
 
n = fix(3/8*m);
 
r = [(1:n)'/n; ones(m-n,1)];
 
g = [zeros(n,1); (1:n)'/n; ones(m-2*n,1)];
 
b = [zeros(2*n,1); (1:m-2*n)'/(m-2*n)];
 
h = [r g b];
 
xset('colormap',h);
 
plot3d1()
 Demo of plot3d1
t=-%pi:0.3:%pi;plot3d1(t,t,sin(t)'*cos(t),35,45,'X@Y@Z',[2,2,4]);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/contour.man
 
//====================================================
 
clear;lines(0);
 
contour2d(1:10,1:10,rand(10,10),5,1:5,"011"," ",[0,0,11,11]);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/contour2d.man
 
//====================================================
 
clear;lines(0);
 
contour2d(1:10,1:10,rand(10,10),5,1:5,"011"," ",[0,0,11,11]);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/driver.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/edit_curv.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/errbar.man
 
//====================================================
 
clear;lines(0);
 
x=0:0.1:2*%pi;
 
y=[sin(x);cos(x)]';x=[x;x]';plot2d(x,y);
 
errbar(x,y,0.05*ones(x),0.03*ones(x));
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/eval3d.man
 
//====================================================
 
clear;lines(0);
 
  x=-5:5;y=x;
 
  deff('[z]=f(x,y)',['z= x.*y']);
 
  z=eval3d(f,x,y);
 
  plot3d(x,y,z);
 
//
 
  deff('[z]=f(x,y)',['z= x*y']);
Warning :redefining function: f                       
 
 
  z=feval(x,y,f);
 
  plot3d(x,y,z);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/eval3dp.man
 
//====================================================
 
clear;lines(0);
 
  p1=linspace(0,2*%pi,10);
 
  p2=linspace(0,2*%pi,10);
 
  deff('[x,y,z]=scp(p1,p2)',['x=p1.*sin(p1).*cos(p2)';
                             'y=p1.*cos(p1).*cos(p2)';
                             'z=p1.*sin(p2)'])
 
  [x,y,z]=eval3dp(scp,p1,p2);
 
  plot3d(x,y,z)
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/evans.man
 
//====================================================
 
clear;lines(0);
 
H=syslin('c',352*poly(-5,'s')/poly([0,0,2000,200,25,1],'s','c'));
 
evans(H,100)
 
P=3.0548543 - 8.8491842*%i;    //P=selected point
 
k=-1/real(horner(H,P));
 
Ns=H('num');Ds=H('den');
 
roots(Ds+k*Ns)     //contains P as particular root
 ans  =
 
!   3.0548543 + 8.8491842i !
!   3.0548543 - 8.8491842i !
! - 6.8172416 + 4.2060205i !
! - 6.8172416 - 4.2060205i !
! - 17.475225              !
 
// Another one
 
xbasc();s=poly(0,'s');n=1+s;
 
d=real(poly([-1 -2 -%i %i],'s'));
 
evans(n,d,100);
 
//
 
xbasc();n=real(poly([0.1-%i 0.1+%i,-10],'s'));
 
evans(n,d,80);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/fac3d.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/fchamp.man
 
//====================================================
 
clear;lines(0);
 
 deff('[xdot] = derpol(t,x)',['xd1 = x(2)';
           "xd2 = -x(1) + (1 - x(1)**2)*x(2)";
           "xdot = [ xd1 ; xd2 ]"]);
 
 xf= -1:0.1:1;
 
 yf= -1:0.1:1;
 
 fchamp(derpol,0,xf,yf);
 
 xbasc();
 
 fchamp(derpol,0,xf,yf,1,[-2,-2,2,2],"011");
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/fcontour.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/fcontour2d.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/fec.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/fgrayplot.man
 
//====================================================
 
clear;lines(0);
 
deff('[z]=surf(x,y)','z=x**2+y**2');
 
fgrayplot(-1:0.1:1,-1:0.1:1,surf,"111",[-2,-2,2,2]);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/fplot2d.man
 
//====================================================
 
clear;lines(0);
 
deff("[y]=f(x)","y=sin(x)+cos(x)");
 
fplot2d((0:0.1:10)*%pi/10,f);
 
fplot2d((0:0.1:10)*%pi/10,f,5);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/fplot3d.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/fplot3d1.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/gainplot.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s')
 s  =
 
    s   
 
h=syslin('c',(s^2+2*0.9*10*s+100)/(s^2+2*0.3*10.1*s+102.01))
 h  =
 
                   2     
      100 + 18s + s      
    -----------------    
                      2  
    102.01 + 6.06s + s   
 
gainplot(h,0.01,100,'(s^2+2*0.9*10*s+100)/(s^2+2*0.3*10.1*s+102.01)')
 
xbasc()
 
h1=h*syslin('c',(s^2+2*0.1*15.1*s+228.01)/(s^2+2*0.9*15*s+225))
 h1  =
 
                               2        3   4    
     22801 + 4406.18s + 382.37s + 21.02s + s     
    -----------------------------------------    
                                 2        3   4  
    22952.25 + 4117.77s + 490.63s + 33.06s + s   
 
gainplot([h1;h],0.01,100,['h1';'h'])
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/genfac3d.man
 
//====================================================
 
clear;lines(0);
 
t = linspace(0,2*%pi,10);
 
zmat=sin(t')*cos(t);
 
plot3d(t,t,zmat)
 
[xx,yy,zz]=genfac3d(t,t,zmat);
 
plot3d(xx,yy,zz)
 
plot3d([xx xx],[yy yy],[zz 4+zz])
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/geom3d.man
 
//====================================================
 
clear;lines(0);
 
deff("[z]=surf(x,y)","z=sin(x)*cos(y)");
 
t=%pi*(-10:10)/10;
 
fplot3d(t,t,surf,35,45,"X@Y@Z");
 
    //Gives a plot3d
 
    //now  (t,t,sin(t).*cos(t) ) is a curve on the surface
 
    //which can be drawn using param3d or the following code
 
[x,y]=geom3d(t,t,sin(t).*cos(t));
 
xpoly(x,y,"lines")
 
    //adding a comment
 
[x,y]=geom3d([0,0],[0,0],[5,0]);
 
xsegs(x,y);
 
xstring(x(1),y(1)," The point (0,0,0)");
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/getcolor.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/getsymbol.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/gr_menu.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/graduate.man
 
//====================================================
 
clear;lines(0);
 
  y=(0:0.33:145.78)';
 
  xbasc();plot2d1('enn',0,y)
 
  [ymn,ymx,np]=graduate(mini(y),maxi(y))
 np  =
 
    3.  
 ymx  =
 
    150.  
 ymn  =
 
    0.  
 
  rect=[1,ymn,prod(size(y)),ymx];
 
  xbasc();plot2d1('enn',0,y,1,'011',' ',rect,[10,3,10,np])
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/graycolormap.man
 
//====================================================
 
clear;lines(0);
 
xset('colormap',graycolormap(32))
 
plot3d1()
 Demo of plot3d1
t=-%pi:0.3:%pi;plot3d1(t,t,sin(t)'*cos(t),35,45,'X@Y@Z',[2,2,4]);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/grayplot.man
 
//====================================================
 
clear;lines(0);
 
x=-10:10;y=-10:10;m=rand(21,21);
 
grayplot(x,y,m,"111",[-20,-20,20,20]);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/hist3d.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/histplot.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/hotcolormap.man
 
//====================================================
 
clear;lines(0);
 
xset('colormap',hotcolormap(32))
 
plot3d1()
 Demo of plot3d1
t=-%pi:0.3:%pi;plot3d1(t,t,sin(t)'*cos(t),35,45,'X@Y@Z',[2,2,4]);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/isoview.man
 
//====================================================
 
clear;lines(0);
 
xbasc();
 
t=(0:0.1:2*%pi)';
 
isoview(-1,1,-1,1);
 
plot2d(sin(t),cos(t),1,'001')
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/locate.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/m_circle.man
 
//====================================================
 
clear;lines(0);
 
//Example 1 :
 
  s=poly(0,'s')
 s  =
 
    s   
 
  h=syslin('c',(s^2+2*0.9*10*s+100)/(s^2+2*0.3*10.1*s+102.01))
 h  =
 
                   2     
      100 + 18s + s      
    -----------------    
                      2  
    102.01 + 6.06s + s   
 
  nyquist(h,0.01,100,'(s^2+2*0.9*10*s+100)/(s^2+2*0.3*10.1*s+102.01)')
 
  m_circle();
 
//Example 2:
 
  xbasc();
 
  h1=h*syslin('c',(s^2+2*0.1*15.1*s+228.01)/(s^2+2*0.9*15*s+225))
 h1  =
 
                               2        3   4    
     22801 + 4406.18s + 382.37s + 21.02s + s     
    -----------------------------------------    
                                 2        3   4  
    22952.25 + 4117.77s + 490.63s + 33.06s + s   
 
  nyquist([h1;h],0.01,100,['h1';'h'])
 
  m_circle([-8 -6 -4]);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/milk_drop.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/nyquist.man
 
//====================================================
 
clear;lines(0);
 
xbasc();
 
s=poly(0,'s');
 
h=syslin('c',(s^2+2*0.9*10*s+100)/(s^2+2*0.3*10.1*s+102.01));
 
comm='(s^2+2*0.9*10*s+100)/(s^2+2*0.3*10.1*s+102.01)';
 
nyquist(h,0.01,100,comm);
 
h1=h*syslin('c',(s^2+2*0.1*15.1*s+228.01)/(s^2+2*0.9*15*s+225))
 h1  =
 
                               2        3   4    
     22801 + 4406.18s + 382.37s + 21.02s + s     
    -----------------------------------------    
                                 2        3   4  
    22952.25 + 4117.77s + 490.63s + 33.06s + s   
 
xbasc();
 
nyquist([h1;h],0.01,100,['h1';'h'])
 
xbasc();nyquist([h1;h])
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/param3d.man
 
//====================================================
 
clear;lines(0);
 
t=0:0.1:5*%pi;
 
param3d(sin(t),cos(t),t/10,35,45,"X@Y@Z",[2,3])
 
xbasc();
 
xset("dashes",3)
 
param3d(rand(1,100),rand(1,100),rand(1,100),35,45,"X@Y@Z",[2,3])
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/param3d1.man
 
//====================================================
 
clear;lines(0);
 
t=0:0.1:5*%pi; t=t';
 
param3d1([sin(t),sin(2*t)],[cos(t),cos(2*t)],...
	list([t/10,sin(t)],[3,2]),35,45,"X@Y@Z",[2,3])
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/param3di.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/plot.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/plot2d.man
 
//====================================================
 
clear;lines(0);
 
x=0:0.1:2*%pi;
 
//simple plot
 
plot2d(sin(x));
 
//multiple plot
 
xbasc();
 
plot2d([x;x;x]',[sin(x);sin(2*x);sin(3*x)]');
 
//multiple plot with captions
 
xbasc();
 
plot2d([x;x;x]',[sin(x);sin(2*x);sin(3*x)]',...
[1,2,3],"111","L1@L2@L3",[0,-2,2*%pi,2],[2,10,2,10]);
 
// isoview
 
xbasc();
 
plot2d(x',sin(x)',1,'041')
 
// auto scale
 
xbasc();
 
plot2d(x',sin(x)',1,'061')
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/plot2d1.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/plot2d2.man
 
//====================================================
 
clear;lines(0);
 
plot2d2("gnn",(1:4)',(1:4)',1,'111','step function',[0,0,5,5])
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/plot2d3.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/plot2d4.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/plot3d.man
 
//====================================================
 
clear;lines(0);
 
plot3d(1:10,1:20,10*rand(10,20),35,45,"X@Y@Z",[2,2,3])
 
xbasc();
 
t=(0:0.3:2*%pi)';zmat=sin(t)*cos(t');
 
[xx,yy,zz]=genfac3d(t,t,zmat);
 
plot3d([xx xx],[yy yy],[zz 4+zz]);
 
xbasc();
 
plot3d([xx xx],[yy yy],list([zz zz+4],[4*ones(1,400) 5*ones(1,400)]))
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/plot3d1.man
 
//====================================================
 
clear;lines(0);
 
plot3d1(1:10,1:20,10*rand(10,20),35,45,"X@Y@Z",[2,2,3]);
 
xbasc();
 
plot3d1(1:10,1:20,10*rand(10,20),35,45,"X@Y@Z",[-2,2,3]);
 
xbasc();
 
t=(0:0.3:2*%pi)';zmat=sin(t)*cos(t');
 
[xx,yy,zz]=genfac3d(t,t,zmat);
 
plot3d1([xx xx],[yy yy],[zz 4+zz]);
 
xbasc();
 
plot3d1([xx xx],[yy yy],list([zz zz+4],[4*ones(1,400) 5*ones(1,400)]))
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/plotframe.man
 
//====================================================
 
clear;lines(0);
 
x=[-0.3:0.8:27.3]';
 
y=rand(x);
 
rect=[min(x),min(y),max(x),max(y)];
 
tics=[4,10,2,5];    //4 x-intervals and 2 y-intervals
 
plotframe(rect,tics,[%f,%f],['My plot','x','y'],[0,0,0.5,0.5]);
 
plot2d(x,y,2,'000')
 
plotframe(rect,tics,[%t,%f],['My plot with grids','x','y'],[0.5,0,0.5,0.5]);
 
plot2d(x,y,3,'000')
 
plotframe(rect,tics,[%t,%t],...
['My plot with grids and automatic bounds','x','y'],[0,0.5,0.5,0.5]);
 
plot2d(x,y,4,'000')
 
plotframe(rect,tics,[%f,%t],...
	['My plot without grids but with automatic bounds','x','y'],...
	[0.5,0.5,0.5,0.5]);
 
plot2d(x,y,5,'000');
 
xset('default');
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/plzr.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s');
 
n=[1+s   2+3*s+4*s^2        5; 0        1-s             s];
 
d=[1+3*s   5-s^3           s+1;1+s     1+s+s^2      3*s-1];
 
h=syslin('c',n./d);
 
plzr(h);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/printing.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/rotate.man
 
//====================================================
 
clear;lines(0);
 
xsetech([0,0,1,1],[-1,-1,1,1])
 
xy=[(0:0.1:10);sin(0:0.1:10)]/10;
 
for i=2*%pi*(0:10)/10,[xy1]=rotate(xy,i);
	xpoly(xy1(1,:),xy1(2,:),"lines")
end
 
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/scaling.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/sd2sci.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/secto3d.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/sgrid.man
 
//====================================================
 
clear;lines(0);
 
H=syslin('c',352*poly(-5,'s')/poly([0,0,2000,200,25,1],'s','c'));
 
evans(H,100)
 
sgrid()
 
sgrid(0.6,2,7)
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/square.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/titlepage.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/winsid.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xarc.man
 
//====================================================
 
clear;lines(0);
 
// isoview scaling
 
plot2d(0,0,-1,"031"," ",[-2,-2,2,2])
 
xset("dashes",3);
 
xarc(-1,1,2,2,0,90*64)
 
xarc(-1.5,1.5,3,3,0,360*64)
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xarcs.man
 
//====================================================
 
clear;lines(0);
 
plot2d(0,0,-1,"031",' ',[-1,-1,1,1])
 
set_arcs=[ -1.0 0.0 0.5 // upper left x
	    1.0 0.0 0.5 // upper left y
	    0.5 0.5 0.5 // widths
	    0.5 0.5 0.5 // height
	    0.0 0.0 0.0 // angle 1
	    360*64 360*64 360*64] // angle 2
 set_arcs  =
 
! - 1.        0.        0.5    !
!   1.        0.        0.5    !
!   0.5       0.5       0.5    !
!   0.5       0.5       0.5    !
!   0.        0.        0.     !
!   23040.    23040.    23040. !
 
xarcs(set_arcs,[1,2,3])
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xarrows.man
 
//====================================================
 
clear;lines(0);
 
x=2*%pi*(0:9)/8;
 
x1=[sin(x);9*sin(x)];
 
y1=[cos(x);9*cos(x)];
 
plot2d([-10,10],[-10,10],[-1,-1],"022");
 
xset('clipgrf')
 
xarrows(x1,y1,1,1:10);
 
xset('clipoff')
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xaxis.man
 
//====================================================
 
clear;lines(0);
 
plot2d((1:0.1:10),sin(1:0.1:10))
 
xaxis(-90,[2,5],[0.1,0.1,2],[8,0])
 
xaxis(0,[2,3],[0.5,0.1,2],[5,0])
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xbasc.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xbasimp.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xbasr.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xchange.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xclea.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xclear.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xclick.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xclip.man
 
//====================================================
 
clear;lines(0);
 
x=0:0.2:2*%pi;
 
x1=[sin(x);100*sin(x)];
 
y1=[cos(x);100*cos(x)];
 
y1=y1+20*ones(y1);
 
// No clip
 
plot2d([-100,500],[-100,600],[-1,-1],"022");
 
xsegs(10*x1+200*ones(x1),10*y1+200*ones(y1));
 
xbasc()
 
//
 
// Rect clip
 
xbasc();plot2d([-100,500],[-100,600],[-1,-1],"022");
 
xrect(150,460,100,150);
 
xclip(150,460,100,150);
 
xsegs(10*x1+200*ones(x1),10*y1+200*ones(y1));
 
//
 
// usual graphic rectangle clip
 
xbasc();plot2d([-100,500],[-100,600],[-1,-1],"022");
 
xclip("clipgrf");
 
xsegs(10*x1+200*ones(x1),10*y1+200*ones(y1));
 
// clipping off
 
xclip()
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xdel.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xend.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xfarc.man
 
//====================================================
 
clear;lines(0);
 
// isoview scaling
 
plot2d(0,0,-1,"031"," ",[-2,-2,2,2])
 
xfarc(-0.5,0.5,1,1,0,90*64)
 
xset("pattern",2)
 
xfarc(0.5,0.5,1,1,0,360*64)
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xfarcs.man
 
//====================================================
 
clear;lines(0);
 
plot2d(0,0,-1,"031",' ',[-1,-1,1,1])
 
set_arcs=[ -1.0 0.0 0.5 // upper left x
	    1.0 0.0 0.5 // upper left y
	    0.5 0.5 0.5 // widths
	    0.5 0.5 0.5 // height
	    0.0 0.0 0.0 // angle 1
	    360*64 360*64 360*64] // angle 2
 set_arcs  =
 
! - 1.        0.        0.5    !
!   1.        0.        0.5    !
!   0.5       0.5       0.5    !
!   0.5       0.5       0.5    !
!   0.        0.        0.     !
!   23040.    23040.    23040. !
 
xfarcs(set_arcs,[1,2,3])
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xfpoly.man
 
//====================================================
 
clear;lines(0);
 
x=sin(2*%pi*(0:5)/5);
 
y=cos(2*%pi*(0:5)/5);
 
plot2d(0,0,-1,"010"," ",[-2,-2,2,2])
 
xset("pattern",5);
 
xfpoly(x,y)
 
xset("default");
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xfpolys.man
 
//====================================================
 
clear;lines(0);
 
plot2d(0,0,[-1],"012"," ",[0,-10,210,40]);
 
x1=[0,10,20,30,20,10,0];
 
y1=[15,30,30,15,0,0,15];
 
xpols=[x1;x1;x1;x1]';xpols=xpols + [0,60,120,180].*.ones(x1)';
 
ypols=[y1;y1;y1;y1]';
 
lpat=xget("lastpattern");
 
// setting the current dash (or line color)
 
xset("dashes",5);
 
xfpolys(xpols,ypols,[-1,0,1,2]);
 
xset("default");
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xfrect.man
 
//====================================================
 
clear;lines(0);
 
plot2d(0,0,-1,"010"," ",[-2,-2,2,2])
 
xset("pattern",5);
 
xfrect(-1,1,2,2)
 
xset("default");
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xget.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xgetech.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xgetmouse.man
 
//====================================================
 
clear;lines(0);
 
xselect();xbasc(); xsetech([0 0 1 1],[0 0 100 100])
 
xset('alufunction',6)
 
xtitle(' drawing a rectangle ');
 
[b,x0,y0]=xclick();rep=[x0,y0,-1];x=x0;y=y0
 y  =
 
    92.775665  
 
xrect(x0,y0,x-x0,y-y0);
 
while rep(3)==-1 then
    rep=xgetmouse(0);
    xrect(x0,y0,x-x0,y0-y);
    x=rep(1);y=rep(2);
    xrect(x0,y0,x-x0,y0-y);
end
 
xset('alufunction',3)
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xgrid.man
 
//====================================================
 
clear;lines(0);
 
plot2d()
 Demo of plot2d
  x=0:0.1:2*%pi,  plot2d([x;x;x]',[sin(x);sin(2*x);sin(3*x)]',[-1,-2,3],'151','L1@L2@L3',[0,-2,2*%pi,2]);
 
xgrid()
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xinfo.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xinit.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xlfont.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xload.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xnumb.man
 
//====================================================
 
clear;lines(0);
 
plot2d([-100,500],[-100,600],[-1,-1],"022");
 
x=0:100:200;
 
xnumb(x,500*ones(x),[10,20,35],1);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xpause.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xpoly.man
 
//====================================================
 
clear;lines(0);
 
x=sin(2*%pi*(0:5)/5);
 
y=cos(2*%pi*(0:5)/5);
 
plot2d(0,0,-1,"010"," ",[-2,-2,2,2])
 
xset("dashes",5);
 
xpoly(x,y,"lines",1);
 
xset("default");
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xpolys.man
 
//====================================================
 
clear;lines(0);
 
plot2d(0,0,[-1],"012"," ",[0,0,1,1]);
 
rand('uniform');
 
xset('pattern',3)
 
xpolys(rand(3,5),rand(3,5),[-1,-2,0,1,2])
 
xset('default')
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xrect.man
 
//====================================================
 
clear;lines(0);
 
plot2d(0,0,-1,"010"," ",[-2,-2,2,2])
 
xset("pattern",5);
 
xrect(-1,1,2,2)
 
xset("default");
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xrects.man
 
//====================================================
 
clear;lines(0);
 
plot2d([-100,500],[-50,50],[-1,-1],"022");
 
cols=[-34,-33,-32,-20:5:20,32,33,34];
 
step=20;
 
x=400*(0:14)/14
 x  =
 
 
         column 1 to 5
 
!   0.    28.571429    57.142857    85.714286    114.28571 !
 
         column  6 to 10
 
!   142.85714    171.42857    200.    228.57143    257.14286 !
 
         column 11 to 15
 
!   285.71429    314.28571    342.85714    371.42857    400. !
 
step = (x(2)-x(1))/2
 step  =
 
    14.285714  
 
rects=[x;10*ones(x);step*ones(x);30*ones(x)];
 
xrects(rects,cols);
 
xnumb(x,15*ones(x),cols);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xrpoly.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xs2fig.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xsave.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xsegs.man
 
//====================================================
 
clear;lines(0);
 
x=2*%pi*(0:9)/8;
 
x1=[sin(x);9*sin(x)];
 
y1=[cos(x);9*cos(x)];
 
plot2d([-10,10],[-10,10],[-1,-1],"022");
 
xset('clipgrf')
 
xsegs(x1,y1,1:10);
 
xset('clipoff')
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xselect.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xset.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xsetech.man
 
//====================================================
 
clear;lines(0);
 
//In this first example xsetech is used to split the graphic window
 
//in two parts
 
 
// xsetech is used to fix the first sub window
 
// and the graphic scale
 
xsetech([0,0,1.0,0.5],[-5,-3,5,3]);
 
// then we call plot2d with the "001" option to use the graphic scale
 
// set by xsetech
 
plot2d((1:10)',(1:10)',1,"001",' ');
 
// xsetech is used to fix the second sub window
 
xsetech([0,0.5,1.0,0.5]);
 
// the graphic scale is set by xsetech to [0,0,1,1] by default
 
// and we change it with the use of the rect argument in plot2d
 
plot2d((1:10)',(1:10)',1,"011",' ',[-6,-6,6,6]);
 
 
//A second example with four graphics on a single graphic window
 
 
xset("font',2,0);
 
xsetech([0,0,0.5,0.5]);plot3d();
 Demo of plot3d
t=-%pi:0.3:%pi;plot3d(t,t,sin(t)'*cos(t),35,45,'X@Y@Z',[2,2,4]);
 
xsetech([0.5,0,0.5,0.5]);plot2d();
 Demo of plot2d
  x=0:0.1:2*%pi,  plot2d([x;x;x]',[sin(x);sin(2*x);sin(3*x)]',[-1,-2,3],'151','L1@L2@L3',[0,-2,2*%pi,2]);
 
xsetech([0.5,0.5,0.5,0.5]);grayplot();
 Demo of grayplot
t=-%pi:0.1:%pi;m=sin(t)'*cos(t);grayplot(t,t,m);
 
xsetech([0,0.5,0.5,0.5]);histplot();
rand('normal');
histplot([-6:0.2:6],rand(1,2000),[1,-1],'011',' ',[-6,0,6,0.5],[2,12,2,11]);
deff('[y]=f(x)','y=exp(-x.*x/2)/sqrt(2*%pi);');
x=-6:0.1:6;x=x';plot2d(x,f(x),1,"000");
titre= 'macro histplot : Histogram plot';
xtitle(titre,'Classes','N(C)/Nmax');
 
// back to default values for the sub window
 
xsetech([0,0,1,1]);
 
xset("default');
 
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xstring.man
 
//====================================================
 
clear;lines(0);
 
plot2d([0,1],[0,1])
 
xstring(0.5,0.5,["Scilab","is" ; "Not","Basilc"])
 
//Other example
 
alphabet=['a ','b ','c ','d ','e ','f ','g ',...
          'h ','i ','j ','k ','l ','m ','n ',...
          'o ','p ','q ','r ','s ','t ','u ',...
          'v ', 'w ','x ','y ','z '];
 
 
xset('default');              //default graphic parameters
 
xset("window",1);             //set window number to 1
 
xclear();
 
plot2d([0,1],[0,2])
 
xstring(0.1,1.8,alphabet)     //alphabet
 
xstring(0.1,1.6,alphabet,20)  //angle
 
xset("font",1,1)              //symbol fonts
 
xstring(0.1,0.1,alphabet)
 
xset('font',1,3)              //change size font
 
xstring(0.1,0.3,alphabet)
 
xset('font',1,24);xstring(0.1,0.6,'a');  //big alpha
 
xset('default')
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xstringb.man
 
//====================================================
 
clear;lines(0);
 
mat=['Scilab','is';'not','balicS'];
 
plot2d(0,0,[-1,1],'010',' ',[0,0,1,1]);
 
r=[0,0,1,0.5];
 
xstringb(r(1),r(2),mat,r(3),r(4),'fill');
 
xrect(r(1),r(2)+r(4),r(3),r(4))
 
r=[r(1),r(2)+r(4)+0.01,r(3),r(4)/2];
 
xrect(r(1),r(2)+r(4),r(3),r(4))
 
xstringb(r(1),r(2),mat,r(3),r(4),'fill');
 
r=[r(1),r(2)+r(4)+0.01,r(3),r(4)/2];
 
xrect(r(1),r(2)+r(4),r(3),r(4))
 
xstringb(r(1),r(2),mat,r(3),r(4),'fill');
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xstringl.man
 
//====================================================
 
clear;lines(0);
 
plot2d([0;1],[0;1])
 
rect=xstringl(0.5,0.5,["Scilab","is" ; "not","balicS"])
 rect  =
 
!   0.5    0.6254753    0.1331828    0.1254753 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xtape.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/xtitle.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/graphics/zgrid.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/aff2ab.man
 
//====================================================
 
clear;lines(0);
 
// Lyapunov equation solver (one unknown variable, one constraint)
 
deff('Y=lyapunov(X,D)','[A,Q]=D(:);Xm=X(:); Y=list(A''*Xm+Xm*A-Q)')
 
A=rand(3,3);Q=rand(3,3);Q=Q+Q';D=list(A,Q);dimX=[3,3];
 
[Aly,bly]=aff2ab(lyapunov,dimX,D);
 
[Xl,kerA]=linsolve(Aly,bly); Xv=vec2list(Xl,dimX); lyapunov(Xv,D)
 ans  =
 
 
       ans(1)
 
   1.0D-14 *
 
! - 0.1332268    0.7105427    0.1110223 !
! - 0.5329071    0.6494805    0.2886580 !
! - 0.5107026    0.1110223    0.6217249 !
 
Xm=Xv(:); A'*Xm+Xm*A-Q
 ans  =
 
   1.0D-14 *
 
! - 0.1332268    0.7105427    0.1110223 !
! - 0.5329071    0.6494805    0.2886580 !
! - 0.5107026    0.1110223    0.6217249 !
 
 
// Lyapunov equation solver with redundant constraint X=X'
 
// (one variable, two constraints) D is global variable
 
deff('Y=ly2(X,D)','[A,Q]=D(:);Xm=X(:); Y=list(A''*Xm+Xm*A-Q,Xm''-Xm)')
 
A=rand(3,3);Q=rand(3,3);Q=Q+Q';D=list(A,Q);dimX=[3,3];
 
[Aly,bly]=aff2ab(ly2,dimX,D);
 
[Xl,kerA]=linsolve(Aly,bly); Xv=vec2list(Xl,dimX); ly2(Xv,D)
 ans  =
 
 
       ans(1)
 
!   0.           2.220D-16    1.721D-15 !
! - 4.108D-15    2.220D-15  - 1.554D-15 !
!   5.718D-15    4.441D-16  - 2.220D-15 !
 
       ans(2)
 
!   0.           7.772D-16  - 2.220D-15 !
! - 7.772D-16    0.         - 2.220D-16 !
!   2.220D-15    2.220D-16    0.        !
 
 
// Francis equations
 
// Find matrices X1 and X2 such that:
 
// A1*X1 - X1*A2 + B*X2 -A3 = 0
 
// D1*X1 -D2 = 0
 
deff('Y=bruce(X,D)','[A1,A2,A3,B,D1,D2]=D(:),...
[X1,X2]=X(:);Y=list(A1*X1-X1*A2+B*X2-A3,D1*X1-D2)')
 
A1=[-4,10;-1,2];A3=[1;2];B=[0;1];A2=1;D1=[0,1];D2=1;
 
D=list(A1,A2,A3,B,D1,D2);
 
[n1,m1]=size(A1);[n2,m2]=size(A2);[n3,m3]=size(B);
 
dimX=[[m1,n2];[m3,m2]];
 
[Af,bf]=aff2ab(bruce,dimX,D);
 
[Xf,KerAf]=linsolve(Af,bf);Xsol=vec2list(Xf,dimX)
 Xsol  =
 
 
       Xsol(1)
 
!   1.8 !
!   1.  !
 
       Xsol(2)
 
    2.8  
 
bruce(Xsol,D)
 ans  =
 
 
       ans(1)
 
   1.0D-14 *
 
!   0.4884981 !
!   0.0888178 !
 
       ans(2)
 
    2.220D-16  
 
 
// Find all X which commute with A
 
deff('y=f(X,D)','y=list(D(:)*X(:)-X(:)*D(:))')
 
A=rand(3,3);dimX=[3,3];[Af,bf]=aff2ab(f,dimX,list(A));
 
[Xf,KerAf]=linsolve(Af,bf);[p,q]=size(KerAf);
 
Xsol=vec2list(Xf+KerAf*rand(q,1),dimX);
 
C=Xsol(:); A*C-C*A
 ans  =
 
   1.0D-15 *
 
!   0.0832667  - 0.4718448  - 0.5551115 !
! - 0.0832667    0.         - 0.4718448 !
! - 0.2706169    0.4996004    0.        !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/balanc.man
 
//====================================================
 
clear;lines(0);
 
A=[1/2^10,1/2^10;2^10,2^10];
 
[Ab,X]=balanc(A);
 
norm(A(1,:))/norm(A(2,:))
 ans  =
 
    9.537D-07  
 
norm(Ab(1,:))/norm(Ab(2,:))
 ans  =
 
    0.0009766  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/bdiag.man
 
//====================================================
 
clear;lines(0);
 
//Real case: 1x1 and 2x2 blocks
 
a=rand(5,5);[ab,x,bs]=bdiag(a);ab
 ab  =
 
! - 2.0647129    0.           0.           0.           0.        !
!   0.           0.8612246  - 1.6240914    0.           0.        !
!   0.           0.6178420    0.8143068    0.           0.        !
!   0.           0.           0.         - 0.7982008    0.        !
!   0.           0.           0.           0.           0.5667441 !
 
//Complex case: complex 1x1 blocks
 
[ab,x,bs]=bdiag(a+%i*0);ab
 ab  =
 
 
         column 1 to 2
 
! - 2.0647129 + 8.403D-18i    0                      !
!   0                       - 0.7982008 + 8.798D-16i !
!   0                         0                      !
!   0                         0                      !
!   0                         0                      !
 
         column 3 to 4
 
!   0                         0                      !
!   0                         0                      !
!   0.8377657 + 1.0014397i    0                      !
!   0                         0.8377657 - 1.0014397i !
!   0                         0                      !
 
         column 5
 
!   0                      !
!   0                      !
!   0                      !
!   0                      !
!   0.5667441 + 1.135D-16i !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/chol.man
 
//====================================================
 
clear;lines(0);
 
W=rand(5,5)+%i*rand(5,5);
 
X=W*W';
 
R=chol(X);
 
norm(R'*R-X)
 ans  =
 
    1.281D-15  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/coff.man
 
//====================================================
 
clear;lines(0);
 
M=[1,2;0,3];
 
[N,d]=coff(M)
 d  =
 
              2  
    3 - 4s + s   
 N  =
 
! - 3 + s     2      !
!                    !
!   0       - 1 + s  !
 
N/d
 ans  =
 
!     1           2       !
!   -----     ---------   !
!                       2 !
! - 1 + s     3 - 4s + s  !
!                         !
!   0           1         !
!   -         -----       !
!   1       - 3 + s       !
 
inv(%s*eye-M)
 ans  =
 
!     1           2       !
!   -----     ---------   !
!                       2 !
! - 1 + s     3 - 4s + s  !
!                         !
!   0           1         !
!   -         -----       !
!   1       - 3 + s       !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/colcomp.man
 
//====================================================
 
clear;lines(0);
 
A=rand(5,2)*rand(2,5);
 
[X,r]=colcomp(A);
 
norm(A*X(:,1:$-r),1)
 ans  =
 
    1.082D-15  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/companion.man
 
//====================================================
 
clear;lines(0);
 
s=poly(0,'s');
 
p=poly([1,2,3,4,1],'s','c')
 p  =
 
               2    3   4  
    1 + 2s + 3s + 4s + s   
 
det(s*eye-companion(p))
 ans  =
 
               2    3   4  
    1 + 2s + 3s + 4s + s   
 
roots(p)
 ans  =
 
! - 0.0467994 + 0.6765268i !
! - 0.0467994 - 0.6765268i !
! - 0.6723782              !
! - 3.2340229              !
 
spec(companion(p))
 ans  =
 
! - 3.2340229              !
! - 0.6723782              !
! - 0.0467994 + 0.6765268i !
! - 0.0467994 - 0.6765268i !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/cond.man
 
//====================================================
 
clear;lines(0);
 
A=matrix('hilb',6);
 
cond(A)
 ans  =
 
    14951059.  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/det.man
 
//====================================================
 
clear;lines(0);
 
x=poly(0,'x');
 
det([x,1+x;2-x,x^2])
 ans  =
 
             2   3  
  - 2 - x + x + x   
 
w=ssrand(2,2,4);roots(det(systmat(w))),trzeros(w)   //zeros of linear system
 ans  =
 
!   2.0469329 !
! - 13.051667 !
 ans  =
 
! - 13.051667 !
!   2.0469329 !
 
A=rand(3,3);
 
det(A), prod(spec(A))
 ans  =
 
    0.2167306  
 ans  =
 
    0.2167306  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/ereduc.man
 
//====================================================
 
clear;lines(0);
 
X=[1 2 3;4 5 6]
 X  =
 
!   1.    2.    3. !
!   4.    5.    6. !
 
[E,Q,Z ,stair ,rk]=ereduc(X,1.d-15)
 rk  =
 
    2.  
 stair  =
 
!   2.    3. !
 Z  =
 
!   0.4082483    0.7909116    0.4558423 !
! - 0.8164966    0.0930484    0.5698029 !
!   0.4082483  - 0.6048147    0.6837635 !
 Q  =
 
!   1.    0. !
!   0.    1. !
 E  =
 
!   0.  - 0.8374358    3.6467384 !
!   0.    0.           8.7749644 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/exp.man
 
//====================================================
 
clear;lines(0);
 
x=[1,2,3+%i];
 
log(exp(x))  //element-wise
 ans  =
 
!   1.    2.    3. + i   !
 
2^x
 ans  =
 
!   2.    4.    6.1539112 + 5.1116902i !
 
exp(x*log(2))
 ans  =
 
!   2.    4.    6.1539112 + 5.1116902i !
 
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/expm.man
 
//====================================================
 
clear;lines(0);
 
X=[1 2;3 4]
 X  =
 
!   1.    2. !
!   3.    4. !
 
expm(X)
 ans  =
 
!   51.968956    74.736565 !
!   112.10485    164.0738  !
 
logm(expm(X))
 ans  =
 
!   1.    2. !
!   3.    4. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/fstair.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/fullrf.man
 
//====================================================
 
clear;lines(0);
 
A=rand(5,2)*rand(2,5);
 
[Q,M]=fullrf(A);
 
norm(Q*M-A,1)
 ans  =
 
    1.610D-15  
 
[X,d]=rowcomp(A);Y=X';
 
svd([A,Y(:,1:d),Q])        //span(Q) = span(A) = span(Y(:,1:2))
 ans  =
 
!   2.6654304 !
!   1.2368848 !
!   0.        !
!   0.        !
!   0.        !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/fullrfk.man
 
//====================================================
 
clear;lines(0);
 
A=rand(5,2)*rand(2,5);[Bk,Ck]=fullrfk(A,3);
 
norm(Bk*Ck-A^3,1)
 ans  =
 
    1.843D-14  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/givens.man
 
//====================================================
 
clear;lines(0);
 
A=[3,4;5,6];
 
U=givens(A(:,1));
 
U*A
 ans  =
 
!   5.8309519    7.2029406 !
!   0.         - 0.3429972 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/glever.man
 
//====================================================
 
clear;lines(0);
 
s=%s;F=[-1,s,0,0;0,-1,0,0;0,0,s-2,0;0,0,0,s-1];
 
[Bfs,Bis,chis]=glever(F)
    rank A^k    rcond
        3.      0.000E+00
        2.      0.515E+00
 chis  =
 
              2  
    2 - 3s + s   
 Bis  =
 
!   1     s     0    0 !
!                      !
!   0     1     0    0 !
!                      !
!   0     0     0    0 !
!                      !
!   0     0     0    0 !
 Bfs  =
 
!   0    0    0         0      !
!                              !
!   0    0    0         0      !
!                              !
!   0    0  - 1 + s     0      !
!                              !
!   0    0    0       - 2 + s  !
 
inv(F)-((Bfs/chis) - Bis)
    rank A^k    rcond
        3.      0.000E+00
        2.      0.515E+00
 ans  =
 
!   0     0     0     0  !
!   -     -     -     -  !
!   1     1     1     1  !
!                        !
!   0     0     0     0  !
!   -     -     -     -  !
!   1     1     1     1  !
!                        !
!   0     0     0     0  !
!   -     -     -     -  !
!   1     1     1     1  !
!                        !
!   0     0     0     0  !
!   -     -     -     -  !
!   1     1     1     1  !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/gschur.man
 
//====================================================
 
clear;lines(0);
 
s=%s;
 
F=[-1,s,0,0;0,-1,0,0;0,0,2+s,0;0,0,0,-2+s];
 
roots(det(F))
 ans  =
 
!   2. !
! - 2. !
 
[E,A]=pen2ea(F);
 
[As,Es,Z,dim] = gschur(A,E,'c')
 dim  =
 
    1.  
 Z  =
 
!   0.    1.    0.    0. !
!   0.    0.    1.    0. !
!   1.    0.    0.    0. !
!   0.    0.    0.    1. !
 Es  =
 
!   1.    0.    0.    0. !
!   0.    0.  - 1.    0. !
!   0.    0.    0.    0. !
!   0.    0.    0.    1. !
 As  =
 
! - 2.    0.    0.    0. !
!   0.  - 1.    0.    0. !
!   0.    0.  - 1.    0. !
!   0.    0.    0.    2. !
 
// Other example
 
a=rand(4,4);b=rand(4,4);[as,bs,qs,zs]=gschur(a,b);
 
norm(qs*a*zs-as)
 ans  =
 
    1.098D-15  
 
norm(qs*b*zs-bs )
 ans  =
 
    1.646D-15  
 
clear a;
 
a(8,8)=2;a(1,8)=1;a(2,[2,3,4,5])=[0.3,0.2,4,6];a(3,[2,3])=[-0.2,.3];
 
a(3,7)=.5;
 
a(4,4)=.5;a(4,6)=2;a(5,5)=1;a(6,6)=4;a(6,7)=2.5;a(7,6)=-10;a(7,7)=4;
 
b=eye(8,8);b(5,5)=0;
 
[al,be]=gspec(a,b);
 
[bs,as,q,n]=gschur(b,a,'disc');n-4
 ans  =
 
    0.  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/gspec.man
 
//====================================================
 
clear;lines(0);
 
A=rand(3,3);
 
[al,be,Z] = gspec(A,eye(A));al./be
 ans  =
 
!   1.2400762 !
! - 0.6249983 !
! - 0.0213822 !
 
clean(inv(Z)*A*Z)  //displaying the eigenvalues (generic matrix)
 ans  =
 
!   1.2400762    0            0         !
!   0          - 0.6249983    0         !
!   0            0          - 0.0213822 !
 
A=A+%i*rand(A);E=rand(A);
 
roots(det(%s*E-A))   //complex case
 ans  =
 
!   8.3057915 + 27.673484i !
!   0.5757004 + 0.8521012i !
!   0.0585681 - 0.1387534i !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/hess.man
 
//====================================================
 
clear;lines(0);
 
A=rand(3,3);[U,H]=hess(A);
 
and( abs(U*H*U'-A)<1.d-10 )
 ans  =
 
  T  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/householder.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/im_inv.man
 
//====================================================
 
clear;lines(0);
 
A=[rand(2,5);[zeros(3,4),rand(3,1)]];B=[[1,1;1,1];zeros(3,2)];
 
W=rand(5,5);A=W*A;B=W*B;
 
[X,dim]=im_inv(A,B)
 dim  =
 
    3.  
 X  =
 
!   0.0130258  - 0.7602382    0.6075043    0.2295483    0.0106927 !
!   0.2550803    0.5220884    0.7589927  - 0.2934296  - 0.0136684 !
! - 0.9328194    0.0270603    0.1729958  - 0.3146005  - 0.0146546 !
!   0.2541897  - 0.3856544  - 0.1579272  - 0.8718188  - 0.0406108 !
!   0.           0.           0.         - 0.0465312    0.9989168 !
 
svd([A*X(:,1:dim),B])   //vectors A*X(:,1:dim) belong to range(B)
 ans  =
 
!   4.8120217 !
!   0.        !
!   0.        !
!   0.        !
!   0.        !
 
[X,dim,Y]=im_inv(A,B);[Y*A*X,Y*B]
 ans  =
 
 
         column 1 to 5
 
!   0.0687749    0.0941699  - 2.1423381    2.1472115  - 3.6895105 !
!   0.           0.           0.           0.0352312  - 0.4610362 !
!   0.           0.           0.         - 0.0631391    1.3266806 !
!   0.           0.           0.         - 0.0480391  - 0.6757264 !
!   0.           0.           0.           0.1789512    0.3774603 !
 
         column 6 to 7
 
! - 3.0456807  - 3.0456807 !
!   0.           0.        !
!   0.           0.        !
!   0.           0.        !
!   0.           0.        !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/inv.man
 
//====================================================
 
clear;lines(0);
 
A=rand(3,3);inv(A)*A
 ans  =
 
!   1.    0.    0. !
!   0.    1.    0. !
!   0.    0.    1. !
 
//
 
x=poly(0,'x');
 
A=[x,1,x;x^2,2,1+x;1,2,3];inv(A)*A
 ans  =
 
!   1                    0     0  !
!   -                    -     -  !
!   1                    1     1  !
!                                 !
!                3                !
!      3.331D-16x        1     0  !
!   ----------------     -     -  !
!              2    3             !
!   1 + 3x - 5x + 2x     1     1  !
!                                 !
!   0                    0     1  !
!   -                    -     -  !
!   1                    1     1  !
 
//
 
A=[1/x,2;2+x,2/(1+x)]
 A  =
 
!   1         2      !
!   -         -      !
!   x         1      !
!                    !
!   2 + x       2    !
!   -----     -----  !
!     1       1 + x  !
 
inv(A)*A
 ans  =
 
!   1     0  !
!   -     -  !
!   1     1  !
!            !
!   0     1  !
!   -     -  !
!   1     1  !
 
//
 
A=ssrand(2,2,3);
 
W=inv(A)*A
 W  =
 
 
       W(1)   (state-space system:)
 
!lss  A  B  C  D  X0  dt  !
 
       W(2) = A matrix = 
 
! - 1.4236082    2.7004465    3.4055241    2.1623844 !
!   0.         - 0.7616491    0.7223316  - 0.6834217 !
!   0.           1.4739762    0.6380837    0.8145126 !
!   0.           0.8529775    0.2546697  - 0.1884803 !
 
       W(3) = B matrix = 
 
!   0.           0.        !
! - 1.0327357  - 1.7086774 !
! - 0.9239258    0.0698768 !
!   2.7266682  - 1.3772844 !
 
       W(4) = C matrix = 
 
! - 0.1598734  - 0.0483778    0.2719123    0.0738137 !
! - 0.2910098  - 0.0880597    0.4949488    0.1343594 !
 
       W(5) = D matrix = 
 
!   1.    0. !
!   0.    1. !
 
       W(6) = X0 (initial state) = 
 
!   0. !
!   0. !
!   0. !
!   0. !
 
       W(7) = Time domain = 
 
 c   
 
clean(ss2tf(W))
 ans  =
 
!   1     0  !
!   -     -  !
!   1     1  !
!            !
!   0     1  !
!   -     -  !
!   1     1  !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/kernel.man
 
//====================================================
 
clear;lines(0);
 
A=rand(3,1)*rand(1,3);
 
A*kernel(A)
 ans  =
 
   1.0D-17 *
 
!   0.6938894    2.7755576 !
!   2.7755576    0.        !
!   0.0013553    0.0013553 !
 
A=sparse(A);
 
clean(A*kernel(A))
 ans  =
 
(    3,    2) zero sparse matrix
 
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/kroneck.man
 
//====================================================
 
clear;lines(0);
 
F=randpencil([1,1,2],[2,3],[-1,3,1],[0,3]);
 
Q=rand(17,17);Z=rand(18,18);F=Q*F*Z;
 
//random pencil with eps1=1,eps2=1,eps3=1; 2 J-blocks @ infty
 
//with dimensions 2 and 3
 
//3 finite eigenvalues at -1,3,1 and eta1=0,eta2=3
 
[Q,Z,Qd,Zd,numbeps,numbeta]=kroneck(F);
 
[Qd(1),Zd(1)]    //eps. part is sum(epsi) x (sum(epsi) + number of epsi)
 ans  =
 
!   4.    7. !
 
[Qd(2),Zd(2)]    //infinity part
 ans  =
 
!   5.    5. !
 
[Qd(3),Zd(3)]    //finite part
 ans  =
 
!   3.    3. !
 
[Qd(4),Zd(4)]    //eta part is (sum(etai) + number(eta1)) x sum(etai)
 ans  =
 
!   5.    3. !
 
numbeps
 numbeps  =
 
!   0.    2.    1. !
 
numbeta
 numbeta  =
 
!   1.    0.    0.    1. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/linsolve.man
 
//====================================================
 
clear;lines(0);
 
A=rand(5,3)*rand(3,8);
 
b=A*ones(8,1);[x,kerA]=linsolve(A,b);A*x+b   //compatible b
 ans  =
 
   1.0D-15 *
 
!   0.8881784 !
!   0.8881784 !
!   0.4440892 !
!   0.8881784 !
!   0.8881784 !
 
b=ones(5,1);[x,kerA]=linsolve(A,b);A*x+b   //uncompatible b
WARNING:Conflicting linear constraints!
 ans  =
 
!   1. !
!   1. !
!   1. !
!   1. !
!   1. !
 
A=rand(5,5);[x,kerA]=linsolve(A,b), -inv(A)*b  //x is unique
 kerA  =
 
     []
 x  =
 
! - 0.4812398 !
! - 2.3608041 !
!   2.0678092 !
! - 1.5973204 !
!   0.4153698 !
 ans  =
 
! - 0.4812398 !
! - 2.3608041 !
!   2.0678092 !
! - 1.5973204 !
!   0.4153698 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/lu.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/ludel.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/lufact.man
 
//====================================================
 
clear;lines(0);
 
a=rand(5,5);b=rand(5,1);A=sparse(a);
 
[h,rk]=lufact(A);
 
x=lusolve(h,b);a*x-b
 ans  =
 
!   0.        !
!   1.110D-16 !
!   0.        !
!   0.        !
!   0.        !
 
ludel(h)
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/luget.man
 
//====================================================
 
clear;lines(0);
 
a=rand(5,2)*rand(2,5);A=sparse(a);
 
[ptr,rk]=lufact(A);[P,L,U,Q]=luget(ptr);
 
full(L), P*L*U*Q-A
 ans  =
 
!   0.3789137    0.           0.           0.    0. !
!   0.4041246    0.0293409    0.           0.    0. !
!   0.8710841  - 0.0373239  - 3.816D-16    0.    0. !
!   0.4664213    0.1193801    4.996D-16    0.    0. !
!   0.2811230  - 0.0084457    0.           0.    0. !
 ans  =
 
(    5,    5) sparse matrix
 
   1.0D-15 *
 
(    1,    2)        0.0277556 
(    1,    3)        0.0555112 
(    4,    5)      - 0.2220446 
 
clean(P*L*U*Q-A)
 ans  =
 
(    5,    5) zero sparse matrix
 
 
ludel(ptr)
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/lusolve.man
 
//====================================================
 
clear;lines(0);
 
non_zeros=[1,2,3,4];rows_cols=[1,1;2,2;3,3;4,4];
 
sp=sparse(rows_cols,non_zeros);
 
[h,rk]=lufact(sp);x=lusolve(h,[1;1;1;1]);ludel(h)
 
rk,sp*x
 rk  =
 
    4.  
 ans  =
 
!   1. !
!   1. !
!   1. !
!   1. !
 
 
 
non_zeros=[1,2,3,4];rows_cols=[1,1;2,2;3,3;4,4];
 
sp=sparse(rows_cols,non_zeros);
 
x=lusolve(sp,-ones(4,1));
 
sp*x
 ans  =
 
! - 1. !
! - 1. !
! - 1. !
! - 1. !
 
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/lyap.man
 
//====================================================
 
clear;lines(0);
 
A=rand(4,4);C=rand(A);C=C+C';
 
X=lyap(A,C,'c');
 
A'*X + X*A -C
 ans  =
 
   1.0D-14 *
 
! - 0.2831069  - 0.0888178  - 0.2220446    0.1332268 !
! - 0.0888178    0.1332268    0.1554312  - 0.1332268 !
! - 0.2220446    0.1554312    0.         - 0.1332268 !
!   0.1332268  - 0.1332268  - 0.1332268    0.        !
 
X=lyap(A,C,'d');
 
A'*X*A - X -C
 ans  =
 
   1.0D-14 *
 
! - 0.1554312    0.0888178  - 0.0666134  - 0.0222045 !
!   0.0444089    0.         - 0.0222045  - 0.0999201 !
! - 0.0666134  - 0.0444089  - 0.1110223  - 0.2220446 !
! - 0.0444089  - 0.0999201  - 0.2220446    0.1443290 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/nlev.man
 
//====================================================
 
clear;lines(0);
 
A=rand(3,3);x=poly(0,'x');
 
[NUM,den]=nlev(A,'x')
 den  =
 
                                       2   3  
    0.1861868 + 0.8620201x + 0.9809488x - x   
 NUM  =
 
 
         column 1
 
!                             2 !
!   0.2786022 + 0.7468865x - x  !
!                               !
! - 0.2585293 - 0.6619341x      !
!                               !
!   0.0068661 - 0.2691180x      !
 
         column 2
 
!                                      2 !
! - 0.1085447 - 0.9830249x - 1.110D-16x  !
!                                        !
!                             2          !
!   0.1057707 + 0.2416137x - x           !
!                                        !
! - 0.1966216 - 0.2902136x               !
 
         column 3
 
! - 0.6671707 - 0.3995950x      !
!                               !
! - 0.0353052 - 0.9792278x      !
!                               !
!                             2 !
!   0.4776472 + 0.9733975x - x  !
 
clean(den-poly(A,'x'))
 ans  =
 
                                       2    3  
    0.3723735 + 1.7240403x + 1.9618977x - 2x   
 
clean(NUM/den-inv(x*eye-A))
 ans  =
 
!   0     0     0  !
!   -     -     -  !
!   1     1     1  !
!                  !
!   0     0     0  !
!   -     -     -  !
!   1     1     1  !
!                  !
!   0     0     0  !
!   -     -     -  !
!   1     1     1  !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/orth.man
 
//====================================================
 
clear;lines(0);
 
A=rand(5,3)*rand(3,4);
 
[X,dim]=rowcomp(A);X=X';
 
svd([orth(A),X(:,1:dim)])
 ans  =
 
!   1.4142136 !
!   1.4142136 !
!   1.4142136 !
!   0.        !
!   0.        !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/pbig.man
 
//====================================================
 
clear;lines(0);
 
A=diag([1,2,3]);X=rand(A);A=inv(X)*A*X;
 
[Q,M]=pbig(A,1.5,'d');
 
spec(M*A*Q)
 ans  =
 
!   2. !
!   3. !
 
[Q1,M1]=fullrf(eye-Q*M);
 
spec(M1*A*Q1)
 ans  =
 
    1.  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/pencan.man
 
//====================================================
 
clear;lines(0);
 
F=randpencil([],[1,2],[1,2,3],[]);
 
F=rand(6,6)*F*rand(6,6);
 
[Q,M,i1]=pencan(F);
    rank A^k    rcond
        4.      0.715E-13
        3.      0.185E+00
 
W=clean(M*F*Q)
 W  =
 
 
         column 1 to 3
 
! - 0.3619684 + s     2.5268836       - 3.1033464      !
!                                                      !
! - 0.7537615       - 3.3144698 + s     1.5854089      !
!                                                      !
! - 0.0428776         0.3240604       - 2.3235617 + s  !
!                                                      !
!   0                 0                 0              !
!                                                      !
!   0                 0                 0              !
!                                                      !
!   0                 0                 0              !
 
         column 4 to 5
 
!   0                - 1.726D-10 + 1.396D-10s  !
!                                              !
!   0                  1.140D-10               !
!                                              !
!   0                  0                       !
!                                              !
! - 1 + 0.4680457s     1.6801516s              !
!                                              !
! - 0.1416289s       - 1 - 0.5084075s          !
!                                              !
!   0.0027011s         0.0096963s              !
 
         column 6
 
!   1.870D-10 - 1.532D-10s  !
!                           !
! - 1.205D-10               !
!                           !
!   0                       !
!                           !
!   6.9937824s              !
!                           !
! - 2.116292s               !
!                           !
! - 1 + 0.0403618s          !
 
roots(det(W(1:i1,1:i1)))
 ans  =
 
!   1. !
!   2. !
!   3. !
 
det(W($-2:$,$-2:$))
 ans  =
 
  - 1   
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/penlaur.man
 
//====================================================
 
clear;lines(0);
 
F=randpencil([],[1,2],[1,2,3],[]);
 
F=rand(6,6)*F*rand(6,6);[E,A]=pen2ea(F);
 
[Si,Pi,Di]=penlaur(F);
    rank A^k    rcond
        4.      0.181E-14
        3.      0.230E+00
 
[Bfs,Bis,chis]=glever(F);
    rank A^k    rcond
        4.      0.181E-14
        3.      0.230E+00
 
norm(coeff(Bis,1)-Di,1)
 ans  =
 
    8.769D-13  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/pinv.man
 
//====================================================
 
clear;lines(0);
 
A=rand(5,2)*rand(2,4);
 
norm(A*pinv(A)*A-A,1)
 ans  =
 
    1.193D-15  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/polar.man
 
//====================================================
 
clear;lines(0);
 
A=rand(5,5);
 
[Ro,Theta]=polar(A);
 
norm(A-Ro*expm(%i*Theta),1)
 ans  =
 
    5.058D-15  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/proj.man
 
//====================================================
 
clear;lines(0);
 
X1=rand(5,2);X2=rand(5,3);
 
P=proj(X1,X2);
 
norm(P^2-P,1)
 ans  =
 
    2.975D-14  
 
trace(P)    // This is dim(X2)
 ans  =
 
    3.  
 
[Q,M]=fullrf(P);
 
svd([Q,X2])   // span(Q) = span(X2)
 ans  =
 
!   4.6833159 !
!   1.2359112 !
!   1.161455  !
!   0.        !
!   0.        !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/projspec.man
 
//====================================================
 
clear;lines(0);
 
deff('j=jdrn(n)','j=zeros(n,n);for k=1:n-1;j(k,k+1)=1;end')
 
A=sysdiag(jdrn(3),jdrn(2),rand(2,2));X=rand(7,7);
 
A=X*A*inv(X);
 
[S,P,D,index]=projspec(A);
    rank A^k    rcond
        5.      0.111E-14
        3.      0.638E-15
        2.      0.532E+00
 
index   //size of J-block
 index  =
 
    3.  
 
trace(P)  //sum of dimensions of J-blocks
 ans  =
 
    5.  
 
A*S-(eye-P)
 ans  =
 
   1.0D-14 *
 
 
         column 1 to 5
 
! - 0.1942890  - 0.1720846    0.4881512    0.9214851  - 0.1942890 !
! - 0.0277556  - 0.3774758    0.4996004    0.4440892  - 0.0166533 !
!   0.         - 0.6550316    0.4218847    0.4440892  - 0.0055511 !
! - 0.0888178  - 0.4551914    0.7494005    0.8437695  - 0.0999201 !
!   0.0777156  - 0.3996803    0.5107026    0.2331468    0.0333067 !
!   0.0166533  - 0.9936496    0.8604228    0.5107026    0.0499600 !
! - 0.1026956  - 0.8215650    1.2823076    0.8826273  - 0.0610623 !
 
         column 6 to 7
 
! - 0.6994405  - 0.3271688 !
! - 0.4440892  - 0.2664535 !
! - 0.1998401  - 0.3219647 !
! - 0.3774758  - 0.4347217 !
! - 0.1776357  - 0.2664535 !
! - 0.3552714  - 0.4621303 !
! - 0.7660539  - 0.4662937 !
 
norm(D^index,1)
 ans  =
 
    2.868D-13  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/psmall.man
 
//====================================================
 
clear;lines(0);
 
A=diag([1,2,3]);X=rand(A);A=inv(X)*A*X;
 
[Q,M]=psmall(A,2.5,'d');
 
spec(M*A*Q)
 ans  =
 
!   2. !
!   1. !
 
[Q1,M1]=fullrf(eye-Q*M);
 
spec(M1*A*Q1)
 ans  =
 
    3.  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/qr.man
 
//====================================================
 
clear;lines(0);
 
A=rand(5,2)*rand(2,5);
 
[Q,R,rk,E] = qr(A,1.d-10);
 
norm(Q'*A-R)
 ans  =
 
    1.0561844  
 
svd([A,Q(:,1:rk)])    //span(A) =span(Q(:,1:rk))
 ans  =
 
!   3.783207  !
!   1.0134155 !
!   0.        !
!   0.        !
!   0.        !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/quaskro.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/randpencil.man
 
//====================================================
 
clear;lines(0);
 
F=randpencil([0,1],[2],[-1,0,1],[3]);
 
[Q,Z,Qd,Zd,numbeps,numbeta]=kroneck(F);
 
Qd, Zd
 Qd  =
 
!   1.    2.    3.    4. !
 Zd  =
 
!   3.    2.    3.    3. !
 
s=poly(0,'s');
 
F=randpencil([],[1,2],s^3-2,[]); //regular pencil
 
det(F)
 ans  =
 
         3  
    2 - s   
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/range.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/rank.man
 
//====================================================
 
clear;lines(0);
 
rank([1.d-80,0;0,1.d-80])
 ans  =
 
    2.  
 
rank([1,0;0,1.d-80])
 ans  =
 
    1.  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/rcond.man
 
//====================================================
 
clear;lines(0);
 
A=diag([1:10]);
 
rcond(A)
 ans  =
 
    0.1889940  
 
A(1,1)=0.000001;
 
rcond(A)
 ans  =
 
    1.000D-07  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/rowcomp.man
 
//====================================================
 
clear;lines(0);
 
A=rand(5,2)*rand(2,4);   // 4 col. vectors, 2 independent.
 
[X,dim]=rowcomp(A);Xp=X';
 
svd([Xp(:,1:dim),A])     //span(A) = span(Xp(:,1:dim)
 ans  =
 
!   1.8944917 !
!   1.0599402 !
!   0.        !
!   0.        !
!   0.        !
 
x=A*rand(4,1);      //x belongs to span(A)
 
y=X*x
 y  =
 
! - 1.7653638 !
!   0.0606842 !
!   0.        !
!   0.        !
!   0.        !
 
norm(y(dim+1:$))/norm(y(1:dim))    // small
 ans  =
 
    3.514D-17  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/rowshuff.man
 
//====================================================
 
clear;lines(0);
 
F=randpencil([],[2],[1,2,3],[]);
 
F=rand(5,5)*F*rand(5,5);   // 5 x 5 regular pencil with 3 evals at 1,2,3
 
[Ws,F1]=rowshuff(F,-1);
 
[E1,A1]=pen2ea(F1);
 
svd(E1)           //E1 non singular
 ans  =
 
!   6.8059853 !
!   0.7019492 !
!   0.2589920 !
!   0.1199504 !
!   0.0785198 !
 
roots(det(Ws))
 ans  =
 
! - 1. + 1.490D-08i !
! - 1. - 1.490D-08i !
 
clean(inv(F)-inv(F1)*Ws,1.d-7)
    rank A^k    rcond
        4.      0.985E-15
        3.      0.210E+00
 ans  =
 
 
         column 1 to 4
 
!   0     0     0                                                    0  !
!   -     -     -                                                    -  !
!                                                                   !
!   1     1     1                                                   !
!        1                                                              !
!                                                                       !
!                                                  2            3       !
! ! 0     0   - 0.0000016 + 0.0000031s - 0.0000017s + 2.775D-07s     0  !
!   -     -     ------------------------------------------------     -  !
!                                           2   3                   !
!   1     1                   - 6 + 11s - 6s + s                    !
!        1                                                              !
!                                                                       !
!                                      2            3                   !
! ! 0     0   - 6.467D-07s + 8.594D-07s - 2.156D-07s                 0  !
!   -     -     ------------------------------------                 -  !
!                                     2   3                         !
!   1     1             - 6 + 11s - 6s + s                          !
!        1                                                              !
!                                                                       !
!   0     0     0                                                    0  !
!   -     -     -                                                    -  !
!                                                                   !
!   1     1     1                                                   !
!        1                                                              !
!                                                                       !
!                                                  2                    !
! ! 0     0     3.725D-07 - 6.109D-07s + 2.681D-07s                  0  !
!   -     -     -----------------------------------                  -  !
!                                    2   3                          !
!   1     1            - 6 + 11s - 6s + s                           !
!        1                                                              !
 
         column 5
 
!   0                                    !
!   -                                    !
!   1                                    !
!                                        !
!                                      2 !
! - 1.659D-07 + 2.617D-07s - 1.253D-07s  !
!   -----------------------------------  !
!                        2   3           !
!          - 6 + 11s - 6s + s            !
!                                        !
!   0                                    !
!   -                                    !
!   1                                    !
!                                        !
!   0                                    !
!   -                                    !
!   1                                    !
!                                        !
!   0                                    !
!   -                                    !
!   1                                    !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/rref.man
 
//====================================================
 
clear;lines(0);
 
A=[1 2;3 4;5 6];
 
X=rref([A,eye(3,3)]);
 
R=X(:,1:2)
 R  =
 
!   1.    0. !
!   0.    1. !
!   0.    0. !
 
L=X(:,3:5);L*A
 ans  =
 
!   1.           0. !
! - 1.776D-15    1. !
!   8.882D-16    0. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/schur.man
 
//====================================================
 
clear;lines(0);
 
A=diag([-0.9,-2,2,0.9]);X=rand(A);A=inv(X)*A*X;
 
[U,d]=schur(A,'c');
 
A1=U'*A*U;
 
spec(A1(1:d,1:d))      //stable cont. eigenvalues
 ans  =
 
! - 2.  !
! - 0.9 !
 
[U,d]=schur(A,'c');
 
A1=U'*A*U;
 
spec(A1(1:d,1:d))      //stable disc. eigenvalues
 ans  =
 
! - 2.  !
! - 0.9 !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/spaninter.man
 
//====================================================
 
clear;lines(0);
 
A=rand(5,3)*rand(3,4);     // A is 5 x 4, rank=3
 
B=[A(:,2),rand(5,1)]*rand(2,2);
 
[X,dim]=spaninter(A,B);
 
X1=X(:,1:dim);    //The intersection
 
svd(A),svd([X1,A])   // X1 in span(A)
 ans  =
 
!   2.6693555 !
!   0.3149260 !
!   0.1093458 !
!   0.        !
 ans  =
 
!   2.8451856 !
!   0.3598778 !
!   0.1095488 !
!   0.        !
!   0.        !
 
svd(B),svd([B,X1])   // X1 in span(B)
 ans  =
 
!   2.0483199 !
!   0.2731012 !
 ans  =
 
!   2.2635543 !
!   0.3827802 !
!   0.        !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/spanplus.man
 
//====================================================
 
clear;lines(0);
 
A=rand(6,2)*rand(2,5);      // rank(A)=2
 
B=[A(:,1),rand(6,2)]*rand(3,3);   //two additional independent vectors
 
[X,dim,dimA]=spanplus(A,B);
 
dimA
 dimA  =
 
    2.  
 
dim
 dim  =
 
    4.  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/spantwo.man
 
//====================================================
 
clear;lines(0);
 
A=[1,0,0,4;
   5,6,7,8;
   0,0,11,12;
   0,0,0,16];
 
B=[1,2,0,0]';C=[4,0,0,1];
 
Sl=ss2ss(syslin('c',A,B,C),rand(A));
 
[no,X]=contr(Sl('A'),Sl('B'));CO=X(:,1:no);  //Controllable part
 
[uo,Y]=unobs(Sl('A'),Sl('C'));UO=Y(:,1:uo);  //Unobservable part
 
[Xp,dimc,dimu,dim]=spantwo(CO,UO);    //Kalman decomposition
 
Slcan=ss2ss(Sl,inv(Xp));
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/spchol.man
 
//====================================================
 
clear;lines(0);
 
X=[
3.,  0.,  0.,  2.,  0.,  0.,  2.,  0.,  2.,  0.,  0. ;
0.,  5.,  4.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0. ;
0.,  4.,  5.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0. ;
2.,  0.,  0.,  3.,  0.,  0.,  2.,  0.,  2.,  0.,  0. ;
0.,  0.,  0.,  0. , 5.,  0.,  0.,  0.,  0.,  0.,  4. ;
0.,  0.,  0.,  0.,  0.,  4.,  0.,  3.,  0.,  3.,  0. ;
2.,  0.,  0.,  2.,  0.,  0.,  3.,  0.,  2.,  0.,  0. ;
0.,  0.,  0.,  0.,  0.,  3.,  0.,  4.,  0.,  3.,  0. ;
2.,  0.,  0.,  2.,  0.,  0.,  2.,  0.,  3.,  0.,  0. ;
0.,  0.,  0.,  0.,  0.,  3.,  0.,  3.,  0.,  4.,  0. ;
0.,  0.,  0.,  0.,  4.,  0.,  0.,  0.,  0.,  0.,  5.];
 
X=sparse(X);[R,P] = spchol(X);
 
max(P*R*R'*P'-X)
 ans  =
 
    8.882D-16  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/spec.man
 
//====================================================
 
clear;lines(0);
 
A=diag([1,2,3]);X=rand(3,3);A=inv(X)*A*X;
 
spec(A)
 ans  =
 
!   3. !
!   2. !
!   1. !
 
//
 
x=poly(0,'x');
 
pol=det(x*eye-A)
 pol  =
 
                2   3  
  - 6 + 11x - 6x + x   
 
roots(pol)
 ans  =
 
!   1. !
!   2. !
!   3. !
 
//
 
[Ab,X,bs]=bdiag(A);
 
Ab
 Ab  =
 
!   3.    0.    0. !
!   0.    2.    0. !
!   0.    0.    1. !
 
clean(inv(X)*A*X)
 ans  =
 
!   3.    0.    0. !
!   0.    2.    0. !
!   0.    0.    1. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/sqroot.man
 
//====================================================
 
clear;lines(0);
 
X=rand(5,2)*rand(2,5);X=X*X';
 
W=sqroot(X)
 W  =
 
! - 0.5998608    0.0990502 !
! - 0.9332937  - 0.0676139 !
! - 0.5303561  - 0.0837900 !
! - 1.092862     0.0902140 !
! - 0.9976546  - 0.0505842 !
 
norm(W*W'-X,1)
 ans  =
 
    4.552D-15  
 
//
 
X=rand(5,2)+%i*rand(5,2);X=X*X';
 
W=sqroot(X)
 W  =
 
!   1.1345552               - 0.4535426              !
!   0.8955481 - 0.3005899i    0.0912659 - 0.1602907i !
!   1.3173579 + 0.3834244i    0.0462267 - 0.3649849i !
!   1.3076396 + 0.0583630i    0.2453132 + 0.4527399i !
!   1.2402796 + 0.1718967i    0.0881063 + 0.0420037i !
 
norm(W*W'-X,1)
 ans  =
 
    8.272D-15  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/sva.man
 
//====================================================
 
clear;lines(0);
 
A=rand(5,4)*rand(4,5);
 
[U,s,V]=sva(A,2);
 
B=U*s*V';
 
svd(A)
 ans  =
 
!   5.2910037 !
!   0.5786449 !
!   0.2316758 !
!   0.1717976 !
!   0.        !
 
svd(B)
 ans  =
 
!   5.2910037 !
!   0.5786449 !
!   0.        !
!   0.        !
!   0.        !
 
clean(svd(A-B))
 ans  =
 
!   0.2316758 !
!   0.1717976 !
!   0.        !
!   0.        !
!   0.        !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/svd.man
 
//====================================================
 
clear;lines(0);
 
X=rand(4,2)*rand(2,4)
 X  =
 
!   0.6610505    0.7385007    0.5363561    0.1927671 !
!   0.7030768    0.6757241    0.6647535    0.5871738 !
!   0.8522574    0.8652636    0.7661305    0.5509881 !
!   0.0689213    0.0484608    0.0804439    0.1194802 !
 
svd(X)
 ans  =
 
!   2.314719  !
!   0.2833505 !
!   0.        !
!   0.        !
 
sqrt(spec(X*X'))
 ans  =
 
!   2.174D-08i !
!   3.377D-09  !
!   0.2833505  !
!   2.314719   !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/sylv.man
 
//====================================================
 
clear;lines(0);
 
A=rand(4,4);C=rand(4,3);B=rand(3,3);
 
X = sylv(A,B,C,'c');
 
norm(A*X+X*B-C)
 ans  =
 
    9.382D-15  
 
X=sylv(A,B,C,'d')
 X  =
 
!   0.4370121    1.1829166    1.0216571 !
!   0.2247419    0.6829716    0.4216999 !
! - 0.5402406    0.1364796    0.2902768 !
!   0.5332348    0.7098462    0.9648012 !
 
norm(A*X*B-X-C)
 ans  =
 
    3.943D-15  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/linear/trace.man
 
//====================================================
 
clear;lines(0);
 
A=rand(3,3);
 
trace(A)-sum(spec(A))
 ans  =
 
    3.818D-08  
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/metanet/add_edge.man
 
//====================================================
 
clear;lines(0);
 
ta=[1 1 2 2 2 3 4 5 5 7 8 8 9 10 10 10 11 12 13 13 13 14 15 16 16 17 17];
 
he=[2 10 3 5 7 4 2 4 6 8 6 9 7 7 11 15 12 13 9 10 14 11 16 1 17 14 15];
 
g=make_graph('foo',1,17,ta,he);
 
g('node_x')=[283 163 63 57 164 164 273 271 339 384 504 513 439 623 631 757 642];
 
g('node_y')=[59 133 223 318 227 319 221 324 432 141 209 319 428 443 187 151 301];
 
show_graph(g);
 
g=add_edge(1,7,g);
 
g('edge_color')=[ones(ta) 11];
 
show_graph(g);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/metanet/add_node.man
 
//====================================================
 
clear;lines(0);
 
ta=[1 1 2 2 2 3 4 5 5 7 8 8 9 10 10 10 11 12 13 13 13 14 15 16 16 17 17];
 
he=[2 10 3 5 7 4 2 4 6 8 6 9 7 7 11 15 12 13 9 10 14 11 16 1 17 14 15];
 
g=make_graph('foo',1,17,ta,he);
 
g('node_x')=[283 163 63 57 164 164 273 271 339 384 504 513 439 623 631 757 642];
 
g('node_y')=[59 133 223 318 227 319 221 324 432 141 209 319 428 443 187 151 301];
 
show_graph(g);
 
n=g('node_number');
 
g1=add_node(g,[270 140]);
 
g1('node_color')=[ones(1,n) 11];
 
show_graph(g1);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/metanet/adj_lists.man
 
//====================================================
 
clear;lines(0);
 
ta=[2 3 3 5 3 4 4 5 8];
 
he=[1 2 4 2 6 6 7 7 4];
 
g=make_graph('foo',1,8,ta,he);
 
g('node_x')=[129 200 283 281 128 366 122 333];
 
g('node_y')=[61 125 129 189 173 135 236 249];
 
show_graph(g);
 
[lp,la,ls]=adj_lists(g)
 ls  =
 
!   1.    2.    4.    6.    6.    7.    2.    7.    4. !
 la  =
 
!   1.    2.    3.    5.    6.    7.    4.    8.    9. !
 lp  =
 
!   1.    1.    2.    5.    7.    9.    9.    9.    10. !
 
[lp,la,ls]=adj_lists(1,g('node_number'),ta,he)
 ls  =
 
!   1.    2.    4.    6.    6.    7.    2.    7.    4. !
 la  =
 
!   1.    2.    3.    5.    6.    7.    4.    8.    9. !
 lp  =
 
!   1.    1.    2.    5.    7.    9.    9.    9.    10. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/metanet/arc_graph.man
 
//====================================================
 
clear;lines(0);
 
ta=[1 1 2 4 4 5 6 7 2 3 5 1];
 
he=[2 6 3 6 7 8 8 8 4 7 3 5];
 
g=make_graph('foo',1,8,ta,he);
 
g('node_x')=[281  284  360  185  405  182  118  45];
 
g('node_y')=[262  179  130  154  368  248  64  309];
 
show_graph(g);
 
g1=arc_graph(g);
 
show_graph(g1,'new');
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/metanet/arc_number.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/metanet/articul.man
 
//====================================================
 
clear;lines(0);
 
ta=[2  1 3 2 2 4 4 5 6 7 8 8 9 10 10 10 10 11 12 13 14 15 16 17 17];
 
he=[1 10 2 5 7 3 2 4 5 8 6 9 7  7 11 13 15 12 13 14 11 16 17 14 15];
 
g=make_graph('foo',1,17,ta,he);
 
g('node_x')=[283 163 63 57 164 164 273 271 339 384 504 513 439 623 631 757 642];
 
g('node_y')=[59 133 223 318 227 319 221 324 432 141 209 319 428 443 187 151 301];
 
g('node_diam')=[1:(g('node_number'))]+20;
 
show_graph(g);
 
nart = articul(g)
 nart  =
 
    10.  
 
show_nodes(nart);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/metanet/bandwr.man
 
//====================================================
 
clear;lines(0);
 
ta=[2  1 3 2 2 4 4 5 6 7 8 8 9 10 10 10 10 11 12 13 13 14 15 16 16 17 17];
 
he=[1 10 2 5 7 3 2 4 5 8 6 9 7 7 11 13 15 12 13  9 14 11 16 1 17 14 15];
 
g=make_graph('foo',0,17,ta,he);
 
g('node_x')=[283 163 63 57 164 164 273 271 339 384 504 513 439 623 631 757 642];
 
g('node_y')=[59 133 223 318 227 319 221 324 432 141 209 319 428 443 187 151 301];
 
// THE GRAPH
 
show_graph(g);
 
a=graph_2_mat(g,'node-node');
 
ww=tril(a)'+eye;
 
ww1=full(ww);
 
xset('window',0)
 
hist3d((ww1+tril(ww1',-1)+tril(ww1,-1)'),52,85);
 
// BANDWIDTH REDUCTION FOR THE MATRIX
 
[iperm,mrepi,profile,ierr]=bandwr(ww);
 
max(profile(2:$)-profile(1:($-1)))
 ans  =
 
    0.  
 
// GRAPH WITH THE NEW NUMBERING
 
g2=g;g2('node_name')=string(iperm);
 
show_graph(g2,'new')
 ans  =
 
    3.  
 
// NEW MATRIX
 
n=g('node_number');
 
yy=ww1(mrepi,mrepi);
 
xset('window',1)
 
hist3d((yy+tril(yy',-1)+tril(yy,-1)'),52,85);
 
// STARTING WITH THE SAME MATRIX
 
[ij,v,mn]=spget(ww);
 
g1=make_graph('foo',0,n,ij(:,1)',ij(:,2)');
 
g1('node_x')=g('node_x');g1('node_y')=g('node_y');
 
// GRAPH
 
//show_graph(g1,'rep');
 
[lp,la,ls] = adj_lists(1,n,g1('tail'),g1('head'));
 
[iperm,mrepi,profile,ierr]=bandwr(lp,ls,n,0);
 
g2=g;g2('node_name')=string(iperm);
 
show_graph(g2,'new');
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/metanet/best_match.man
 
//====================================================
 
clear;lines(0);
 
ta=[27 27 3 12 11 12 27 26 26 25 25 24 23 23 21 22 21 20 19 18 18];
 
ta=[ta  16 15 15 14 12 9 10 6 9 17 8 17 10 20 11 23 23 12 18 28];
 
he=[ 1  2 2  4  5 11 13  1 25 22 24 22 22 19 13 13 14 16 16  9 16];
 
he=[he  10 10 11 12  2 6  5 5 7  8 7  9  6 11  4 18 13  3 28 17];
 
n=28;
 
g=make_graph('foo',0,n,ta,he);
 
xx=[46 120 207 286 366 453 543 544 473 387 300 206 136 250 346 408];
 
g('node_x')=[xx 527 443 306 326 196 139 264  55  58  46 118 513];
 
yy=[36  34  37  40  38  40  35 102 102  98  93  96 167 172 101 179];
 
g('node_y')=[yy 198 252 183 148 172 256 259 258 167 109 104 253];
 
show_graph(g);
 
[card,match] = best_match(g);
 
sp=sparse([ta' he'],[1:size(ta,2)]',[n,n]);
 
sp1=sparse([[1:n]' match'],ones(1,size(match,2))',[n,n]);
 
[ij,v,mn]=spget(sp.*sp1);
 
show_arcs(v');
 
//
 
// WITH A LARGER GRAPH
 
g=load_graph(SCI+'/demos/metanet/mesh1000');
 
g('directed')=0;
 
ta=g('tail');he=g('head');n=node_number(g);
 
show_graph(g);
 
[card,match] = best_match(g);
 
sp=sparse([ta' he'],[1:size(ta,2)]',[n,n]);
 
sp1=sparse([[1:n]' match'],ones(1,size(match,2))',[n,n]);
 
[ij,v,mn]=spget(sp.*sp1);
 
show_arcs(v');
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/metanet/chain_struct.man
 
//====================================================
 
clear;lines(0);
 
ta=[1 1 2 3 5 4 6 7 7 3 3 8 8 5];
 
he=[2 3 5 4 6 6 7 4 3 2 8 1 7 4];
 
g=make_graph('foo',1,8,ta,he);
 
g('node_x')=[116 231 192 323 354 454 305 155];
 
g('node_y')=[118 116 212 219 117 185 334 316];
 
show_graph(g);
 
[fe,che,fn,chn] = chain_struct(g)
 chn  =
 
 
         column  1 to 11
 
!   3.    0.    0.    2.    4.    0.    0.    3.    0.    8.    0. !
 
         column 12 to 14
 
!   7.    0.    0. !
 fn  =
 
!   2.    5.    4.    6.    6.    7.    4.    1. !
 che  =
 
 
         column  1 to 10
 
!   2.    0.    0.    10.    14.    0.    0.    9.    0.    11. !
 
         column 11 to 14
 
!   0.    13.    0.    0. !
 fe  =
 
!   1.    3.    4.    6.    5.    7.    8.    12. !
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/metanet/check_graph.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/metanet/circuit.man
 
//====================================================
 
clear;lines(0);
 
// graph with circuit
 
ta=[1 1 2 3 5 4 6 7 7 3 3 8 8 5];
 
he=[2 3 5 4 6 6 7 4 3 2 8 1 7 4];
 
g=make_graph('foo',1,8,ta,he);
 
g('node_x')=[116 231 192 323 354 454 305 155];
 
g('node_y')=[ 118 116 212 219 117 185 334 316];
 
show_graph(g);
 
p=circuit(g)
 p  =
 
!   2.    11.    12. !
 
show_arcs(p)
 
// graph without circuit
 
g=make_graph('foo',1,4,[1 2 2 3],[2 3 4 4]);
 
[p,r]=circuit(g)
 r  =
 
!   0.    1.    2.    3. !
 p  =
 
     []
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/metanet/con_nodes.man
 
//====================================================
 
clear;lines(0);
 
ta=[1 1 2 2 2 3 4 4 5 7 7 9 10 12 12 13 13 14 15];
 
he=[2 6 3 4 5 1 3 5 1 8 9 8 11 10 11 11 15 13 14];
 
g=make_graph('foo',1,15,ta,he);
 
g('node_x')=[197 191 106 194 296 305 305 418 422 432 552 550 549 416 548];
 
g('node_y')=[76 181 276 278 276 83 174 281 177 86 175 90 290 397 399];
 
show_graph(g);
 
con_nodes(2,g)
 ans  =
 
!   7.    8.    9. !
 
x_message('Displaying the nodes of component #2');
 
n=g('node_number');
 
nodecolor=0*ones(1,n);
 
nodecolor(1,con_nodes(2,g))=11*ones(con_nodes(2,g));
 
g('node_color')=nodecolor;
 
nodediam=20.*ones(1,n);
 
nodediam(1,con_nodes(2,g))=30*ones(con_nodes(2,g));
 
g('node_diam')=nodediam;
 
show_graph(g);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/metanet/connex.man
 
//====================================================
 
clear;lines(0);
 
ta=[1 1 2 2 2 3 4 4 5 6 7 7 7 8 9 10 12 12 13 13 14 15];
 
he=[2 6 3 4 5 1 3 5 1 7 5 8 9 5 8 11 10 11 11 15 13 14];
 
g=make_graph('foo',1,15,ta,he);
 
g('node_x')=[197 191 106 194 296 305 305 418 422 432 552 550 549 416 548];
 
g('node_y')=[76 181 276 278 276 83 174 281 177 86 175 90 290 397 399];
 
show_graph(g);
 
[nc,ncomp]=connex(g)
 ncomp  =
 
 
         column  1 to 11
 
!   1.    1.    1.    1.    1.    1.    1.    1.    1.    2.    2. !
 
         column 12 to 15
 
!   2.    2.    2.    2. !
 nc  =
 
    2.  
 
g('node_color')=10+ncomp;
 
g('node_diam')=10+10*ncomp;
 
x_message('Displaying the connected components of this graph');
 
show_graph(g);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/metanet/contract_edge.man
 
//====================================================
 
clear;lines(0);
 
ta=[1 1 2 2 2 3 4 5 5 7 8 8 9 10 10 10 10 10 11 12 13 13 13 14 15 16 16 17 17];
 
he=[2 10 3 5 7 4 2 4 6 8 6 9 7 7 11 13 13 15 12 13 9 10 14 11 16 1 17 14 15];
 
g=make_graph('foo',1,17,ta,he);
 
g('node_x')=[283 163 63 57 164 164 273 271 339 384 504 513 439 623 631 757 642];
 
g('node_y')=[59 133 223 318 227 319 221 324 432 141 209 319 428 443 187 151 301];
 
show_graph(g);
 
g1=contract_edge(10,13,g);
 
show_graph(g1,'new');
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/metanet/convex_hull.man
 
//====================================================
 
clear;lines(0);
 
ta=[27 27 3 12 11 12 27 26 26 25 25 24 23 23 21 22 21 20 19 18 18];
 
ta=[ta  16 15 15 14 12 9 10 6 9 17 8 17 10 20 11 23 23 12 18 28];
 
he=[ 1  2 2  4  5 11 13  1 25 22 24 22 22 19 13 13 14 16 16  9 16];
 
he=[he  10 10 11 12  2 6  5 5 7  8 7  9  6 11  4 18 13  3 28 17];
 
g=make_graph('foo',0,28,ta,he);
 
xx=[46 120 207 286 366 453 543 544 473 387 300 206 136 250 346 408];
 
g('node_x')=[xx 527 443 306 326 196 139 264  55  58  46 118 513];
 
yy=[36  34  37  40  38  40  35 102 102  98  93  96 167 172 101 179];
 
g('node_y')=[yy 198 252 183 148 172 256 259 258 167 109 104 253];
 
show_graph(g);
 
xy=[g('node_x');g('node_y')];
 
[nhull,ind] = convex_hull(xy)
 ind  =
 
!   17.    28.    23.    24.    26.    1.    2.    7.    8. !
 nhull  =
 
    9.  
 
show_nodes(ind);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/metanet/cycle_basis.man
 
//====================================================
 
clear;lines(0);
 
ta=[1 1 2 2 2 3 4 5 5 7 8 8 9 10 10 10 10 10 11 12 13 13 13 14 15 16 16 17 17];
 
he=[2 10 3 5 7 4 2 4 6 8 6 9 7 7 11 13 13 15 12 13 9 10 14 11 16 1 17 14 15];
 
gt=make_graph('foo',1,17,ta,he);
 
gt('node_x')=[283 163 63 57 164 164 273 271 339 384 504 513 439 623 631 757 642];
 
gt('node_y')=[59 133 223 318 227 319 221 324 432 141 209 319 428 443 187 151 301];
 
gt('edge_color')=modulo([1:(edge_number(gt))],15)+1;
 
gt('node_diam')=[1:(gt('node_number'))]+20;
 
show_graph(gt);
 
g=graph_simp(gt);
 
g('edge_color')=modulo([1:(edge_number(g))],15)+1;
 
g('node_diam')=gt('node_diam');
 
g('default_edge_hi_width')=12;
 
show_graph(g);
 
spc=cycle_basis(g);
 
for kk=1:(size(spc,1)),
  aaa=spc(kk,:);aaa=full(aaa);aaa(aaa==0)=[];
  show_arcs(aaa);
end;
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/metanet/delete_arcs.man
 
//====================================================
 
clear;lines(0);
 
ta=[1 1 2 2 2 3 4 5 5 7 8 8 9 10 10 10 10 10 11 12 13 13 13 14 15 16 16 17 17];
 
he=[2 10 3 5 7 4 2 4 6 8 6 9 7 7 11 13 13 15 12 13 9 10 14 11 16 1 17 14 15];
 
g=make_graph('foo',1,17,ta,he);
 
g('node_x')=[283 163 63 57 164 164 273 271 339 384 504 513 439 623 631 757 642];
 
g('node_y')=[59 133 223 318 227 319 221 324 432 141 209 319 428 443 187 151 301];
 
show_graph(g);
 
ij=[13 10;8 6;5 4;4 2];
 
gt=delete_arcs(ij,g);
 
show_graph(gt,'new');
 
g('directed')=0;
 
gt=delete_arcs(ij,g);
 
show_graph(gt,'new');
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/metanet/delete_nodes.man
 
//====================================================
 
clear;lines(0);
 
ta=[1 1 2 2 2 3 4 5 5 7 8 8 9 10 10 10 10 10 11 12 13 13 13 14 15 16 16 17 17];
 
he=[2 10 3 5 7 4 2 4 6 8 6 9 7 7 11 13 13 15 12 13 9 10 14 11 16 1 17 14 15];
 
g=make_graph('foo',1,17,ta,he);
 
g('node_x')=[283 163 63 57 164 164 273 271 339 384 504 513 439 623 631 757 642];
 
g('node_y')=[59 133 223 318 227 319 221 324 432 141 209 319 428 443 187 151 301];
 
show_graph(g);
 
v=[10 13 4];
 
gt=delete_nodes(v,g);
 
show_graph(gt,'new');
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/metanet/edge_number.man
 
//====================================================
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/metanet/find_path.man
 
//====================================================
 
clear;lines(0);
 
ta=[1 1 2 2 2 3 4 5 5 7 8 8 9 10 10 10 11 12 13 13 13 14 15 16 16 17 17];
 
he=[2 10 3 5 7 4 2 4 6 8 6 9 7 7 11 15 12 13 9 10 14 11 16 1 17 14 15];
 
g=make_graph('foo',1,17,ta,he);
 
g('node_x')=[283 163 63 57 164 164 273 271 339 384 504 513 439 623 631 757 642];
 
g('node_y')=[59 133 223 318 227 319 221 324 432 141 209 319 428 443 187 151 301];
 
show_graph(g);
 
p=find_path(1,14,g);
 
edgecolor=1*ones(ta); edgecolor(p)=11*ones(p); g('edge_color')=edgecolor;
 
show_graph(g); show_arcs(p);
 
for k=winsid(),xdel(k);end
 
 
//====================================================
 
// ../man/metanet/gen_net.man
 
//====================================================
 
clear;lines(0);
 
v=[1,10,2,1,0,10,100,100,0,100,50,50];
 
g=gen_net('foo',1,v);
 
show_graph(g)
 ans  =
 
    8.  
 
// generating using dialogs
 
g=gen_net();
 
show_graph(g)
 !--error 10000 
Graph list check: the graph must be a typed list                                
at line       6 of function check_graph              called by :  
line    28 of function show_graph               called by :  
show_graph(g)
line  4571 of exec file called by :    
exec examples.tst
 
 
netwindows()
 ans  =
 
 
       ans(1)
 
!   1.    2.    3.    4.    5.    6.    7.    8. !
 
       ans(2)
 
    8.  
 
quit
exec('SCI/scilab.quit',-1);quit;
