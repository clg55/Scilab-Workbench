 
getf SCI/util/testexamples.sci
 
reinit_for_test()
 
%U=mopen('SCI/tests/automatic_tests/xls_read_data.ref','rb');
 
//Decode ole file, extract and open Excel stream
 
[fd,SST,Sheetnames,Sheetpos] = xls_open('SCI/demos/excel/Test1.xls');
 
if load_ref('Sheetpos') then   bugmes();quit;end,
 
if load_ref('Sheetnames') then   bugmes();quit;end,
 
if load_ref('SST') then   bugmes();quit;end,
 
if load_ref('fd') then   bugmes();quit;end,
 
 
//Read first data sheet
 
[Value,TextInd] = xls_read(fd, Sheetpos(1));
 
if load_ref('TextInd') then   bugmes();quit;end,
 
if load_ref('Value') then   bugmes();quit;end,
 
 
//close the excel stream
 
%ans = mclose(fd);
 
if load_ref('%ans') then   bugmes();quit;end,
 
 
xdel_run(winsid());
 
 
mclose(%U);
 
