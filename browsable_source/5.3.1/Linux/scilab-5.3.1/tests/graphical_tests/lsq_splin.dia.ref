 
getf SCI/util/testexamples.sci
 
reinit_for_test()
 
%U=mopen('SCI/tests/graphical_tests/lsq_splin_data.ref','rb');
 
// this is an artifical example where the datas xd and yd
 
// are build from a perturbed sin function
 
a = 0;b = 2 * %pi;
 
sigma = 0.1;// standard deviation of the gaussian noise
 
m = 200;// number of experimental points
 
xd = linspace(a, b, m)';
 
yd = sin(xd) + grand(xd, 'nor', 0, sigma);
 
 
n = 6;// number of breakpoints
 
x = linspace(a, b, n)';
 
 
// compute the spline
 
[y,d] = lsq_splin(xd, yd, x);// use equal weights
 
 
// plotting
 
ye = sin(xd);
 
ys = interp(xd, x, y, d);
 
%ans = xbasc_run();
 
if load_ref('%ans') then   bugmes();quit;end,
 
 
%ans = plot2d(xd, [ye,yd,ys], style=[2,-2,3], leg='exact function@experimental measures (gaussian perturbation)@fitted spline');
 
if load_ref('%ans') then   bugmes();quit;end,
 
 
%ans = xtitle('a least square spline');
 
if load_ref('%ans') then   bugmes();quit;end,
 
 
%ans = xselect();
 
if load_ref('%ans') then   bugmes();quit;end,
 
 
xdel_run(winsid());
 
 
mclose(%U);
 
