<html>
  <body bgcolor="FFFFFF">
    <CENTER>Scilab Function  </CENTER>
    <P></P>
    <H3>NAME </H3>
    <p>
      <ul>spantwo -  sum and intersection of subspaces  </ul>
    </p>
    <H3>CALLING SEQUENCE</H3>
    <dl>
      <dd>[Xp,dima,dimb,dim]=spantwo(A,B, [tol])  </dd>
    </dl>
    <H3>PARAMETERS</H3>
    <ul>
      <ul>
  <li>
          <tt>
            <b>A, B  </b>
          </tt>
    : two real or complex matrices with equal number of rows
  </li>
  <li>
          <tt>
            <b>Xp  </b>
          </tt>
    : square non-singular matrix
  </li>
  <li>
          <tt>
            <b>dima, dimb, dim  </b>
          </tt>
    : integers, dimension of subspaces
  </li>
  <li>
          <tt>
            <b>tol  </b>
          </tt>
    : nonnegative real number
  </li>
 </ul>
    </ul>
    <H3>DESCRIPTION</H3>
    <ul>
  <p>
    Given two matrices <tt>
          <b>A</b>
        </tt> and <tt>
          <b>B</b>
        </tt> with same number of rows,
    returns a square matrix <tt>
          <b>Xp</b>
        </tt> (non singular but not necessarily orthogonal) 
    such that :
  </p>
  <pre>
         [A1, 0]    (dim-dimb rows)
Xp*[A,B]=[A2,B2]    (dima+dimb-dim rows)
         [0, B3]    (dim-dima rows)
         [0 , 0]
   </pre>
  <p>
    The  first <tt>
          <b>dima</b>
        </tt>  columns of <tt>
          <b>inv(Xp)</b>
        </tt> span range(<tt>
          <b>A</b>
        </tt>).
  </p>
  <p>
    Columns <tt>
          <b>dim-dimb+1</b>
        </tt> to <tt>
          <b>dima</b>
        </tt> of <tt>
          <b>inv(Xp)</b>
        </tt> span the 
    intersection of range(A) and range(B).
  </p>
  <p>
    The <tt>
          <b>dim</b>
        </tt> first columns of <tt>
          <b>inv(Xp)</b>
        </tt> span 
    range(<tt>
          <b>A</b>
        </tt>)+range(<tt>
          <b>B</b>
        </tt>).
  </p>
  <p>
    Columns <tt>
          <b>dim-dimb+1</b>
        </tt> to <tt>
          <b>dim</b>
        </tt> of <tt>
          <b>inv(Xp)</b>
        </tt> span 
    range(<tt>
          <b>B</b>
        </tt>). 
  </p>
  <p>
    Matrix <tt>
          <b>[A1;A2]</b>
        </tt> has full row rank (=rank(A)). Matrix <tt>
          <b>[B2;B3]</b>
        </tt> has
    full row rank (=rank(B)). Matrix <tt>
          <b>[A2,B2]</b>
        </tt> has full row rank (=rank(A inter B)). Matrix <tt>
          <b>[A1,0;A2,B2;0,B3]</b>
        </tt> has full row rank (=rank(A+B)).
  </p>
  </ul>
    <H3>EXAMPLES</H3>
    <ul>
      <pre>
A=[1,0,0,4;
   5,6,7,8;
   0,0,11,12;
   0,0,0,16];
B=[1,2,0,0]';C=[4,0,0,1]; 
Sl=ss2ss(syslin('c',A,B,C),rand(A));
[no,X]=contr(Sl('A'),Sl('B'));CO=X(:,1:no);  //Controllable part
[uo,Y]=unobs(Sl('A'),Sl('C'));UO=Y(:,1:uo);  //Unobservable part
[Xp,dimc,dimu,dim]=spantwo(CO,UO);    //Kalman decomposition
Slcan=ss2ss(Sl,inv(Xp));
 </pre>
    </ul>
    <H3>SEE ALSO</H3>
    <p>
      <ul>
        <a href="spanplus.html">
          <tt>
            <b>spanplus</b>
          </tt>
        </a>
        <a href="spaninter.html">
          <tt>
            <b>spaninter</b>
          </tt>
        </a>
      </ul>
    </p>
    <H3>AUTHOR</H3>
    <p>
      <ul>F. D.  </ul>
    </p>
  </body>
</html>