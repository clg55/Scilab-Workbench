<html>
  <body bgcolor="FFFFFF">
    <CENTER>Scilab Function  </CENTER>
    <P></P>
    <H3>NAME </H3>
    <p>
      <ul>ricc -  Riccati equation   </ul>
    </p>
    <H3>CALLING SEQUENCE</H3>
    <dl>
      <dd>[X]=ricc(A,B,C,"cont")  </dd>
      <dd>[X]=ricc(F,G,H,"disc")  </dd>
    </dl>
    <H3>PARAMETERS</H3>
    <ul>
      <ul>
  <li>
          <tt>
            <b>A,B,C  </b>
          </tt>
    : real matrices of appropriate dimensions
  </li>
  <li>
          <tt>
            <b>F,G,H  </b>
          </tt>
    : real matrices of appropriate dimensions
  </li>
  <li>
          <tt>
            <b>X  </b>
          </tt>
    : real matrix
  </li>
  <li>
          <tt>
            <b>"cont","disc"'  </b>
          </tt>
    : imposed string (flag for continuous or discrete)
  </li>
 </ul>
    </ul>
    <H3>DESCRIPTION</H3>
    <ul>
  <p>
    Riccati solver.
  </p>
  <p>
    Continuous time:
  </p>
  <pre>
  X=ricc(A,B,C,'cont')
   </pre>
  <p>
    gives a solution to the continuous time ARE
  </p>
  <pre>
  A'*X+X*A-X*B*X+C=0 .
   </pre>
  <p>
    <tt>
          <b>B</b>
        </tt> and <tt>
          <b>C</b>
        </tt> are assumed to be nonnegative definite.
    <tt>
          <b>(A,G)</b>
        </tt> is assumed to be stabilizable with <tt>
          <b>G*G'</b>
        </tt> a full rank
    factorization of <tt>
          <b>B</b>
        </tt>.
  </p>
  <p>
    <tt>
          <b>(A,H)</b>
        </tt> is assumed to be detectable with <tt>
          <b>H*H'</b>
        </tt> a full rank
    factorization of <tt>
          <b>C</b>
        </tt>.
  </p>
  <p>
  </p>
  <p>
    Discrete time:
  </p>
  <pre>
  X=ricc(F,G,H,'disc')
   </pre>
  <p>
    gives a solution  to the discrete time ARE 
  </p>
  <pre>
  X=F'*X*F-F'*X*G1*((G2+G1'*X*G1)^-1)*G1'*X*F+H
   </pre>
  <p>
    <tt>
          <b>F</b>
        </tt> is assumed invertible and   <tt>
          <b>G = G1*inv(G2)*G1'</b>
        </tt>.
  </p>
  <p>
    One  assumes  <tt>
          <b>(F,G1)</b>
        </tt> stabilizable and <tt>
          <b>(C,F)</b>
        </tt> detectable
    with <tt>
          <b>C'*C</b>
        </tt> full rank factorization of <tt>
          <b>H</b>
        </tt>. Use preferably
    <tt>
          <b>ric_desc</b>
        </tt>.
  </p>
  </ul>
    <H3>EXAMPLES</H3>
    <ul>
      <pre>
//Standard formulas to compute Riccati solutions
A=rand(3,3);B=rand(3,2);C=rand(3,3);C=C*C';R=rand(2,2);R=R*R'+eye();
B=B*inv(R)*B';
X=ricc(A,B,C,'cont');
norm(A'*X+X*A-X*B*X+C,1)
H=[A -B;-C -A'];
[T,d]=gschur(eye(H),H,'cont');T=T(:,1:d);
X1=T(4:6,:)/T(1:3,:);
norm(X1-X,1)
[T,d]=schur(H,'cont');T=T(:,1:d);
X2=T(4:6,:)/T(1:3,:);
norm(X2-X,1)
//       Discrete time case
F=A;B=rand(3,2);G1=B;G2=R;G=G1/G2*G1';H=C;
X=ricc(F,G,H,'disc');
norm(F'*X*F-(F'*X*G1/(G2+G1'*X*G1))*(G1'*X*F)+H-X)
H1=[eye(3,3) G;zeros(3,3) F'];
H2=[F zeros(3,3);-H eye(3,3)];
[T,d]=gschur(H2,H1,'disc');T=T(:,1:d);X1=T(4:6,:)/T(1:3,:);
norm(X1-X,1)
Fi=inv(F);
Hami=[Fi Fi*G;H*Fi F'+H*Fi*G];
[T,d]=schur(Hami,'d');T=T(:,1:d);
Fit=inv(F');
Ham=[F+G*Fit*H -G*Fit;-Fit*H Fit];
[T,d]=schur(Ham,'d');T=T(:,1:d);X2=T(4:6,:)/T(1:3,:);
norm(X2-X,1)
 </pre>
    </ul>
    <H3>SEE ALSO</H3>
    <p>
      <ul>
        <a href="../robust/riccati.html">
          <tt>
            <b>riccati</b>
          </tt>
        </a>
        <a href="../robust/ric_desc.html">
          <tt>
            <b>ric_desc</b>
          </tt>
        </a>
        <a href="../linear/gschur.html">
          <tt>
            <b>schur</b>
          </tt>
        </a>
        <a href="../linear/gschur.html">
          <tt>
            <b>gschur</b>
          </tt>
        </a>
      </ul>
    </p>
  </body>
</html>