<html>
  <body bgcolor="FFFFFF">
    <CENTER>Scilab Function  </CENTER>
    <P></P>
    <H3>NAME </H3>
    <p>
      <ul>mrfit -  frequency response fit  </ul>
    </p>
    <H3>CALLING SEQUENCE</H3>
    <dl>
      <dd>sys=mrfit(w,mag,order)  </dd>
      <dd>[num,den]=mrfit(w,mag,order)  </dd>
      <dd>sys=mrfit(w,mag,order,weight)  </dd>
      <dd>[num,den]=mrfit(w,mag,order,weight)  </dd>
    </dl>
    <H3>PARAMETERS</H3>
    <ul>
      <ul>
  <li>
          <tt>
            <b>w  </b>
          </tt>
    : positive real vector of frequencies (Hz)
  </li>
  <li>
          <tt>
            <b>mag  </b>
          </tt>
    : real vector of frequency responses magnitude (same size as <tt>
            <b>w</b>
          </tt>)
  </li>
  <li>
          <tt>
            <b>order  </b>
          </tt>
    : integer (required order, degree of <tt>
            <b>den</b>
          </tt>)
  </li>
  <li>
          <tt>
            <b>weight  </b>
          </tt>
    : positive real vector (default value <tt>
            <b>ones(w)</b>
          </tt>).
  </li>
  <li>
          <tt>
            <b>num,den  </b>
          </tt>
    : stable polynomials
  </li>
 </ul>
    </ul>
    <H3>DESCRIPTION</H3>
    <ul>
  <p>
    <tt>
          <b>sys=mrfit(w,mag,order,weight)</b>
        </tt> returns a bi-stable transfer function
    <tt>
          <b>G(s)=sys=num/den</b>
        </tt>, of of given <tt>
          <b>order</b>
        </tt> such that 
    its frequency response magnitude <tt>
          <b>abs(G(w(i)))</b>
        </tt> 
    matches <tt>
          <b>mag(i)</b>
        </tt> i.e. <tt>
          <b>abs(freq(num,den,%i*w))</b>
        </tt> should be 
    close to <tt>
          <b>mag</b>
        </tt>.
    <tt>
          <b>weight(i)</b>
        </tt> is the weigth given to <tt>
          <b>w(i)</b>
        </tt>.
  </p>
  </ul>
    <H3>EXAMPLES</H3>
    <ul>
      <pre>
w=0.01:0.01:2;s=poly(0,'s');
G=syslin('c',2*(s^2+0.1*s+2),(s^2+s+1)*(s^2+0.3*s+1)); // syslin('c',Num,Den);
fresp=repfreq(G,w);
mag=abs(fresp);
Gid=mrfit(w,mag,4);
frespfit=repfreq(Gid,w);
plot2d([w',w'],[mag(:),abs(frespfit(:))])
 </pre>
    </ul>
    <H3>SEE ALSO</H3>
    <p>
      <ul>
        <a href="cepstrum.html">
          <tt>
            <b>cepstrum</b>
          </tt>
        </a>
        <a href="frfit.html">
          <tt>
            <b>frfit</b>
          </tt>
        </a>
        <a href="../control/freq.html">
          <tt>
            <b>freq</b>
          </tt>
        </a>
        <a href="../control/calfrq.html">
          <tt>
            <b>calfrq</b>
          </tt>
        </a>
      </ul>
    </p>
  </body>
</html>