<html>
  <body bgcolor="FFFFFF">
    <CENTER>Scilab Function  </CENTER>
    <P></P>
    <H3>NAME </H3>
    <p>
      <ul>gfrancis -  Francis equations for tracking  </ul>
    </p>
    <H3>CALLING SEQUENCE</H3>
    <dl>
      <dd>[L,M,T]=gfrancis(Plant,Model)  </dd>
    </dl>
    <H3>PARAMETERS</H3>
    <ul>
      <ul>
  <li>
          <tt>
            <b>Plant  </b>
          </tt>
    : <tt>
            <b>syslin</b>
          </tt> list
  </li>
  <li>
          <tt>
            <b>Model  </b>
          </tt>
    : <tt>
            <b>syslin</b>
          </tt> list
  </li>
  <li>
          <tt>
            <b>L,M,T  </b>
          </tt>
    : real matrices
  </li>
 </ul>
    </ul>
    <H3>DESCRIPTION</H3>
    <ul>
  <p>
    Given the the linear plant:
  </p>
  <pre>
    x'= F*x + G*u 
    y = H*x + J*u
   </pre>
  <p>
    and the linear model
  </p>
  <pre>
    xm'= A*xm + B*um
    ym = C*xm + D*um
   </pre>
  <p>
    the goal is for the plant to track the model i.e. <tt>
          <b>e = y - ym ---&gt; 0</b>
        </tt>
    while keeping stable the state x(t) of the plant. 
    <tt>
          <b>u</b>
        </tt> is given by feedforward and feedback
  </p>
  <pre>
 u = L*xm + M*um + K*(x-T*xm) = [K , L-K*T] *(x,xm) + M*um
   </pre>
  <p>
    The matrices T,L,M satisfy generalized Francis equations
  </p>
  <pre>
    F*T + G*L = T*A
    H*T + J*L = C
          G*M = T*B
          J*M = D
   </pre>
  <p>
    The matrix <tt>
          <b>K</b>
        </tt> must be chosen as stabilizing the pair <tt>
          <b>(F,G)</b>
        </tt>
    See example of use in directory <tt>
          <b>demos/tracking</b>
        </tt>.
  </p>
  </ul>
    <H3>EXAMPLES</H3>
    <ul>
      <pre>
Plant=ssrand(1,3,5);
[F,G,H,J]=abcd(Plant);
nw=4;nuu=2;A=rand(nw,nw);
st=maxi(real(spec(A)));A=A-st*eye(A);
B=rand(nw,nuu);C=2*rand(1,nw);D=0*rand(C*B);
Model=syslin('c',A,B,C,D);
[L,M,T]=gfrancis(Plant,Model);
norm(F*T+G*L-T*A,1)
norm(H*T+J*L-C,1)
norm(G*M-T*B,1)
norm(J*M-D,1)
 </pre>
    </ul>
    <H3>SEE ALSO</H3>
    <p>
      <ul>
        <a href="lqg2stan.html">
          <tt>
            <b>lqg</b>
          </tt>
        </a>
        <a href="ppol.html">
          <tt>
            <b>ppol</b>
          </tt>
        </a>
      </ul>
    </p>
  </body>
</html>