<html>
  <body bgcolor="FFFFFF">
    <CENTER>Scilab Function  </CENTER>
    <P></P>
    <H3>NAME </H3>
    <p>
      <ul>fsolve -  find a zero of a system of n nonlinear functions  </ul>
    </p>
    <H3>CALLING SEQUENCE</H3>
    <dl>
      <dd>[x [,v [,info]]]=fsolve(x0,fct [,fjac] [,tol])  </dd>
    </dl>
    <H3>PARAMETERS</H3>
    <ul>
      <ul>
  <li>
          <tt>
            <b>x0  </b>
          </tt>
    : real vector (initial value of function argument).
  </li>
  <li>
          <tt>
            <b>fct  </b>
          </tt>
    : external (i.e function or list or string).
  </li>
  <li>
          <tt>
            <b>fjac  </b>
          </tt>
    : external (i.e function or list or string).
  </li>
  <li>
          <tt>
            <b>tol  </b>
          </tt>
    : real scalar. precision tolerance: termination occurs when the algorithm estimates that the relative error between x and the solution is at most tol. (<tt>
            <b>tol=1.d-10</b>
          </tt> is the default value).
  </li>
  <li>
          <tt>
            <b>x :  </b>
          </tt>
    real vector (final value of function argument, estimated zero).
  </li>
  <li>
          <tt>
            <b>v :  </b>
          </tt>
    real vector (value of function at x).
  </li>
  <li>
          <tt>
            <b>info  </b>
          </tt>
    :  termination indicator
  </li>
 <ul>
  <li>
            <tt>
              <b>0  </b>
            </tt>
    : improper input parameters.
  </li>
  <li>
            <tt>
              <b>1  </b>
            </tt>
    : algorithm estimates that the relative error between x and the solution  is at most tol.
  </li>
  <li>
            <tt>
              <b>2  </b>
            </tt>
    : number of calls to fcn reached
  </li>
  <li>
            <tt>
              <b>3  </b>
            </tt>
    : tol is too small. No further improvement in the approximate solution  x is possible.
  </li>
  <li>
            <tt>
              <b>4  </b>
            </tt>
    : iteration is not making good progress.
  </li>
 </ul>
 </ul>
    </ul>
    <H3>DESCRIPTION</H3>
    <ul>
  <p>
    find a zero of a system of
    n nonlinear functions in n variables by a modification
    of the powell hybrid method. Jacobian may be provided.
  </p>
  <pre>
0 = fct(x) w.r.t x.
   </pre>
  <p>
    <tt>
          <b>fct</b>
        </tt> is an "external".
    This external returns <tt>
          <b>v=fct(x)</b>
        </tt> given <tt>
          <b>x</b>
        </tt>.
  </p>
  <p>
    The simplest calling sequence for <tt>
          <b>fct</b>
        </tt> is:
  </p>
  <pre>
[v]=fct(x).
   </pre>
  <p>
    If <tt>
          <b>fct</b>
        </tt> is a character string, it refers to a C or Fortran routine
    which must be linked to Scilab. Fortran calling sequence must be  
  </p>
  <pre>
fct(n,x,v,iflag)
integer n,iflag
double precision x(n),v(n)
   </pre>
  <p>
    and C Calling sequence must be 
  </p>
  <pre>
fct(int *n, double x[],double v[],int *iflag)
   </pre>
  <p>
  </p>
  <p>
    Incremental  link is possible (help <tt>
          <b>link</b>
        </tt>).
  </p>
  <p>
    <tt>
          <b>jac</b>
        </tt> is an "external".
    This external returns <tt>
          <b>v=d(fct)/dx (x)</b>
        </tt> given <tt>
          <b>x</b>
        </tt>.
  </p>
  <p>
    The simplest calling sequence for <tt>
          <b>jac</b>
        </tt> is:
  </p>
  <pre>
[v]=jac(x).
   </pre>
  <p>
    If <tt>
          <b>jac</b>
        </tt> is a character string, it refers to a to a C or Fortran routine
    which must be linked to Scilab calling sequences are the same as those
    for fct. Note however that v must be a nxn array.
  </p>
  </ul>
    <H3>EXAMPLES</H3>
    <ul>
      <pre>
// A simple example with fsolve 
a=[1,7;2,8];b=[10;11];
deff('[y]=fsol1(x)','y=a*x+b');
deff('[y]=fsolj1(x)','y=a');
[xres]=fsolve([100;100],fsol1);
a*xres+b
[xres]=fsolve([100;100],fsol1,fsolj1);
a*xres+b
// See routines/default/Ex-fsolve.f
[xres]=fsolve([100;100],'fsol1','fsolj1',1.e-7);
a*xres+b
 </pre>
    </ul>
    <H3>SEE ALSO</H3>
    <p>
      <ul>
        <a href="../programming/external.html">
          <tt>
            <b>external</b>
          </tt>
        </a>
        <a href="quapro.html">
          <tt>
            <b>quapro</b>
          </tt>
        </a>
        <a href="../elementary/mps2linpro.html">
          <tt>
            <b>linpro</b>
          </tt>
        </a>
        <a href="optim.html">
          <tt>
            <b>optim</b>
          </tt>
        </a>
      </ul>
    </p>
  </body>
</html>