<html>
  <body bgcolor="FFFFFF">
    <CENTER>Scilab Function  </CENTER>
    <P></P>
    <H3>NAME </H3>
    <p>
      <ul>schur -  [ordered] Schur decomposition  </ul>
    </p>
    <H3>CALLING SEQUENCE</H3>
    <dl>
      <dd>[U,T] = schur(A)   </dd>
      <dd>[U,dim]=schur(A,flag)  </dd>
      <dd>[U,dim]=schur(A,myfunction)  </dd>
    </dl>
    <H3>PARAMETERS</H3>
    <ul>
      <ul>
  <li>
          <tt>
            <b>A  </b>
          </tt>
    : real or complex square matrix. For ordered forms <tt>
            <b>A</b>
          </tt> is assumed real.
  </li>
  <li>
          <tt>
            <b>flag  </b>
          </tt>
    : character string (<tt>
            <b>'c'</b>
          </tt> or <tt>
            <b>'d'</b>
          </tt>)
  </li>
  <li>
          <tt>
            <b>myfunction  </b>
          </tt>
    : an ``external'' function (this parameter can also be a list or character string)
  </li>
  <li>
          <tt>
            <b>U  </b>
          </tt>
    : orthogonal or unitary square matrix
  </li>
  <li>
          <tt>
            <b>T  </b>
          </tt>
    : matrix
  </li>
  <li>
          <tt>
            <b>dim  </b>
          </tt>
    : integer
  </li>
 </ul>
    </ul>
    <H3>DESCRIPTION</H3>
    <ul>
  <p>
    Schur forms, ordered Schur forms
  </p>
  </ul>
    <H3>Usual schur form</H3>
    <ul>
      <p>
    produces a Schur matrix <tt>
          <b>T</b>
        </tt> and a unitary matrix <tt>
          <b>U</b>
        </tt> so that <tt>
          <b>A = U*T*U'</b>
        </tt> and <tt>
          <b>U'*U = eye(U)</b>
        </tt>. By itself, schur(<tt>
          <b>A</b>
        </tt>) returns <tt>
          <b>T</b>
        </tt>. If <tt>
          <b>A</b>
        </tt> is complex, the Complex Schur Form is returned in matrix <tt>
          <b>T</b>
        </tt>. The Complex Schur Form is upper triangular with the eigenvalues of <tt>
          <b>A</b>
        </tt> on the diagonal. If <tt>
          <b>A</b>
        </tt> is real, the Real Schur Form is returned.  The Real Schur Form has the real eigenvalues on the diagonal and the complex eigenvalues in 2-by-2 blocks on the diagonal.
  </p>
    </ul>
    <H3>Ordered stable form</H3>
    <ul>
      <p>
    returns an unitary matrix <tt>
          <b>U</b>
        </tt> which transforms <tt>
          <b>A</b>
        </tt> into schur form. In addition, the dim first columns of <tt>
          <b>U</b>
        </tt>  make a basis of the  eigenspace of <tt>
          <b>A</b>
        </tt> associated with eigenvalues with negative  real parts (stable "continuous time" eigenspace).
  </p>
      <p>
    returns an unitary matrix <tt>
          <b>U</b>
        </tt> which transforms <tt>
          <b>A</b>
        </tt> into schur form. In addition, the <tt>
          <b>dim</b>
        </tt> first columns of <tt>
          <b>U</b>
        </tt> span a basis of the  eigenspace of <tt>
          <b>A</b>
        </tt> associated with eigenvalues with magnitude lower than 1 (stable "discrete time" eigenspace).
  </p>
    </ul>
    <H3>General eigenspace</H3>
    <ul>
      <p>
    returns an unitary matrix <tt>
          <b>U</b>
        </tt> which transforms <tt>
          <b>A</b>
        </tt> into schur form.  In addition, the <tt>
          <b>dim</b>
        </tt> first columns of <tt>
          <b>U</b>
        </tt> span a basis of the  eigenspace of <tt>
          <b>A</b>
        </tt> associated with the eigenvalues which are  selected by the function <tt>
          <b>myfunction</b>
        </tt>.
  </p>
      <p>
    This function must be of the following type (here <tt>
          <b>myfunction</b>
        </tt> is "<tt>
          <b>rule</b>
        </tt>"):
  </p>
      <pre>
function [flag]=rule(x)

flag=...
   </pre>
      <p>
    <tt>
          <b>x</b>
        </tt> is a vector with three components which characterizes either a real eigenvalue or a pair of complex conjugate eigenvalues.
  </p>
      <p>
    If <tt>
          <b>x(1)=1</b>
        </tt>, a real eigenvalue is considered and this eigenvalue is <tt>
          <b>x(2)/x(3)</b>
        </tt>.
  </p>
      <p>
    If <tt>
          <b>x(1)=2</b>
        </tt>, a pair of complex conjugate eigenvalues is considered. The sum of these two eigenvalues (twice the real part) is <tt>
          <b>x(2)</b>
        </tt> and the product (squared magnitude) is <tt>
          <b>x(3)</b>
        </tt>.
  </p>
      <p>
    On return, flag should be 1 if the real eigenvalue is  selected or the pair of eigenvalues is selected and 0 otherwise.
  </p>
    </ul>
    <H3>Example of function</H3>
    <ul>
      <pre>
        function [flag]=disc(x)
        ls =x(1);flag=0;
        select  ls
           case 1 then if abs(x(2)) &lt; ro*abs(x(3)) then flag=1;end
           case 2 then if x(3) &lt; ro*ro then flag=1;end
        end
   </pre>
      <p>
    The function <tt>
          <b>disc</b>
        </tt> selects the eigenvalues with magnitude lower than a given scalar <tt>
          <b>ro</b>
        </tt>. And for <tt>
          <b>ro=1</b>
        </tt> the calling sequence <tt>
          <b>[U,dim]=schur(A,'d')</b>
        </tt> and <tt>
          <b>[U,dim]=schur(A,disc)</b>
        </tt> are equivalent.
  </p>
      <p>
    Another useful example is <tt>
          <b>%choose</b>
        </tt>  (see function code in <tt>
          <b>SCIDIR/macros/percent</b>
        </tt>)
  </p>
    </ul>
    <H3>EXAMPLES</H3>
    <ul>
      <pre>
A=diag([-0.9,-2,2,0.9]);X=rand(A);A=inv(X)*A*X;
[U,d]=schur(A,'c');
A1=U'*A*U;
spec(A1(1:d,1:d))      //stable cont. eigenvalues
[U,d]=schur(A,'d');
A1=U'*A*U;
spec(A1(1:d,1:d))      //stable disc. eigenvalues
 </pre>
    </ul>
    <H3>SEE ALSO</H3>
    <p>
      <ul>
        <a href="gschur.html">
          <tt>
            <b>gschur</b>
          </tt>
        </a>
        <a href="../control/ricc.html">
          <tt>
            <b>ricc</b>
          </tt>
        </a>
        <a href="pbig.html">
          <tt>
            <b>pbig</b>
          </tt>
        </a>
        <a href="psmall.html">
          <tt>
            <b>psmall</b>
          </tt>
        </a>
      </ul>
    </p>
  </body>
</html>