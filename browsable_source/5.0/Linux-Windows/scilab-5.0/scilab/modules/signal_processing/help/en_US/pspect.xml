<?xml version="1.0" encoding="ISO-8859-1"?>
<refentry xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svg="http://www.w3.org/2000/svg" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:db="http://docbook.org/ns/docbook" version="5.0-subset Scilab" xml:lang="en" xml:id="pspect">
  <info>
    <pubdate>$LastChangedDate$</pubdate>
  </info>
  <refnamediv>
    <refname>pspect</refname>
    <refpurpose> cross-spectral estimate between 2 series</refpurpose>
  </refnamediv>
  <refsynopsisdiv>
    <title>Calling Sequence</title>
    <synopsis>[sm,cwp]=pspect(sec_step,sec_leng,wtype,x,y,wpar)</synopsis>
  </refsynopsisdiv>
  <refsection>
    <title>Parameters</title>
    <variablelist>
      <varlistentry>
        <term>x</term>
        <listitem>
          <para>data if vector, amount of input data if scalar</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>y</term>
        <listitem>
          <para>data if vector, amount of input data if scalar</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>sec_step</term>
        <listitem>
          <para>offset of each data window</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>sec_leng</term>
        <listitem>
          <para>length of each data window</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>wtype</term>
        <listitem>
          <para>window type <literal>(re,tr,hm,hn,kr,ch)</literal></para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>wpar</term>
        <listitem>
          <para>optional parameters  for <literal>wtype='kr', wpar&gt;0</literal>  for <literal>wtype='ch', 0&lt;wpar(1)&lt;.5, wpar(2)&gt;0</literal></para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>sm</term>
        <listitem>
          <para>power spectral estimate in the interval <literal>[0,1]</literal></para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>cwp</term>
        <listitem>
          <para>unspecified Chebyshev window parameter</para>
        </listitem>
      </varlistentry>
    </variablelist>
  </refsection>
  <refsection>
    <title>Description</title>
    <para>
    Cross-spectral estimate between <literal>x</literal> and <literal>y</literal> if both are given
    and auto-spectral estimate of <literal>x</literal> otherwise.
    Spectral estimate obtained using the modified periodogram method.</para>
  </refsection>
  <refsection>
    <title>Reference</title>
    <para>
     Digital Signal Processing by Oppenheim and Schafer</para>
  </refsection>
  <refsection>
    <title>Examples</title>
    <programlisting role="example"><![CDATA[

rand('normal');rand('seed',0);
x=rand(1:1024-33+1);
//make low-pass filter with eqfir
nf=33;bedge=[0 .1;.125 .5];des=[1 0];wate=[1 1];
h=eqfir(nf,bedge,des,wate);
//filter white data to obtain colored data 
h1=[h 0*ones(1:maxi(size(x))-1)];
x1=[x 0*ones(1:maxi(size(h))-1)];
hf=fft(h1,-1);   xf=fft(x1,-1);yf=hf.*xf;y=real(fft(yf,1));
//plot magnitude of filter
//h2=[h 0*ones(1:968)];hf2=fft(h2,-1);hf2=real(hf2.*conj(hf2));
//hsize=maxi(size(hf2));fr=(1:hsize)/hsize;plot(fr,log(hf2));
//pspect example
sm=pspect(100,200,'tr',y);smsize=maxi(size(sm));fr=(1:smsize)/smsize;
plot(fr,log(sm));
rand('unif');
 
  ]]></programlisting>
  </refsection>
  <refsection>
    <title>See Also</title>
    <simplelist type="inline">
      <member>
        <link linkend="cspect">cspect</link>
      </member>
    </simplelist>
  </refsection>
  <refsection>
    <title>Authors</title>
    <para>C. B.  </para>
  </refsection>
</refentry>
